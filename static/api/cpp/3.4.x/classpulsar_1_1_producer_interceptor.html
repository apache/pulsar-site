<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pulsar-client-cpp: pulsar::ProducerInterceptor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">pulsar-client-cpp
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepulsar.html">pulsar</a></li><li class="navelem"><a class="el" href="classpulsar_1_1_producer_interceptor.html">ProducerInterceptor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classpulsar_1_1_producer_interceptor-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">pulsar::ProducerInterceptor Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_producer_interceptor_8h_source.html">ProducerInterceptor.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a59d5f25b142cd69ebbca13f22842120b" id="r_a59d5f25b142cd69ebbca13f22842120b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpulsar_1_1_producer_interceptor.html#a59d5f25b142cd69ebbca13f22842120b">close</a> ()</td></tr>
<tr class="separator:a59d5f25b142cd69ebbca13f22842120b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc40c03231068fa4a13d6017220d0a79" id="r_adc40c03231068fa4a13d6017220d0a79"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classpulsar_1_1_message.html">Message</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpulsar_1_1_producer_interceptor.html#adc40c03231068fa4a13d6017220d0a79">beforeSend</a> (const <a class="el" href="classpulsar_1_1_producer.html">Producer</a> &amp;producer, const <a class="el" href="classpulsar_1_1_message.html">Message</a> &amp;message)=0</td></tr>
<tr class="separator:adc40c03231068fa4a13d6017220d0a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9aba4738d6033218f4a970c53aefab0" id="r_ad9aba4738d6033218f4a970c53aefab0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpulsar_1_1_producer_interceptor.html#ad9aba4738d6033218f4a970c53aefab0">onSendAcknowledgement</a> (const <a class="el" href="classpulsar_1_1_producer.html">Producer</a> &amp;producer, <a class="el" href="namespacepulsar.html#ae85314d6b9e8afd831cf8c66705f2dbb">Result</a> result, const <a class="el" href="classpulsar_1_1_message.html">Message</a> &amp;message, const <a class="el" href="classpulsar_1_1_message_id.html">MessageId</a> &amp;messageID)=0</td></tr>
<tr class="separator:ad9aba4738d6033218f4a970c53aefab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4fbfa721d9d9985a304c3d2ce924202" id="r_aa4fbfa721d9d9985a304c3d2ce924202"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpulsar_1_1_producer_interceptor.html#aa4fbfa721d9d9985a304c3d2ce924202">onPartitionsChange</a> (const std::string &amp;topicName, int partitions)</td></tr>
<tr class="separator:aa4fbfa721d9d9985a304c3d2ce924202"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An interface that allows you to intercept (and possibly mutate) the messages received by the producer before they are published to the Pulsar brokers.</p>
<p>Exceptions thrown by <a class="el" href="classpulsar_1_1_producer_interceptor.html">ProducerInterceptor</a> methods will be caught, logged, but not propagated further.</p>
<p><a class="el" href="classpulsar_1_1_producer_interceptor.html">ProducerInterceptor</a> callbacks may be called from multiple threads. Interceptor implementation must ensure thread-safety, if needed. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="adc40c03231068fa4a13d6017220d0a79" name="adc40c03231068fa4a13d6017220d0a79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc40c03231068fa4a13d6017220d0a79">&#9670;&#160;</a></span>beforeSend()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classpulsar_1_1_message.html">Message</a> pulsar::ProducerInterceptor::beforeSend </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classpulsar_1_1_producer.html">Producer</a> &amp;&#160;</td>
          <td class="paramname"><em>producer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classpulsar_1_1_message.html">Message</a> &amp;&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is called from <a class="el" href="classpulsar_1_1_producer.html#ad4737186cf798acfb24a167796259443">Producer::send</a> and <a class="el" href="classpulsar_1_1_producer.html#a7b31f92eb0362bdff32316fc9ab70fd7">Producer::sendAsync</a> methods, before send the message to the brokers. This method is allowed to modify the record, in which case, the new record will be returned.</p>
<p>Any exception thrown by this method will be caught by the caller and logged, but not propagated further.</p>
<p>Since the producer may run multiple interceptors, a particular interceptor's #beforeSend(Producer, Message) callback will be called in the order specified by ProducerConfiguration::intercept().</p>
<p>The first interceptor in the list gets the message passed from the client, the following interceptor will be passed the message returned by the previous interceptor, and so on. Since interceptors are allowed to modify messages, interceptors may potentially get the message already modified by other interceptors. However, building a pipeline of mutable interceptors that depend on the output of the previous interceptor is discouraged, because of potential side-effects caused by interceptors potentially failing to modify the message and throwing an exception. If one of the interceptors in the list throws an exception from beforeSend(Message), the exception is caught, logged, and the next interceptor is called with the message returned by the last successful interceptor in the list, or otherwise the client.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">producer</td><td>the producer which contains the interceptor. </td></tr>
    <tr><td class="paramname">message</td><td>message to send. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the intercepted message. </dd></dl>

</div>
</div>
<a id="a59d5f25b142cd69ebbca13f22842120b" name="a59d5f25b142cd69ebbca13f22842120b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59d5f25b142cd69ebbca13f22842120b">&#9670;&#160;</a></span>close()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void pulsar::ProducerInterceptor::close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Close the interceptor </p>

</div>
</div>
<a id="aa4fbfa721d9d9985a304c3d2ce924202" name="aa4fbfa721d9d9985a304c3d2ce924202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4fbfa721d9d9985a304c3d2ce924202">&#9670;&#160;</a></span>onPartitionsChange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void pulsar::ProducerInterceptor::onPartitionsChange </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>topicName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>partitions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method is called when partitions of the topic (partitioned-topic) changes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topicName</td><td>topic name </td></tr>
    <tr><td class="paramname">partitions</td><td>new updated partitions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad9aba4738d6033218f4a970c53aefab0" name="ad9aba4738d6033218f4a970c53aefab0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9aba4738d6033218f4a970c53aefab0">&#9670;&#160;</a></span>onSendAcknowledgement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void pulsar::ProducerInterceptor::onSendAcknowledgement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classpulsar_1_1_producer.html">Producer</a> &amp;&#160;</td>
          <td class="paramname"><em>producer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacepulsar.html#ae85314d6b9e8afd831cf8c66705f2dbb">Result</a>&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classpulsar_1_1_message.html">Message</a> &amp;&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classpulsar_1_1_message_id.html">MessageId</a> &amp;&#160;</td>
          <td class="paramname"><em>messageID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method is called when the message sent to the broker has been acknowledged, or when sending the message fails. This method is generally called just before the user callback is called.</p>
<p>Any exception thrown by this method will be ignored by the caller.</p>
<p>This method will generally execute in the background I/O thread, so the implementation should be reasonably fast. Otherwise, sending of messages from other threads could be delayed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">producer</td><td>the producer which contains the interceptor. </td></tr>
    <tr><td class="paramname">result</td><td>the result for sending messages, ResultOk indicates send has succeed. </td></tr>
    <tr><td class="paramname">message</td><td>the message that application sends. </td></tr>
    <tr><td class="paramname">messageID</td><td>the message id that assigned by the broker. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/pulsar/<a class="el" href="_producer_interceptor_8h_source.html">ProducerInterceptor.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
