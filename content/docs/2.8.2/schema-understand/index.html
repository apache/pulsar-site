<!doctype html>
<html class="docs-version-2.8.2" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Atom Feed"><title data-react-helmet="true">Understand schema | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/docs/2.8.2/schema-understand"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2.8.2"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.8.2"><meta data-react-helmet="true" property="og:title" content="Understand schema | Apache Pulsar"><meta data-react-helmet="true" name="description" content="This chapter explains the basic concepts of Pulsar schema, focuses on the topics of particular importance, and provides additional background."><meta data-react-helmet="true" property="og:description" content="This chapter explains the basic concepts of Pulsar schema, focuses on the topics of particular importance, and provides additional background."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/docs/2.8.2/schema-understand"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.8.2/schema-understand" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/zh-CN/docs/2.8.2/schema-understand" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.8.2/schema-understand" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.7e3a3d28.css">
<link rel="preload" href="/assets/js/runtime~main.7e088baf.js" as="script">
<link rel="preload" href="/assets/js/main.c54b7d6d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="tailwind navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.8.2/">Docs</a><a class="navbar__item navbar__link" href="/versions">Versions</a><a class="navbar__item navbar__link" href="/download">Download</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.8.2/client-libraries">Clients</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">REST APIs</a><ul class="dropdown__menu"><li><a href="/admin-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Admin REST API</span></a></li><li><a href="/functions-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Functions</span></a></li><li><a href="/source-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Sources</span></a></li><li><a href="/sink-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Sinks</span></a></li><li><a href="/packages-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Packages</span></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">CLI</a><ul class="dropdown__menu"><li><a href="/pulsar-admin-cli" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Admin</span></a></li><li><a href="/pulsar-client-cli" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Client</span></a></li><li><a href="/pulsar-perf-cli" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Perf</span></a></li><li><a href="/pulsar-cli" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar</span></a></li></ul></div><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contact">Contact</a></li><li><a class="dropdown__link" href="/contributing">Contributing</a></li><li><a class="dropdown__link" href="/coding-guide">Coding guide</a></li><li><a class="dropdown__link" href="/events">Events</a></li><li><a href="https://twitter.com/Apache_Pulsar" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Twitter<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Wiki<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Issue tracking<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://pulsar-summit.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Summit<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a class="dropdown__link" href="/resources">Resources</a></li><li><a class="dropdown__link" href="/team">Team</a></li><li><a class="dropdown__link" href="/powered-by">Powered By</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Foundation<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>License<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Sponsorship<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Thanks<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Security<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_zID8"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/docs/2.8.2/schema-understand" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh-CN/docs/2.8.2/schema-understand" target="_self" rel="noopener noreferrer" class="dropdown__link">ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/docs">Previous Versions</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs">2.9.1</a></li><li><a class="dropdown__link" href="/docs/2.9.0/">2.9.0</a></li><li><a class="dropdown__link" href="/docs/2.8.0/">2.8.0</a></li><li><a class="dropdown__link" href="/docs/2.7.0/">2.7.0</a></li><li><a class="dropdown__link" href="/docs/2.6.0/">2.6.0</a></li></ul></div><a href="https://pulsar.staged.apache.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Old Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_iQ2x toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/">Get Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/concepts-overview">Concepts and Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/2.8.2/schema-get-started">Pulsar Schema</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.8.2/schema-get-started">Get started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/2.8.2/schema-understand">Understand schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.8.2/schema-evolution-compatibility">Schema evolution and compatibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.8.2/schema-manage">Manage schema</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/functions-overview">Pulsar Functions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/io-overview">Pulsar IO</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/sql-overview">Pulsar SQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/tiered-storage-overview">Tiered Storage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/txn-why">Transactions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/helm-overview">Kubernetes (Helm)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/deploy-aws">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/administration-zk-bk">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/security-overview">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/performance-pulsar-perf">Performance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/client-libraries">Client Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/admin-api-overview">Admin API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/adaptors-kafka">Adaptors</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/cookbooks-compaction">Cookbooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/develop-tools">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/2.8.2/reference-terminology">Reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Apache Pulsar<!-- --> <b>2.8.2</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/schema-understand">latest version</a></b> (<!-- -->2.9.1<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->2.8.2</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Understand schema</h1></header><p>This chapter explains the basic concepts of Pulsar schema, focuses on the topics of particular importance, and provides additional background.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="schemainfo">SchemaInfo<a class="hash-link" href="#schemainfo" title="Direct link to heading">â€‹</a></h2><p>Pulsar schema is defined in a data structure called <code>SchemaInfo</code>. </p><p>The <code>SchemaInfo</code> is stored and enforced on a per-topic basis and cannot be stored at the namespace or tenant level.</p><p>A <code>SchemaInfo</code> consists of the following fields:</p><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><code>name</code></td><td>Schema name (a string).</td></tr><tr><td><code>type</code></td><td>Schema type, which determines how to interpret the schema data. <li>Predefined schema: see <a href="/docs/2.8.2/schema-understand#schema-type">here</a>. </li><li>Customized schema: it is left as an empty string. </li></td></tr><tr><td><code>schema</code>ï¼ˆ<code>payload</code>)</td><td>Schema data, which is a sequence of 8-bit unsigned bytes and schema-type specific.</td></tr><tr><td><code>properties</code></td><td>It is a user defined properties as a string/string map. Applications can use this bag for carrying any application specific logics. Possible properties might be the Git hash associated with the schema, an environment string like <code>dev</code> or <code>prod</code>.</td></tr></tbody></table><p><strong>Example</strong></p><p>This is the <code>SchemaInfo</code> of a string.</p><div class="codeBlockContainer_J+bg language-json theme-code-block"><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;test-string-schema&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;STRING&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;schema&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="schema-type">Schema type<a class="hash-link" href="#schema-type" title="Direct link to heading">â€‹</a></h2><p>Pulsar supports various schema types, which are mainly divided into two categories: </p><ul><li><p>Primitive type </p></li><li><p>Complex type</p></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="primitive-type">Primitive type<a class="hash-link" href="#primitive-type" title="Direct link to heading">â€‹</a></h3><p>Currently, Pulsar supports the following primitive types:</p><table><thead><tr><th>Primitive Type</th><th>Description</th></tr></thead><tbody><tr><td><code>BOOLEAN</code></td><td>A binary value</td></tr><tr><td><code>INT8</code></td><td>A 8-bit signed integer</td></tr><tr><td><code>INT16</code></td><td>A 16-bit signed integer</td></tr><tr><td><code>INT32</code></td><td>A 32-bit signed integer</td></tr><tr><td><code>INT64</code></td><td>A 64-bit signed integer</td></tr><tr><td><code>FLOAT</code></td><td>A single precision (32-bit) IEEE 754 floating-point number</td></tr><tr><td><code>DOUBLE</code></td><td>A double-precision (64-bit) IEEE 754 floating-point number</td></tr><tr><td><code>BYTES</code></td><td>A sequence of 8-bit unsigned bytes</td></tr><tr><td><code>STRING</code></td><td>A Unicode character sequence</td></tr><tr><td><code>TIMESTAMP</code> (<code>DATE</code>, <code>TIME</code>)</td><td>A logic type represents a specific instant in time with millisecond precision. <br>It stores the number of milliseconds since <code>January 1, 1970, 00:00:00 GMT</code> as an <code>INT64</code> value</td></tr><tr><td>INSTANT</td><td>A single instantaneous point on the time-line with nanoseconds precision</td></tr><tr><td>LOCAL_DATE</td><td>An immutable date-time object that represents a date, often viewed as year-month-day</td></tr><tr><td>LOCAL_TIME</td><td>An immutable date-time object that represents a time, often viewed as hour-minute-second. Time is represented to nanosecond precision.</td></tr><tr><td>LOCAL_DATE_TIME</td><td>An immutable date-time object that represents a date-time, often viewed as year-month-day-hour-minute-second</td></tr></tbody></table><p>For primitive types, Pulsar does not store any schema data in <code>SchemaInfo</code>. The <code>type</code> in <code>SchemaInfo</code> is used to determine how to serialize and deserialize the data. </p><p>Some of the primitive schema implementations can use <code>properties</code> to store implementation-specific tunable settings. For example, a <code>string</code> schema can use <code>properties</code> to store the encoding charset to serialize and deserialize strings.</p><p>The conversions between <strong>Pulsar schema types</strong> and <strong>language-specific primitive types</strong> are as below.</p><table><thead><tr><th>Schema Type</th><th>Java Type</th><th>Python Type</th><th>Go Type</th></tr></thead><tbody><tr><td>BOOLEAN</td><td>boolean</td><td>bool</td><td>bool</td></tr><tr><td>INT8</td><td>byte</td><td></td><td>int8</td></tr><tr><td>INT16</td><td>short</td><td></td><td>int16</td></tr><tr><td>INT32</td><td>int</td><td></td><td>int32</td></tr><tr><td>INT64</td><td>long</td><td></td><td>int64</td></tr><tr><td>FLOAT</td><td>float</td><td>float</td><td>float32</td></tr><tr><td>DOUBLE</td><td>double</td><td>float</td><td>float64</td></tr><tr><td>BYTES</td><td>byte[], ByteBuffer, ByteBuf</td><td>bytes</td><td>[]byte</td></tr><tr><td>STRING</td><td>string</td><td>str</td><td>string</td></tr><tr><td>TIMESTAMP</td><td>java.sql.Timestamp</td><td></td><td></td></tr><tr><td>TIME</td><td>java.sql.Time</td><td></td><td></td></tr><tr><td>DATE</td><td>java.util.Date</td><td></td><td></td></tr><tr><td>INSTANT</td><td>java.time.Instant</td><td></td><td></td></tr><tr><td>LOCAL_DATE</td><td>java.time.LocalDate</td><td></td><td></td></tr><tr><td>LOCAL_TIME</td><td>java.time.LocalDateTime</td><td></td><td></td></tr><tr><td>LOCAL_DATE_TIME</td><td>java.time.LocalTime</td><td></td><td></td></tr></tbody></table><p><strong>Example</strong></p><p>This example demonstrates how to use a string schema.</p><ol><li><p>Create a producer with a string schema and send messages.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;String&gt; producer = client.newProducer(Schema.STRING).create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.newMessage().value(&quot;Hello Pulsar!&quot;).send();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Create a consumer with a string schema and receive messages.  </p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer&lt;String&gt; consumer = client.newConsumer(Schema.STRING).subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consumer.receive();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="complex-type">Complex type<a class="hash-link" href="#complex-type" title="Direct link to heading">â€‹</a></h3><p>Currently, Pulsar supports the following complex types:</p><table><thead><tr><th>Complex Type</th><th>Description</th></tr></thead><tbody><tr><td><code>keyvalue</code></td><td>Represents a complex type of a key/value pair.</td></tr><tr><td><code>struct</code></td><td>Handles structured data. It supports <code>AvroBaseStructSchema</code> and <code>ProtobufNativeSchema</code>.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="keyvalue">keyvalue<a class="hash-link" href="#keyvalue" title="Direct link to heading">â€‹</a></h4><p><code>Keyvalue</code> schema helps applications define schemas for both key and value. </p><p>For <code>SchemaInfo</code> of <code>keyvalue</code> schema, Pulsar stores the <code>SchemaInfo</code> of key schema and the <code>SchemaInfo</code> of value schema together.</p><p>Pulsar provides the following methods to encode a key/value pair in messagesï¼š</p><ul><li><p><code>INLINE</code></p></li><li><p><code>SEPARATED</code></p></li></ul><p>You can choose the encoding type when constructing the key/value schema.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">INLINE</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">SEPARATED</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>Key/value pairs are encoded together in the message payload.</p></div><div role="tabpanel" hidden=""><p>Key is encoded in the message key and the value is encoded in the message payload. </p><p><strong>Example</strong></p><p>This example shows how to construct a key/value schema and then use it to produce and consume messages.</p><ol><li><p>Construct a key/value schema with <code>INLINE</code> encoding type.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema&lt;KeyValue&lt;Integer, String&gt;&gt; kvSchema = Schema.KeyValue(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema.INT32,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema.STRING,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">KeyValueEncodingType.INLINE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Optionally, construct a key/value schema with <code>SEPARATED</code> encoding type.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema&lt;KeyValue&lt;Integer, String&gt;&gt; kvSchema = Schema.KeyValue(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema.INT32,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema.STRING,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">KeyValueEncodingType.SEPARATED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Produce messages using a key/value schema.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema&lt;KeyValue&lt;Integer, String&gt;&gt; kvSchema = Schema.KeyValue(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema.INT32,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema.STRING,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">KeyValueEncodingType.SEPARATED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;KeyValue&lt;Integer, String&gt;&gt; producer = client.newProducer(kvSchema)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .topic(TOPIC)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final int key = 100;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">final String value = &quot;value-100&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// send the key/value message</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.newMessage()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.value(new KeyValue(key, value))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.send();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Consume messages using a key/value schema.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema&lt;KeyValue&lt;Integer, String&gt;&gt; kvSchema = Schema.KeyValue(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema.INT32,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema.STRING,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">KeyValueEncodingType.SEPARATED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer&lt;KeyValue&lt;Integer, String&gt;&gt; consumer = client.newConsumer(kvSchema)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .topic(TOPIC)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .subscriptionName(SubscriptionName).subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// receive key/value pair</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Message&lt;KeyValue&lt;Integer, String&gt;&gt; msg = consumer.receive();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">KeyValue&lt;Integer, String&gt; kv = msg.getValue();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ol></div></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="struct">struct<a class="hash-link" href="#struct" title="Direct link to heading">â€‹</a></h4><p>This section describes the details of type and usage of the <code>struct</code> schema.</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="type">Type<a class="hash-link" href="#type" title="Direct link to heading">â€‹</a></h5><p><code>struct</code> schema supports <code>AvroBaseStructSchema</code> and <code>ProtobufNativeSchema</code>.</p><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>AvroBaseStructSchema</code></td><td>Pulsar uses <a href="http://avro.apache.org/docs/current/spec.html" target="_blank" rel="noopener noreferrer">Avro Specification</a> to declare the schema definition for <code>AvroBaseStructSchema</code>, which supports  <code>AvroSchema</code>, <code>JsonSchema</code>, and <code>ProtobufSchema</code>. <br><br>This allows Pulsar:<br>- to use the same tools to manage schema definitions<br>- to use different serialization or deserialization methods to handle data</td></tr><tr><td><code>ProtobufNativeSchema</code></td><td><code>ProtobufNativeSchema</code> is based on protobuf native Descriptor. <br><br>This allows Pulsar:<br>- to use native protobuf-v3 to serialize or deserialize data<br>- to use <code>AutoConsume</code> to deserialize data.</td></tr></tbody></table><h5 class="anchor anchorWithStickyNavbar_y2LR" id="usage">Usage<a class="hash-link" href="#usage" title="Direct link to heading">â€‹</a></h5><p>Pulsar provides the following methods to use the <code>struct</code> schema:</p><ul><li><p><code>static</code></p></li><li><p><code>generic</code></p></li><li><p><code>SchemaDefinition</code></p></li></ul><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">static</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">generic</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">SchemaDefinition</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>You can predefine the <code>struct</code> schema, which can be a POJO in Java, a <code>struct</code> in Go, or classes generated by Avro or Protobuf tools. </p><p><strong>Example</strong> </p><p>Pulsar gets the schema definition from the predefined <code>struct</code> using an Avro library. The schema definition is the schema data stored as a part of the <code>SchemaInfo</code>.</p><ol><li><p>Create the <em>User</em> class to define the messages sent to Pulsar topics.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Builder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@AllArgsConstructor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@NoArgsConstructor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public static class User {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int age;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Create a producer with a <code>struct</code> schema and send messages.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;User&gt; producer = client.newProducer(Schema.AVRO(User.class)).create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.newMessage().value(User.builder().name(&quot;pulsar-user&quot;).age(1).build()).send();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Create a consumer with a <code>struct</code> schema and receive messages</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer&lt;User&gt; consumer = client.newConsumer(Schema.AVRO(User.class)).subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User user = consumer.receive();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ol></div><div role="tabpanel" hidden=""><p>Sometimes applications do not have pre-defined structs, and you can use this method to define schema and access data.</p><p>You can define the <code>struct</code> schema using the <code>GenericSchemaBuilder</code>, generate a generic struct using <code>GenericRecordBuilder</code> and consume messages into <code>GenericRecord</code>.</p><p><strong>Example</strong> </p><ol><li><p>Use <code>RecordSchemaBuilder</code> to build a schema.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RecordSchemaBuilder recordSchemaBuilder = SchemaBuilder.record(&quot;schemaName&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">recordSchemaBuilder.field(&quot;intField&quot;).type(SchemaType.INT32);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SchemaInfo schemaInfo = recordSchemaBuilder.build(SchemaType.AVRO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;GenericRecord&gt; producer = client.newProducer(Schema.generic(schemaInfo)).create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Use <code>RecordBuilder</code> to build the struct records.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.newMessage().value(schema.newRecordBuilder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            .set(&quot;intField&quot;, 32)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            .build()).send();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ol></div><div role="tabpanel" hidden=""><p>You can define the <code>schemaDefinition</code> to generate a <code>struct</code> schema.</p><p><strong>Example</strong> </p><ol><li><p>Create the <em>User</em> class to define the messages sent to Pulsar topics.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Builder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@AllArgsConstructor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@NoArgsConstructor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public static class User {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String name;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int age;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Create a producer with a <code>SchemaDefinition</code> and send messages.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SchemaDefinition&lt;User&gt; schemaDefinition = SchemaDefinition.&lt;User&gt;builder().withPojo(User.class).build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;User&gt; producer = client.newProducer(Schema.AVRO(schemaDefinition)).create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.newMessage().value(User.builder().name(&quot;pulsar-user&quot;).age(1).build()).send();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Create a consumer with a <code>SchemaDefinition</code> schema and receive messages</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SchemaDefinition&lt;User&gt; schemaDefinition = SchemaDefinition.&lt;User&gt;builder().withPojo(User.class).build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer&lt;User&gt; consumer = client.newConsumer(Schema.AVRO(schemaDefinition)).subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User user = consumer.receive().getValue();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ol></div></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="auto-schema">Auto Schema<a class="hash-link" href="#auto-schema" title="Direct link to heading">â€‹</a></h3><p>If you don&#x27;t know the schema type of a Pulsar topic in advance, you can use AUTO schema to produce or consume generic records to or from brokers.</p><table><thead><tr><th>Auto Schema Type</th><th>Description</th></tr></thead><tbody><tr><td><code>AUTO_PRODUCE</code></td><td>This is useful for transferring data <strong>from a producer to a Pulsar topic that has a schema</strong>.</td></tr><tr><td><code>AUTO_CONSUME</code></td><td>This is useful for transferring data <strong>from a Pulsar topic that has a schema to a consumer</strong>.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="auto_produce">AUTO_PRODUCE<a class="hash-link" href="#auto_produce" title="Direct link to heading">â€‹</a></h4><p><code>AUTO_PRODUCE</code> schema helps a producer validate whether the bytes sent by the producer is compatible with the schema of a topic. </p><p><strong>Example</strong></p><p>Suppose that:</p><ul><li><p>You have a producer processing messages from a Kafka topic <em>K</em>. </p></li><li><p>You have a Pulsar topic <em>P</em>, and you do not know its schema type.</p></li><li><p>Your application reads the messages from <em>K</em> and writes the messages to <em>P</em>.<br>
</p></li></ul><p>In this case, you can use <code>AUTO_PRODUCE</code> to verify whether the bytes produced by <em>K</em> can be sent to <em>P</em> or not.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Produce&lt;byte[]&gt; pulsarProducer = client.newProducer(Schema.AUTO_PRODUCE())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    â€¦</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">byte[] kafkaMessageBytes = â€¦ ; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsarProducer.produce(kafkaMessageBytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="auto_consume">AUTO_CONSUME<a class="hash-link" href="#auto_consume" title="Direct link to heading">â€‹</a></h4><p><code>AUTO_CONSUME</code> schema helps a Pulsar topic validate whether the bytes sent by a Pulsar topic is compatible with a consumer, that is, the Pulsar topic deserializes messages into language-specific objects using the <code>SchemaInfo</code> retrieved from broker-side. </p><p>Currently, <code>AUTO_CONSUME</code> supports AVRO, JSON and ProtobufNativeSchema schemas. It deserializes messages into <code>GenericRecord</code>.</p><p><strong>Example</strong></p><p>Suppose that:</p><ul><li><p>You have a Pulsar topic <em>P</em>.</p></li><li><p>You have a consumer (for example, MySQL) receiving messages from the topic <em>P</em>.</p></li><li><p>You application reads the messages from <em>P</em> and writes the messages to MySQL.
</p></li></ul><p>In this case, you can use <code>AUTO_CONSUME</code> to verify whether the bytes produced by <em>P</em> can be sent to MySQL or not.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer&lt;GenericRecord&gt; pulsarConsumer = client.newConsumer(Schema.AUTO_CONSUME())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    â€¦</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Message&lt;GenericRecord&gt; msg = consumer.receive() ; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GenericRecord record = msg.getValue();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="schema-version">Schema version<a class="hash-link" href="#schema-version" title="Direct link to heading">â€‹</a></h2><p>Each <code>SchemaInfo</code> stored with a topic has a version. Schema version manages schema changes happening within a topic. </p><p>Messages produced with a given <code>SchemaInfo</code> is tagged with a schema version, so when a message is consumed by a Pulsar client, the Pulsar client can use the schema version to retrieve the corresponding <code>SchemaInfo</code> and then use the <code>SchemaInfo</code> to deserialize data.</p><p>Schemas are versioned in succession. Schema storage happens in a broker that handles the associated topics so that version assignments can be made. </p><p>Once a version is assigned/fetched to/for a schema, all subsequent messages produced by that producer are tagged with the appropriate version.</p><p><strong>Example</strong></p><p>The following example illustrates how the schema version works.</p><p>Suppose that a Pulsar <a href="/docs/2.8.2/client-libraries-java">Java client</a> created using the code below attempts to connect to Pulsar and begins to send messages:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PulsarClient client = PulsarClient.builder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .serviceUrl(&quot;pulsar://localhost:6650&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;SensorReading&gt; producer = client.newProducer(JSONSchema.of(SensorReading.class))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topic(&quot;sensor-data&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .sendTimeout(3, TimeUnit.SECONDS)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The table below lists the possible scenarios when this connection attempt occurs and what happens in each scenario:</p><table><thead><tr><th>Scenario</th><th>What happens</th></tr></thead><tbody><tr><td><li>No schema exists for the topic. </li></td><td>(1) The producer is created using the given schema. (2) Since no existing schema is compatible with the <code>SensorReading</code> schema, the schema is transmitted to the broker and stored. (3) Any consumer created using the same schema or topic can consume messages from the <code>sensor-data</code> topic.</td></tr><tr><td><li>A schema already exists. </li><li>The producer connects using the same schema that is already stored. </li></td><td>(1) The schema is transmitted to the broker. (2) The broker determines that the schema is compatible. (3) The broker attempts to store the schema in <a href="/docs/2.8.2/concepts-architecture-overview#persistent-storage">BookKeeper</a> but then determines that it&#x27;s already stored, so it is used to tag produced messages.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-does-schema-work">How does schema work<a class="hash-link" href="#how-does-schema-work" title="Direct link to heading">â€‹</a></h2><p>Pulsar schemas are applied and enforced at the <strong>topic</strong> level (schemas cannot be applied at the namespace or tenant level). </p><p>Producers and consumers upload schemas to brokers, so Pulsar schemas work on the producer side and the consumer side.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="producer-side">Producer side<a class="hash-link" href="#producer-side" title="Direct link to heading">â€‹</a></h3><p>This diagram illustrates how does schema work on the Producer side.</p><p><img alt="Schema works at the producer side" src="/assets/images/schema-producer-2682d94503cecdc1dd96dd54bbca105d.png"></p><ol><li><p>The application uses a schema instance to construct a producer instance. </p><p>The schema instance defines the schema for the data being produced using the producer instance. </p><p>Take AVRO as an example, Pulsar extract schema definition from the POJO class and construct the <code>SchemaInfo</code> that the producer needs to pass to a broker when it connects.</p></li><li><p>The producer connects to the broker with the <code>SchemaInfo</code> extracted from the passed-in schema instance.</p></li><li><p>The broker looks up the schema in the schema storage to check if it is already a registered schema. </p></li><li><p>If yes, the broker skips the schema validation since it is a known schema, and returns the schema version to the producer.</p></li><li><p>If no, the broker verifies whether a schema can be automatically created in this namespace:</p></li></ol><ul><li>If <code>isAllowAutoUpdateSchema</code> sets to <strong>true</strong>, then a schema can be created, and the broker validates the schema based on the schema compatibility check strategy defined for the topic.</li><li>If <code>isAllowAutoUpdateSchema</code> sets to <strong>false</strong>, then a schema can not be created, and the producer is rejected to connect to the broker.</li></ul><p><strong>Tip</strong>:</p><p><code>isAllowAutoUpdateSchema</code> can be set via <strong>Pulsar admin API</strong> or <strong>REST API.</strong> </p><p>For how to set <code>isAllowAutoUpdateSchema</code> via Pulsar admin API, see <a href="/docs/2.8.2/schema-manage/#manage-autoupdate-strategy">Manage AutoUpdate Strategy</a>. </p><ol start="6"><li>If the schema is allowed to be updated, then the compatible strategy check is performed.</li></ol><ul><li><p>If the schema is compatible, the broker stores it and returns the schema version to the producer. </p><p>All the messages produced by this producer are tagged with the schema version. </p></li><li><p>If the schema is incompatible, the broker rejects it.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="consumer-side">Consumer side<a class="hash-link" href="#consumer-side" title="Direct link to heading">â€‹</a></h3><p>This diagram illustrates how does Schema work on the consumer side. </p><p><img alt="Schema works at the consumer side" src="/assets/images/schema-consumer-436361129cf2d37ee3764960fb377789.png"></p><ol><li><p>The application uses a schema instance to construct a consumer instance.</p><p>The schema instance defines the schema that the consumer uses for decoding messages received from a broker.</p></li><li><p>The consumer connects to the broker with the <code>SchemaInfo</code> extracted from the passed-in schema instance.</p></li><li><p>The broker determines whether the topic has one of them (a schema/data/a local consumer and a local producer).</p></li><li><p>If a topic does not have all of them (a schema/data/a local consumer and a local producer):</p><ul><li>If <code>isAllowAutoUpdateSchema</code> sets to <strong>true</strong>, then the consumer registers a schema and it is connected to a broker.</li><li>If <code>isAllowAutoUpdateSchema</code> sets to <strong>false</strong>, then the consumer is rejected to connect to a broker.</li></ul></li><li><p>If a topic has one of them (a schema/data/a local consumer and a local producer), then the schema compatibility check is performed.</p><ul><li>If the schema passes the compatibility check, then the consumer is connected to the broker.</li><li>If the schema does not pass the compatibility check, then the consumer is rejected to connect to the broker. </li></ul></li><li><p>The consumer receives messages from the broker. </p><p>If the schema used by the consumer supports schema versioning (for example, AVRO schema), the consumer fetches the <code>SchemaInfo</code> of the version tagged in messages and uses the passed-in schema and the schema tagged in messages to decode the messages.</p></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/website-next/versioned_docs/version-2.8.2/schema-understand.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/2.8.2/schema-get-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Get started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/2.8.2/schema-evolution-compatibility"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Schema evolution and compatibility</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#schemainfo" class="table-of-contents__link toc-highlight">SchemaInfo</a></li><li><a href="#schema-type" class="table-of-contents__link toc-highlight">Schema type</a><ul><li><a href="#primitive-type" class="table-of-contents__link toc-highlight">Primitive type</a></li><li><a href="#complex-type" class="table-of-contents__link toc-highlight">Complex type</a></li><li><a href="#auto-schema" class="table-of-contents__link toc-highlight">Auto Schema</a></li></ul></li><li><a href="#schema-version" class="table-of-contents__link toc-highlight">Schema version</a></li><li><a href="#how-does-schema-work" class="table-of-contents__link toc-highlight">How does schema work</a><ul><li><a href="#producer-side" class="table-of-contents__link toc-highlight">Producer side</a></li><li><a href="#consumer-side" class="table-of-contents__link toc-highlight">Consumer side</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Inc.Copyright Â© 2022 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7e088baf.js"></script>
<script src="/assets/js/main.c54b7d6d.js"></script>
</body>
</html>