<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.8.3 plugin-docs plugin-id-default docs-doc-id-client-libraries-node">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Apache Pulsar Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache Pulsar" href="/zh-CN/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@300;400;600,900&display=swap">
<script src="https://cdn.jsdelivr.net/npm/sine-waves@0.3.0/sine-waves.min.js" async></script><title data-rh="true">The Pulsar Node.js client | Apache Pulsar</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pulsar.apache.org/zh-CN/docs/2.8.3/client-libraries-node"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="2.8.3"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.8.3"><meta data-rh="true" name="docsearch:version" content="2.8.3"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.8.3"><meta data-rh="true" property="og:title" content="The Pulsar Node.js client | Apache Pulsar"><meta data-rh="true" name="description" content="The Pulsar Node.js client can be used to create Pulsar producers, consumers, and readers in Node.js."><meta data-rh="true" property="og:description" content="The Pulsar Node.js client can be used to create Pulsar producers, consumers, and readers in Node.js."><link data-rh="true" rel="icon" href="/zh-CN/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pulsar.apache.org/zh-CN/docs/2.8.3/client-libraries-node"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/docs/2.8.3/client-libraries-node" hreflang="en"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/zh-CN/docs/2.8.3/client-libraries-node" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/zh-TW/docs/2.8.3/client-libraries-node" hreflang="zh-TW"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/ja/docs/2.8.3/client-libraries-node" hreflang="ja"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/fr/docs/2.8.3/client-libraries-node" hreflang="fr"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/ko/docs/2.8.3/client-libraries-node" hreflang="ko"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/docs/2.8.3/client-libraries-node" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://d226a455cecdd4bc18a554c1b47e5b52-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh-CN/assets/css/styles.71bbc241.css">
<link rel="preload" href="/zh-CN/assets/js/runtime~main.756f53b3.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/main.0336026c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Ë∑≥Âà∞‰∏ªÂÜÖÂÆπ</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><div class="navbar__logo"><img src="/zh-CN/img/logo.svg" alt="pulasr logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/zh-CN/img/logo.svg" alt="pulasr logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Get Started</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/zh-CN/docs/2.8.3/concepts-overview">Pulsar Concepts</a></li><li><a class="dropdown__link navbar__link--active" href="/zh-CN/docs/2.8.3/standalone">Quickstart</a></li><li><a class="dropdown__link" href="/zh-CN/ecosystem">Ecosystem</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-CN/docs/next/">Docs</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link community-dropdown">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link scroll-link scroll-welcome" id="scroll-welcome" href="/zh-CN/community#section-welcome">Welcome</a></li><li><a class="dropdown__link scroll-link scroll-discussions" id="scroll-discussions" href="/zh-CN/community#section-discussions">Discussions</a></li><li><a class="dropdown__link scroll-link" id="scroll-governance" href="/zh-CN/community#section-governance">Governance</a></li><li><a class="dropdown__link scroll-link" id="scroll-community" href="/zh-CN/community#section-community">Meet the Community</a></li><li><a class="dropdown__link scroll-link" id="scroll-contribute" href="/zh-CN/community#section-contribute">Contribute</a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Wiki</a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link">Issue Tracking</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-CN/blog">Blog</a></li><li><a class="dropdown__link" href="/zh-CN/case-studies">Case Studies</a></li><li><a class="dropdown__link" href="/zh-CN/resources">Resources</a></li><li><a class="dropdown__link" href="/zh-CN/events">Events</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>ÁÆÄ‰Ωì‰∏≠Êñá</span></span></a><ul class="dropdown__menu"><li><a href="/docs/2.8.3/client-libraries-node" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/zh-CN/docs/2.8.3/client-libraries-node" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">ÁÆÄ‰Ωì‰∏≠Êñá</a></li><li><a href="/zh-TW/docs/2.8.3/client-libraries-node" target="_self" rel="noopener noreferrer" class="dropdown__link">ÁπÅ‰Ωì‰∏≠Êñá</a></li><li><a href="/ja/docs/2.8.3/client-libraries-node" target="_self" rel="noopener noreferrer" class="dropdown__link">Êó•Êú¨Ë™û</a></li><li><a href="/fr/docs/2.8.3/client-libraries-node" target="_self" rel="noopener noreferrer" class="dropdown__link">Fran√ßais</a></li><li><a href="/ko/docs/2.8.3/client-libraries-node" target="_self" rel="noopener noreferrer" class="dropdown__link">ÌïúÍµ≠Ïñ¥</a></li></ul></div><a class="navbar__item navbar__link download-btn pill-btn" href="/zh-CN/download">Download</a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="ÂõûÂà∞È°∂ÈÉ®" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_mhZE"><div class="sidebarVersionSwitch_EHpo">Version:<div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/zh-CN/docs/2.8.3/">2.8.3</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh-CN/docs/2.8.3/client-libraries-node">2.8.3</a></li><li><a class="dropdown__link" href="/zh-CN/versions">Other</a></li></ul></div></div><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-CN/docs/2.8.3/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/standalone">Get Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/concepts-overview">Concepts and Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/schema-get-started">Pulsar Schema</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/functions-overview">Pulsar Functions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/io-overview">Pulsar IO</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/sql-overview">Pulsar SQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/tiered-storage-overview">Tiered Storage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/txn-why">Transactions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/helm-overview">Kubernetes (Helm)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/deploy-aws">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/administration-zk-bk">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/security-overview">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/performance-pulsar-perf">Performance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh-CN/docs/2.8.3/client-libraries">Client Libraries</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.8.3/client-libraries">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.8.3/client-libraries-java">Java</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.8.3/client-libraries-go">Go</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.8.3/client-libraries-python">Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.8.3/client-libraries-cpp">C++</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-CN/docs/2.8.3/client-libraries-node">Node.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.8.3/client-libraries-websocket">WebSocket</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.8.3/client-libraries-dotnet">C#</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/admin-api-overview">Admin API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/adaptors-kafka">Adaptors</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/cookbooks-compaction">Cookbooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/develop-tools">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-CN/docs/2.8.3/reference-terminology">Reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/zh-CN/">üè†</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">Client Libraries</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Node.js</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>The Pulsar Node.js client</h1></header><p>The Pulsar Node.js client can be used to create Pulsar <a href="#producers">producers</a>, <a href="#consumers">consumers</a>, and <a href="#readers">readers</a> in Node.js.</p><p>All the methods in <a href="#producers">producers</a>, <a href="#consumers">consumers</a>, and <a href="#readers">readers</a> of a Node.js client are thread-safe.</p><p>For 1.3.0 or later versions, <a href="https://github.com/apache/pulsar-client-node/blob/master/index.d.ts" target="_blank" rel="noopener noreferrer">type definitions</a> used in TypeScript are available.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="installation">Installation<a class="hash-link" href="#installation" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h2><p>You can install the <a href="https://www.npmjs.com/package/pulsar-client" target="_blank" rel="noopener noreferrer"><code>pulsar-client</code></a> library via <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">npm</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="requirements">Requirements<a class="hash-link" href="#requirements" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>Pulsar Node.js client library is based on the C++ client library.
Follow <a href="/zh-CN/docs/2.8.3/client-libraries-cpp#compilation">these instructions</a> and install the Pulsar C++ client library.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="compatibility">Compatibility<a class="hash-link" href="#compatibility" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>Compatibility between each version of the Node.js client and the C++ client is as follows:</p><table><thead><tr><th align="left">Node.js client</th><th align="left">C++ client</th></tr></thead><tbody><tr><td align="left">1.0.0</td><td align="left">2.3.0 or later</td></tr><tr><td align="left">1.1.0</td><td align="left">2.4.0 or later</td></tr><tr><td align="left">1.2.0</td><td align="left">2.5.0 or later</td></tr></tbody></table><p>If an incompatible version of the C++ client is installed, you may fail to build or run this library.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="installation-using-npm">Installation using npm<a class="hash-link" href="#installation-using-npm" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>Install the <code>pulsar-client</code> library via <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">npm</a>:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> pulsar-client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Also, this library works only in Node.js 10.x or later because it uses the <a href="https://github.com/nodejs/node-addon-api" target="_blank" rel="noopener noreferrer"><code>node-addon-api</code></a> module to wrap the C++ library.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="connection-urls">Connection URLs<a class="hash-link" href="#connection-urls" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h2><p>To connect to Pulsar using client libraries, you need to specify a <a href="/zh-CN/docs/2.8.3/developing-binary-protocol">Pulsar protocol</a> URL.</p><p>Pulsar protocol URLs are assigned to specific clusters, use the <code>pulsar</code> scheme and have a default port of 6650. Here is an example for <code>localhost</code>:</p><div class="codeBlockContainer_I0IT language-http theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-http codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar://localhost:6650</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>A URL for a production Pulsar cluster may look something like this:</p><div class="codeBlockContainer_I0IT language-http theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-http codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar://pulsar.us-west.example.com:6650</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>If you are using <a href="/zh-CN/docs/2.8.3/security-tls-transport">TLS encryption</a> or <a href="/zh-CN/docs/2.8.3/security-tls-authentication">TLS Authentication</a>, the URL looks like this:</p><div class="codeBlockContainer_I0IT language-http theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-http codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar+ssl://pulsar.us-west.example.com:6651</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="create-a-client">Create a client<a class="hash-link" href="#create-a-client" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h2><p>In order to interact with Pulsar, you first need a client object. You can create a client instance using a <code>new</code> operator and the <code>Client</code> method, passing in a client options object (more on configuration <a href="#client-configuration">below</a>).</p><p>Here is an example:</p><div class="codeBlockContainer_I0IT language-JavaScript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-JavaScript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const Pulsar = require(&#x27;pulsar-client&#x27;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(async () =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const client = new Pulsar.Client({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    serviceUrl: &#x27;pulsar://localhost:6650&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await client.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">})();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="client-configuration">Client configuration<a class="hash-link" href="#client-configuration" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>The following configurable parameters are available for Pulsar clients:</p><table><thead><tr><th align="left">Parameter</th><th align="left">Description</th><th align="left">Default</th></tr></thead><tbody><tr><td align="left"><code>serviceUrl</code></td><td align="left">The connection URL for the Pulsar cluster. See <a href="#connection-urls">above</a> for more info.</td><td align="left"></td></tr><tr><td align="left"><code>authentication</code></td><td align="left">Configure the authentication provider. (default: no authentication). See <a href="/zh-CN/docs/2.8.3/security-tls-authentication">TLS Authentication</a> for more info.</td><td align="left"></td></tr><tr><td align="left"><code>operationTimeoutSeconds</code></td><td align="left">The timeout for Node.js client operations (creating producers, subscribing to and unsubscribing from <a href="/zh-CN/docs/2.8.3/reference-terminology#topic">topics</a>). Retries occur until this threshold is reached, at which point the operation fails.</td><td align="left">30</td></tr><tr><td align="left"><code>ioThreads</code></td><td align="left">The number of threads to use for handling connections to Pulsar <a href="/zh-CN/docs/2.8.3/reference-terminology#broker">brokers</a>.</td><td align="left">1</td></tr><tr><td align="left"><code>messageListenerThreads</code></td><td align="left">The number of threads used by message listeners (<a href="#consumers">consumers</a> and <a href="#readers">readers</a>).</td><td align="left">1</td></tr><tr><td align="left"><code>concurrentLookupRequest</code></td><td align="left">The number of concurrent lookup requests that can be sent on each broker connection. Setting a maximum helps to keep from overloading brokers. You should set values over the default of 50000 only if the client needs to produce and/or subscribe to thousands of Pulsar topics.</td><td align="left">50000</td></tr><tr><td align="left"><code>tlsTrustCertsFilePath</code></td><td align="left">The file path for the trusted TLS certificate.</td><td align="left"></td></tr><tr><td align="left"><code>tlsValidateHostname</code></td><td align="left">The boolean value of setup whether to enable TLS hostname verification.</td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>tlsAllowInsecureConnection</code></td><td align="left">The boolean value of setup whether the Pulsar client accepts untrusted TLS certificate from broker.</td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>statsIntervalInSeconds</code></td><td align="left">Interval between each stat info. Stats is activated with positive statsInterval. The value should be set to 1 second at least</td><td align="left">600</td></tr><tr><td align="left"><code>log</code></td><td align="left">A function that is used for logging.</td><td align="left"><code>console.log</code></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="producers">Producers<a class="hash-link" href="#producers" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h2><p>Pulsar producers publish messages to Pulsar topics. You can <a href="#producer-configuration">configure</a> Node.js producers using a producer configuration object.</p><p>Here is an example:</p><div class="codeBlockContainer_I0IT language-JavaScript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-JavaScript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const producer = await client.createProducer({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  topic: &#x27;my-topic&#x27;, // or &#x27;my-tenant/my-namespace/my-topic&#x27; to specify topic&#x27;s tenant and namespace</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">});</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">await producer.send({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  data: Buffer.from(&quot;Hello, Pulsar&quot;),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">});</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">await producer.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><blockquote><h4 class="anchor anchorWithStickyNavbar_mojV" id="promise-operation">Promise operation<a class="hash-link" href="#promise-operation" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h4><p>When you create a new Pulsar producer, the operation returns <code>Promise</code> object and get producer instance or an error through executor function.<br>
<!-- -->In this example, using await operator instead of executor function.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="producer-operations">Producer operations<a class="hash-link" href="#producer-operations" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>Pulsar Node.js producers have the following methods available:</p><table><thead><tr><th align="left">Method</th><th align="left">Description</th><th align="left">Return type</th></tr></thead><tbody><tr><td align="left"><code>send(Object)</code></td><td align="left">Publishes a <a href="#messages">message</a> to the producer&#x27;s topic. When the message is successfully acknowledged by the Pulsar broker, or an error is thrown, the Promise object whose result is the message ID runs executor function.</td><td align="left"><code>Promise&lt;Object&gt;</code></td></tr><tr><td align="left"><code>flush()</code></td><td align="left">Sends message from send queue to Pulsar broker. When the message is successfully acknowledged by the Pulsar broker, or an error is thrown, the Promise object runs executor function.</td><td align="left"><code>Promise&lt;null&gt;</code></td></tr><tr><td align="left"><code>close()</code></td><td align="left">Closes the producer and releases all resources allocated to it. Once <code>close()</code> is called, no more messages are accepted from the publisher. This method returns a Promise object. It runs the executor function when all pending publish requests are persisted by Pulsar. If an error is thrown, no pending writes are retried.</td><td align="left"><code>Promise&lt;null&gt;</code></td></tr><tr><td align="left"><code>getProducerName()</code></td><td align="left">Getter method of the producer name.</td><td align="left"><code>string</code></td></tr><tr><td align="left"><code>getTopic()</code></td><td align="left">Getter method of the name of the topic.</td><td align="left"><code>string</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="producer-configuration">Producer configuration<a class="hash-link" href="#producer-configuration" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><table><thead><tr><th align="left">Parameter</th><th align="left">Description</th><th align="left">Default</th></tr></thead><tbody><tr><td align="left"><code>topic</code></td><td align="left">The Pulsar <a href="/zh-CN/docs/2.8.3/reference-terminology#topic">topic</a> to which the producer publishes messages. The topic format is <code>&lt;topic-name&gt;</code> or <code>&lt;tenant-name&gt;/&lt;namespace-name&gt;/&lt;topic-name&gt;</code>. For example, <code>sample/ns1/my-topic</code>.</td><td align="left"></td></tr><tr><td align="left"><code>producerName</code></td><td align="left">A name for the producer. If you do not explicitly assign a name, Pulsar automatically generates a globally unique name.  If you choose to explicitly assign a name, it needs to be unique across <em>all</em> Pulsar clusters, otherwise the creation operation throws an error.</td><td align="left"></td></tr><tr><td align="left"><code>sendTimeoutMs</code></td><td align="left">When publishing a message to a topic, the producer waits for an acknowledgment from the responsible Pulsar <a href="/zh-CN/docs/2.8.3/reference-terminology#broker">broker</a>. If a message is not acknowledged within the threshold set by this parameter, an error is thrown. If you set <code>sendTimeoutMs</code> to -1, the timeout is set to infinity (and thus removed). Removing the send timeout is recommended when using Pulsar&#x27;s <a href="/zh-CN/docs/2.8.3/cookbooks-deduplication">message de-duplication</a> feature.</td><td align="left">30000</td></tr><tr><td align="left"><code>initialSequenceId</code></td><td align="left">The initial sequence ID of the message. When producer send message, add sequence ID to message. The ID is increased each time to send.</td><td align="left"></td></tr><tr><td align="left"><code>maxPendingMessages</code></td><td align="left">The maximum size of the queue holding pending messages (i.e. messages waiting to receive an acknowledgment from the <a href="/zh-CN/docs/2.8.3/reference-terminology#broker">broker</a>). By default, when the queue is full all calls to the <code>send</code> method fails <em>unless</em> <code>blockIfQueueFull</code> is set to <code>true</code>.</td><td align="left">1000</td></tr><tr><td align="left"><code>maxPendingMessagesAcrossPartitions</code></td><td align="left">The maximum size of the sum of partition&#x27;s  pending queue.</td><td align="left">50000</td></tr><tr><td align="left"><code>blockIfQueueFull</code></td><td align="left">If set to <code>true</code>, the producer&#x27;s <code>send</code> method waits when the outgoing message queue is full rather than failing and throwing an error (the size of that queue is dictated by the <code>maxPendingMessages</code> parameter); if set to <code>false</code> (the default), <code>send</code> operations fails and throw a error when the queue is full.</td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>messageRoutingMode</code></td><td align="left">The message routing logic (for producers on <a href="/zh-CN/docs/2.8.3/concepts-messaging#partitioned-topics">partitioned topics</a>). This logic is applied only when no key is set on messages. The available options are: round robin (<code>RoundRobinDistribution</code>), or publishing all messages to a single partition (<code>UseSinglePartition</code>, the default).</td><td align="left"><code>UseSinglePartition</code></td></tr><tr><td align="left"><code>hashingScheme</code></td><td align="left">The hashing function that determines the partition on which a particular message is published (partitioned topics only). The available options are: <code>JavaStringHash</code> (the equivalent of <code>String.hashCode()</code> in Java), <code>Murmur3_32Hash</code> (applies the <a href="https://en.wikipedia.org/wiki/MurmurHash" target="_blank" rel="noopener noreferrer">Murmur3</a> hashing function), or <code>BoostHash</code> (applies the hashing function from C++&#x27;s <a href="https://www.boost.org/doc/libs/1_62_0/doc/html/hash.html" target="_blank" rel="noopener noreferrer">Boost</a> library).</td><td align="left"><code>BoostHash</code></td></tr><tr><td align="left"><code>compressionType</code></td><td align="left">The message data compression type used by the producer. The available options are <a href="https://github.com/lz4/lz4" target="_blank" rel="noopener noreferrer"><code>LZ4</code></a>, and <a href="https://zlib.net/" target="_blank" rel="noopener noreferrer"><code>Zlib</code></a>, <a href="https://github.com/facebook/zstd/" target="_blank" rel="noopener noreferrer">ZSTD</a>, <a href="https://github.com/google/snappy/" target="_blank" rel="noopener noreferrer">SNAPPY</a>.</td><td align="left">Compression None</td></tr><tr><td align="left"><code>batchingEnabled</code></td><td align="left">If set to <code>true</code>, the producer send message as batch.</td><td align="left"><code>true</code></td></tr><tr><td align="left"><code>batchingMaxPublishDelayMs</code></td><td align="left">The maximum time of delay sending message in batching.</td><td align="left">10</td></tr><tr><td align="left"><code>batchingMaxMessages</code></td><td align="left">The maximum size of sending message in each time of batching.</td><td align="left">1000</td></tr><tr><td align="left"><code>properties</code></td><td align="left">The metadata of producer.</td><td align="left"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="producer-example">Producer example<a class="hash-link" href="#producer-example" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>This example creates a Node.js producer for the <code>my-topic</code> topic and sends 10 messages to that topic:</p><div class="codeBlockContainer_I0IT language-JavaScript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-JavaScript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const Pulsar = require(&#x27;pulsar-client&#x27;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(async () =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const client = new Pulsar.Client({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    serviceUrl: &#x27;pulsar://localhost:6650&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a producer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const producer = await client.createProducer({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    topic: &#x27;my-topic&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Send messages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  for (let i = 0; i &lt; 10; i += 1) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const msg = `my-message-${i}`;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    producer.send({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      data: Buffer.from(msg),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    console.log(`Sent message: ${msg}`);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await producer.flush();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await producer.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await client.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">})();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="consumers">Consumers<a class="hash-link" href="#consumers" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h2><p>Pulsar consumers subscribe to one or more Pulsar topics and listen for incoming messages produced on that topic/those topics. You can <a href="#consumer-configuration">configure</a> Node.js consumers using a consumer configuration object.</p><p>Here is an example:</p><div class="codeBlockContainer_I0IT language-JavaScript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-JavaScript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const consumer = await client.subscribe({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  topic: &#x27;my-topic&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  subscription: &#x27;my-subscription&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">});</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const msg = await consumer.receive();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">console.log(msg.getData().toString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consumer.acknowledge(msg);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">await consumer.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><blockquote><h4 class="anchor anchorWithStickyNavbar_mojV" id="promise-operation-1">Promise operation<a class="hash-link" href="#promise-operation-1" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h4><p>When you create a new Pulsar consumer, the operation returns <code>Promise</code> object and get consumer instance or an error through executor function.<br>
<!-- -->In this example, using await operator instead of executor function.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="consumer-operations">Consumer operations<a class="hash-link" href="#consumer-operations" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>Pulsar Node.js consumers have the following methods available:</p><table><thead><tr><th align="left">Method</th><th align="left">Description</th><th align="left">Return type</th></tr></thead><tbody><tr><td align="left"><code>receive()</code></td><td align="left">Receives a single message from the topic. When the message is available, the Promise object run executor function and get message object.</td><td align="left"><code>Promise&lt;Object&gt;</code></td></tr><tr><td align="left"><code>receive(Number)</code></td><td align="left">Receives a single message from the topic with specific timeout in milliseconds.</td><td align="left"><code>Promise&lt;Object&gt;</code></td></tr><tr><td align="left"><code>acknowledge(Object)</code></td><td align="left"><a href="/zh-CN/docs/2.8.3/reference-terminology#acknowledgment-ack">Acknowledges</a> a message to the Pulsar <a href="/zh-CN/docs/2.8.3/reference-terminology#broker">broker</a> by message object.</td><td align="left"><code>void</code></td></tr><tr><td align="left"><code>acknowledgeId(Object)</code></td><td align="left"><a href="/zh-CN/docs/2.8.3/reference-terminology#acknowledgment-ack">Acknowledges</a> a message to the Pulsar <a href="/zh-CN/docs/2.8.3/reference-terminology#broker">broker</a> by message ID object.</td><td align="left"><code>void</code></td></tr><tr><td align="left"><code>acknowledgeCumulative(Object)</code></td><td align="left"><a href="/zh-CN/docs/2.8.3/reference-terminology#acknowledgment-ack">Acknowledges</a> <em>all</em> the messages in the stream, up to and including the specified message. The <code>acknowledgeCumulative</code> method returns void, and send the ack to the broker asynchronously. After that, the messages are <em>not</em> redelivered to the consumer. Cumulative acking can not be used with a <a href="/zh-CN/docs/2.8.3/concepts-messaging#shared">shared</a> subscription type.</td><td align="left"><code>void</code></td></tr><tr><td align="left"><code>acknowledgeCumulativeId(Object)</code></td><td align="left"><a href="/zh-CN/docs/2.8.3/reference-terminology#acknowledgment-ack">Acknowledges</a> <em>all</em> the messages in the stream, up to and including the specified message ID.</td><td align="left"><code>void</code></td></tr><tr><td align="left"><code>negativeAcknowledge(Message)</code></td><td align="left"><a href="/zh-CN/docs/2.8.3/reference-terminology#negative-acknowledgment-nack">Negatively acknowledges</a>  a message to the Pulsar broker by message object.</td><td align="left"><code>void</code></td></tr><tr><td align="left"><code>negativeAcknowledgeId(MessageId)</code></td><td align="left"><a href="/zh-CN/docs/2.8.3/reference-terminology#negative-acknowledgment-nack">Negatively acknowledges</a> a message to the Pulsar broker by message ID object.</td><td align="left"><code>void</code></td></tr><tr><td align="left"><code>close()</code></td><td align="left">Closes the consumer, disabling its ability to receive messages from the broker.</td><td align="left"><code>Promise&lt;null&gt;</code></td></tr><tr><td align="left"><code>unsubscribe()</code></td><td align="left">Unsubscribes the subscription.</td><td align="left"><code>Promise&lt;null&gt;</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="consumer-configuration">Consumer configuration<a class="hash-link" href="#consumer-configuration" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><table><thead><tr><th align="left">Parameter</th><th align="left">Description</th><th align="left">Default</th></tr></thead><tbody><tr><td align="left"><code>topic</code></td><td align="left">The Pulsar topic on which the consumer establishes a subscription and listen for messages.</td><td align="left"></td></tr><tr><td align="left"><code>topics</code></td><td align="left">The array of topics.</td><td align="left"></td></tr><tr><td align="left"><code>topicsPattern</code></td><td align="left">The regular expression for topics.</td><td align="left"></td></tr><tr><td align="left"><code>subscription</code></td><td align="left">The subscription name for this consumer.</td><td align="left"></td></tr><tr><td align="left"><code>subscriptionType</code></td><td align="left">Available options are <code>Exclusive</code>, <code>Shared</code>, <code>Key_Shared</code>, and <code>Failover</code>.</td><td align="left"><code>Exclusive</code></td></tr><tr><td align="left"><code>subscriptionInitialPosition</code></td><td align="left">Initial position at which to set cursor when subscribing to a topic at first time.</td><td align="left"><code>SubscriptionInitialPosition.Latest</code></td></tr><tr><td align="left"><code>ackTimeoutMs</code></td><td align="left">Acknowledge timeout in milliseconds.</td><td align="left">0</td></tr><tr><td align="left"><code>nAckRedeliverTimeoutMs</code></td><td align="left">Delay to wait before redelivering messages that failed to be processed.</td><td align="left">60000</td></tr><tr><td align="left"><code>receiverQueueSize</code></td><td align="left">Sets the size of the consumer&#x27;s receiver queue, i.e. the number of messages that can be accumulated by the consumer before the application calls <code>receive</code>. A value higher than the default of 1000 could increase consumer throughput, though at the expense of more memory utilization.</td><td align="left">1000</td></tr><tr><td align="left"><code>receiverQueueSizeAcrossPartitions</code></td><td align="left">Set the max total receiver queue size across partitions. This setting is used to reduce the receiver queue size for individual partitions if the total exceeds this value.</td><td align="left">50000</td></tr><tr><td align="left"><code>consumerName</code></td><td align="left">The name of consumer. Currently(v2.4.1), <a href="/zh-CN/docs/2.8.3/concepts-messaging#failover">failover</a> mode use consumer name in ordering.</td><td align="left"></td></tr><tr><td align="left"><code>properties</code></td><td align="left">The metadata of consumer.</td><td align="left"></td></tr><tr><td align="left"><code>listener</code></td><td align="left">A listener that is called for a message received.</td><td align="left"></td></tr><tr><td align="left"><code>readCompacted</code></td><td align="left">If enabling <code>readCompacted</code>, a consumer reads messages from a compacted topic rather than reading a full message backlog of a topic.<br><br>A consumer only sees the latest value for each key in the compacted topic, up until reaching the point in the topic message when compacting backlog. Beyond that point, send messages as normal.<br><br> <code>readCompacted</code> can only be enabled on subscriptions to persistent topics, which have a single active consumer (like failure or exclusive subscriptions).<br><br>Attempting to enable it on subscriptions to non-persistent topics or on shared subscriptions leads to a subscription call throwing a <code>PulsarClientException</code>.</td><td align="left">false</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="consumer-example">Consumer example<a class="hash-link" href="#consumer-example" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>This example creates a Node.js consumer with the <code>my-subscription</code> subscription on the <code>my-topic</code> topic, receives messages, prints the content that arrive, and acknowledges each message to the Pulsar broker for 10 times:</p><div class="codeBlockContainer_I0IT language-JavaScript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-JavaScript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const Pulsar = require(&#x27;pulsar-client&#x27;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(async () =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const client = new Pulsar.Client({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    serviceUrl: &#x27;pulsar://localhost:6650&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a consumer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const consumer = await client.subscribe({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    topic: &#x27;my-topic&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    subscription: &#x27;my-subscription&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    subscriptionType: &#x27;Exclusive&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Receive messages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  for (let i = 0; i &lt; 10; i += 1) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const msg = await consumer.receive();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    console.log(msg.getData().toString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    consumer.acknowledge(msg);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await consumer.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await client.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">})();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Instead a consumer can be created with <code>listener</code> to process messages.</p><div class="codeBlockContainer_I0IT language-JavaScript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-JavaScript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Create a consumer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const consumer = await client.subscribe({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  topic: &#x27;my-topic&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  subscription: &#x27;my-subscription&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  subscriptionType: &#x27;Exclusive&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  listener: (msg, msgConsumer) =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    console.log(msg.getData().toString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    msgConsumer.acknowledge(msg);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">});</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="readers">Readers<a class="hash-link" href="#readers" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h2><p>Pulsar readers process messages from Pulsar topics. Readers are different from consumers because with readers you need to explicitly specify which message in the stream you want to begin with (consumers, on the other hand, automatically begin with the most recently unacked message). You can <a href="#reader-configuration">configure</a> Node.js readers using a reader configuration object.</p><p>Here is an example:</p><div class="codeBlockContainer_I0IT language-JavaScript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-JavaScript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const reader = await client.createReader({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  topic: &#x27;my-topic&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  startMessageId: Pulsar.MessageId.earliest(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">});</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const msg = await reader.readNext();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">console.log(msg.getData().toString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">await reader.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="reader-operations">Reader operations<a class="hash-link" href="#reader-operations" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>Pulsar Node.js readers have the following methods available:</p><table><thead><tr><th align="left">Method</th><th align="left">Description</th><th align="left">Return type</th></tr></thead><tbody><tr><td align="left"><code>readNext()</code></td><td align="left">Receives the next message on the topic (analogous to the <code>receive</code> method for <a href="#consumer-operations">consumers</a>). When the message is available, the Promise object run executor function and get message object.</td><td align="left"><code>Promise&lt;Object&gt;</code></td></tr><tr><td align="left"><code>readNext(Number)</code></td><td align="left">Receives a single message from the topic with specific timeout in milliseconds.</td><td align="left"><code>Promise&lt;Object&gt;</code></td></tr><tr><td align="left"><code>hasNext()</code></td><td align="left">Return whether the broker has next message in target topic.</td><td align="left"><code>Boolean</code></td></tr><tr><td align="left"><code>close()</code></td><td align="left">Closes the reader, disabling its ability to receive messages from the broker.</td><td align="left"><code>Promise&lt;null&gt;</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="reader-configuration">Reader configuration<a class="hash-link" href="#reader-configuration" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><table><thead><tr><th align="left">Parameter</th><th align="left">Description</th><th align="left">Default</th></tr></thead><tbody><tr><td align="left"><code>topic</code></td><td align="left">The Pulsar <a href="/zh-CN/docs/2.8.3/reference-terminology#topic">topic</a> on which the reader establishes a subscription and listen for messages.</td><td align="left"></td></tr><tr><td align="left"><code>startMessageId</code></td><td align="left">The initial reader position, i.e. the message at which the reader begins processing messages. The options are <code>Pulsar.MessageId.earliest</code> (the earliest available message on the topic), <code>Pulsar.MessageId.latest</code> (the latest available message on the topic), or a message ID object for a position that is not earliest or latest.</td><td align="left"></td></tr><tr><td align="left"><code>receiverQueueSize</code></td><td align="left">Sets the size of the reader&#x27;s receiver queue, i.e. the number of messages that can be accumulated by the reader before the application calls <code>readNext</code>. A value higher than the default of 1000 could increase reader throughput, though at the expense of more memory utilization.</td><td align="left">1000</td></tr><tr><td align="left"><code>readerName</code></td><td align="left">The name of the reader.</td><td align="left"></td></tr><tr><td align="left"><code>subscriptionRolePrefix</code></td><td align="left">The subscription role prefix.</td><td align="left"></td></tr><tr><td align="left"><code>readCompacted</code></td><td align="left">If enabling <code>readCompacted</code>, a consumer reads messages from a compacted topic rather than reading a full message backlog of a topic.<br><br>A consumer only sees the latest value for each key in the compacted topic, up until reaching the point in the topic message when compacting backlog. Beyond that point, send messages as normal.<br><br> <code>readCompacted</code> can only be enabled on subscriptions to persistent topics, which have a single active consumer (like failure or exclusive subscriptions).<br><br>Attempting to enable it on subscriptions to non-persistent topics or on shared subscriptions leads to a subscription call throwing a <code>PulsarClientException</code>.</td><td align="left"><code>false</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="reader-example">Reader example<a class="hash-link" href="#reader-example" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>This example creates a Node.js reader with the <code>my-topic</code> topic, reads messages, and prints the content that arrive for 10 times:</p><div class="codeBlockContainer_I0IT language-JavaScript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-JavaScript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const Pulsar = require(&#x27;pulsar-client&#x27;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(async () =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const client = new Pulsar.Client({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    serviceUrl: &#x27;pulsar://localhost:6650&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    operationTimeoutSeconds: 30,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a reader</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const reader = await client.createReader({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    topic: &#x27;my-topic&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    startMessageId: Pulsar.MessageId.earliest(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // read messages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  for (let i = 0; i &lt; 10; i += 1) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const msg = await reader.readNext();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    console.log(msg.getData().toString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await reader.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await client.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">})();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="messages">Messages<a class="hash-link" href="#messages" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h2><p>In Pulsar Node.js client, you have to construct producer message object for producer.</p><p>Here is an example message:</p><div class="codeBlockContainer_I0IT language-JavaScript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-JavaScript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const msg = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  data: Buffer.from(&#x27;Hello, Pulsar&#x27;),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  partitionKey: &#x27;key1&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  properties: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;foo&#x27;: &#x27;bar&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  eventTimestamp: Date.now(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  replicationClusters: [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;cluster1&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;cluster2&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">await producer.send(msg);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The following keys are available for producer message objects:</p><table><thead><tr><th align="left">Parameter</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>data</code></td><td align="left">The actual data payload of the message.</td></tr><tr><td align="left"><code>properties</code></td><td align="left">A Object for any application-specific metadata attached to the message.</td></tr><tr><td align="left"><code>eventTimestamp</code></td><td align="left">The timestamp associated with the message.</td></tr><tr><td align="left"><code>sequenceId</code></td><td align="left">The sequence ID of the message.</td></tr><tr><td align="left"><code>partitionKey</code></td><td align="left">The optional key associated with the message (particularly useful for things like topic compaction).</td></tr><tr><td align="left"><code>replicationClusters</code></td><td align="left">The clusters to which this message is replicated. Pulsar brokers handle message replication automatically; you should only change this setting if you want to override the broker default.</td></tr><tr><td align="left"><code>deliverAt</code></td><td align="left">The absolute timestamp at or after which the message is delivered.</td></tr><tr><td align="left"><code>deliverAfter</code></td><td align="left">The relative delay after which the message is delivered.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="message-object-operations">Message object operations<a class="hash-link" href="#message-object-operations" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>In Pulsar Node.js client, you can receive (or read) message object as consumer (or reader).</p><p>The message object have the following methods available:</p><table><thead><tr><th align="left">Method</th><th align="left">Description</th><th align="left">Return type</th></tr></thead><tbody><tr><td align="left"><code>getTopicName()</code></td><td align="left">Getter method of topic name.</td><td align="left"><code>String</code></td></tr><tr><td align="left"><code>getProperties()</code></td><td align="left">Getter method of properties.</td><td align="left"><code>Array&lt;Object&gt;</code></td></tr><tr><td align="left"><code>getData()</code></td><td align="left">Getter method of message data.</td><td align="left"><code>Buffer</code></td></tr><tr><td align="left"><code>getMessageId()</code></td><td align="left">Getter method of <a href="#message-id-object-operations">message id object</a>.</td><td align="left"><code>Object</code></td></tr><tr><td align="left"><code>getPublishTimestamp()</code></td><td align="left">Getter method of publish timestamp.</td><td align="left"><code>Number</code></td></tr><tr><td align="left"><code>getEventTimestamp()</code></td><td align="left">Getter method of event timestamp.</td><td align="left"><code>Number</code></td></tr><tr><td align="left"><code>getRedeliveryCount()</code></td><td align="left">Getter method of redelivery count.</td><td align="left"><code>Number</code></td></tr><tr><td align="left"><code>getPartitionKey()</code></td><td align="left">Getter method of partition key.</td><td align="left"><code>String</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="message-id-object-operations">Message ID object operations<a class="hash-link" href="#message-id-object-operations" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>In Pulsar Node.js client, you can get message id object from message object.</p><p>The message id object have the following methods available:</p><table><thead><tr><th align="left">Method</th><th align="left">Description</th><th align="left">Return type</th></tr></thead><tbody><tr><td align="left"><code>serialize()</code></td><td align="left">Serialize the message id into a Buffer for storing.</td><td align="left"><code>Buffer</code></td></tr><tr><td align="left"><code>toString()</code></td><td align="left">Get message id as String.</td><td align="left"><code>String</code></td></tr></tbody></table><p>The client has static method of message id object. You can access it as <code>Pulsar.MessageId.someStaticMethod</code> too.</p><p>The following static methods are available for the message id object:</p><table><thead><tr><th align="left">Method</th><th align="left">Description</th><th align="left">Return type</th></tr></thead><tbody><tr><td align="left"><code>earliest()</code></td><td align="left">MessageId representing the earliest, or oldest available message stored in the topic.</td><td align="left"><code>Object</code></td></tr><tr><td align="left"><code>latest()</code></td><td align="left">MessageId representing the latest, or last published message in the topic.</td><td align="left"><code>Object</code></td></tr><tr><td align="left"><code>deserialize(Buffer)</code></td><td align="left">Deserialize a message id object from a Buffer.</td><td align="left"><code>Object</code></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="end-to-end-encryption">End-to-end encryption<a class="hash-link" href="#end-to-end-encryption" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h2><p><a href="https://pulsar.apache.org/docs/en/next/cookbooks-encryption/#docsNav" target="_blank" rel="noopener noreferrer">End-to-end encryption</a> allows applications to encrypt messages at producers and decrypt at consumers.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="configuration">Configuration<a class="hash-link" href="#configuration" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>If you want to use the end-to-end encryption feature in the Node.js client, you need to configure <code>publicKeyPath</code> and <code>privateKeyPath</code> for both producer and consumer.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">publicKeyPath: &quot;./public.pem&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">privateKeyPath: &quot;./private.pem&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="tutorial">Tutorial<a class="hash-link" href="#tutorial" title="ÈìæÊé•Âà∞Ê†áÈ¢ò">‚Äã</a></h3><p>This section provides step-by-step instructions on how to use the end-to-end encryption feature in the Node.js client.</p><p><strong>Prerequisite</strong></p><ul><li>Pulsar C++ client 2.7.1 or later </li></ul><p><strong>Step</strong></p><ol><li><p>Create both public and private key pairs.</p><p><strong>Input</strong></p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl genrsa -out private.pem </span><span class="token number">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl rsa -in private.pem -pubout -out public.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>Create a producer to send encrypted messages.</p><p><strong>Input</strong></p><div class="codeBlockContainer_I0IT language-nodejs theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-nodejs codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const Pulsar = require(&#x27;pulsar-client&#x27;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(async () =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const client = new Pulsar.Client({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    serviceUrl: &#x27;pulsar://localhost:6650&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    operationTimeoutSeconds: 30,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a producer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const producer = await client.createProducer({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    topic: &#x27;persistent://public/default/my-topic&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sendTimeoutMs: 30000,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    batchingEnabled: true,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    publicKeyPath: &quot;./public.pem&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    privateKeyPath: &quot;./private.pem&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    encryptionKey: &quot;encryption-key&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  console.log(producer.ProducerConfig)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Send messages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  for (let i = 0; i &lt; 10; i += 1) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const msg = `my-message-${i}`;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    producer.send({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      data: Buffer.from(msg),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    console.log(`Sent message: ${msg}`);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await producer.flush();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await producer.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await client.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">})();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>Create a consumer to receive encrypted messages.</p><p><strong>Input</strong></p><div class="codeBlockContainer_I0IT language-nodejs theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-nodejs codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const Pulsar = require(&#x27;pulsar-client&#x27;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(async () =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const client = new Pulsar.Client({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    serviceUrl: &#x27;pulsar://172.25.0.3:6650&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    operationTimeoutSeconds: 30</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Create a consumer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  const consumer = await client.subscribe({</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    topic: &#x27;persistent://public/default/my-topic&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    subscription: &#x27;sub1&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    subscriptionType: &#x27;Shared&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ackTimeoutMs: 10000,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    publicKeyPath: &quot;./public.pem&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    privateKeyPath: &quot;./private.pem&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  console.log(consumer)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Receive messages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  for (let i = 0; i &lt; 10; i += 1) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const msg = await consumer.receive();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    console.log(msg.getData().toString());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    consumer.acknowledge(msg);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await consumer.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  await client.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">})();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>Run the consumer to receive encrypted messages.</p><p><strong>Input</strong></p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">node</span><span class="token plain"> consumer.js</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>In a new terminal tab, run the producer to produce encrypted messages.</p><p><strong>Input</strong></p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">node</span><span class="token plain"> producer.js</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Now you can see the producer sends messages and the consumer receives messages successfully.</p><p><strong>Output</strong></p><p>This is from the producer side.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sent message: my-message-9</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>This is from the consumer side.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#F8F8F2;background-color:#282A36"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">my-message-9</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/versioned_docs/version-2.8.3/client-libraries-node.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Â∏ÆÂä©ÊîπËøõÊú¨È°µÈù¢</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ÊñáÊ°£È°µÈù¢ÂØºËà™"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh-CN/docs/2.8.3/client-libraries-cpp"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">C++</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh-CN/docs/2.8.3/client-libraries-websocket"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">WebSocket</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a><ul><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#compatibility" class="table-of-contents__link toc-highlight">Compatibility</a></li><li><a href="#installation-using-npm" class="table-of-contents__link toc-highlight">Installation using npm</a></li></ul></li><li><a href="#connection-urls" class="table-of-contents__link toc-highlight">Connection URLs</a></li><li><a href="#create-a-client" class="table-of-contents__link toc-highlight">Create a client</a><ul><li><a href="#client-configuration" class="table-of-contents__link toc-highlight">Client configuration</a></li></ul></li><li><a href="#producers" class="table-of-contents__link toc-highlight">Producers</a><ul><li><a href="#producer-operations" class="table-of-contents__link toc-highlight">Producer operations</a></li><li><a href="#producer-configuration" class="table-of-contents__link toc-highlight">Producer configuration</a></li><li><a href="#producer-example" class="table-of-contents__link toc-highlight">Producer example</a></li></ul></li><li><a href="#consumers" class="table-of-contents__link toc-highlight">Consumers</a><ul><li><a href="#consumer-operations" class="table-of-contents__link toc-highlight">Consumer operations</a></li><li><a href="#consumer-configuration" class="table-of-contents__link toc-highlight">Consumer configuration</a></li><li><a href="#consumer-example" class="table-of-contents__link toc-highlight">Consumer example</a></li></ul></li><li><a href="#readers" class="table-of-contents__link toc-highlight">Readers</a><ul><li><a href="#reader-operations" class="table-of-contents__link toc-highlight">Reader operations</a></li><li><a href="#reader-configuration" class="table-of-contents__link toc-highlight">Reader configuration</a></li><li><a href="#reader-example" class="table-of-contents__link toc-highlight">Reader example</a></li></ul></li><li><a href="#messages" class="table-of-contents__link toc-highlight">Messages</a><ul><li><a href="#message-object-operations" class="table-of-contents__link toc-highlight">Message object operations</a></li><li><a href="#message-id-object-operations" class="table-of-contents__link toc-highlight">Message ID object operations</a></li></ul></li><li><a href="#end-to-end-encryption" class="table-of-contents__link toc-highlight">End-to-end encryption</a><ul><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#tutorial" class="table-of-contents__link toc-highlight">Tutorial</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Apache Foundation.</div><ul class="footer__items"><li class="footer__item">
	              <img class="footer-apache-logo" src="/img/Apache_Feather_Logo.svg" alt="" width="20">
	              </li><li class="footer__item"><a href="http://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"> </div><ul class="footer__items"><li class="footer__item">
	              <div><small><strong>Apache Pulsar is available under the <a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache License, version 2.0.</a></strong></small></div>
                <div>Apache Pulsar is a distributed, open source pub-sub messaging and streaming platform for real-time workloads, managing hundreds of billions of events per day.</div>
	              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_gHmE" href="/zh-CN/"><img src="/zh-CN/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/zh-CN/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></a></div><div class="footer__copyright"><p>Apache Pulsar is available under the Apache License, version 2.0.</p>
      <p>Copyright ¬© 2022 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</p></div></div></div></footer></div>
<script src="/zh-CN/assets/js/runtime~main.756f53b3.js"></script>
<script src="/zh-CN/assets/js/main.0336026c.js"></script>
</body>
</html>