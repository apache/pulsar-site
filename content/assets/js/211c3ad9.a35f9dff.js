"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[9521],{44564:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"personal-ci","title":"Personal CI","description":"Pulsar CI is currently hosted on Apache Infra resources. Since we cannot add more resources to Pulsar CI, we need to find other ways to reduce the load on Pulsar CI.","source":"@site/contribute/personal-ci.md","sourceDirName":".","slug":"/personal-ci","permalink":"/contribute/personal-ci","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/pulsar-site/edit/main/contribute/personal-ci.md","tags":[],"version":"current","lastUpdatedBy":"Lari Hotari","lastUpdatedAt":1733478861000,"frontMatter":{"id":"personal-ci","title":"Personal CI"},"sidebar":"sidebarDevelopment","previous":{"title":"License header","permalink":"/contribute/testing-licenses"},"next":{"title":"Introduction","permalink":"/contribute/site-intro"}}');var r=s(74848),o=s(28453);const i={id:"personal-ci",title:"Personal CI"},a=void 0,c={},l=[{value:"CI workflows in a fork",id:"ci-workflows-in-a-fork",level:2},{value:"Stay in-sync with upstream",id:"stay-in-sync-with-upstream",level:2},{value:"SSH to CI jobs",id:"ssh-to-ci-jobs",level:2}];function h(e){const t={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"Pulsar CI is currently hosted on Apache Infra resources. Since we cannot add more resources to Pulsar CI, we need to find other ways to reduce the load on Pulsar CI."}),"\n",(0,r.jsxs)(t.p,{children:["After ",(0,r.jsx)(t.a,{href:"https://github.com/apache/pulsar/pull/17693",children:"PR-17693"})," merged, any pull request directly sent to ",(0,r.jsx)(t.code,{children:"apache/pulsar"})," won't be triggered anymore."]}),"\n",(0,r.jsx)(t.p,{children:"That said, pull requests should be first tested in your own fork. GitHub Actions provides separate quota for pull requests that are executed in a forked repository."}),"\n",(0,r.jsx)(t.h2,{id:"ci-workflows-in-a-fork",children:"CI workflows in a fork"}),"\n",(0,r.jsx)(t.p,{children:"Here are instructions to use your personal CI on GitHub:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"Push your intended pull request changes to a new branch in your fork (the usual way you do it)."}),"\n",(0,r.jsx)(t.li,{children:"Open a pull request to your own fork."}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Below are the instructions for command-line interface."}),"\n",(0,r.jsxs)(t.p,{children:["Firstly, install ",(0,r.jsx)(t.a,{href:"https://cli.github.com/",children:"GitHub CLI"})," and configure it. With GitHub CLI, there's an easy way to open the PR to your own fork with a single command:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"gh pr create --repo=<your-github-id>/pulsar --base master --head <your-pr-branch> -f\n"})}),"\n",(0,r.jsx)(t.p,{children:'Alternatively, you can also create a PR to your own fork in the GitHub UI when opening a new PR. To do so, first click on "compare across forks" and then choose your own fork as both the forked repository and head repository.'}),"\n",(0,r.jsx)(t.h2,{id:"stay-in-sync-with-upstream",children:"Stay in-sync with upstream"}),"\n",(0,r.jsx)(t.p,{children:"It's worth keeping your master branch in sync with apache/pulsar's master (the upstream) so that the diff of PR will be reasonable in your own fork."}),"\n",(0,r.jsxs)(t.p,{children:["Read more about the instructions to sync a fork from the WebUI, from the GitHub CI, or from the command line at ",(0,r.jsx)(t.a,{href:"https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/working-with-forks/syncing-a-fork",children:"Syncing a fork"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"ssh-to-ci-jobs",children:"SSH to CI jobs"}),"\n",(0,r.jsxs)(t.p,{children:['The additional benefit of the "Personal CI" is that you get SSH access to the build VMs when the build is running. That is handled by this logic in the ',(0,r.jsx)(t.a,{href:"https://github.com/apache/pulsar/blob/master/.github/workflows/pulsar-ci.yaml",children:"pulsar-ci.yaml"})," GitHub Actions workflow file:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"- name: Setup ssh access to build runner VM\n  # ssh access is enabled for builds in own forks\n  if: ${{ github.repository != 'apache/pulsar' && github.event_name == 'pull_request' }}\n  uses: ./.github/actions/ssh-access\n  with:\n    limit-access-to-actor: true\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Here is ",(0,r.jsxs)(t.a,{href:"https://github.com/apache/pulsar/blob/master/.github/actions/ssh-access/action.yml",children:["the inline ",(0,r.jsx)(t.code,{children:"ssh-access"})," composite action implementation"]}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["The SSH access is secured with the SSH key registered in GitHub. For example, your public keys are ",(0,r.jsx)(t.a,{href:"https://github.com/horizonzy.keys",children:"https://github.com/horizonzy.keys"}),". You will first have to register an SSH public key in GitHub for that to work."]})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>i,x:()=>a});var n=s(96540);const r={},o=n.createContext(r);function i(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);