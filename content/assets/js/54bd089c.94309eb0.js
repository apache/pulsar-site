"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[2263],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>h});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=r.createContext({}),u=function(e){var t=r.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=u(e.components);return r.createElement(i.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,i=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=u(a),h=n,m=c["".concat(i,".").concat(h)]||c[h]||p[h]||s;return a?r.createElement(m,o(o({ref:t},d),{},{components:a})):r.createElement(m,o({ref:t},d))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,o=new Array(s);o[0]=c;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var u=2;u<s;u++)o[u]=a[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}c.displayName="MDXCreateElement"},11122:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>l,toc:()=>u});var r=a(87462),n=(a(67294),a(3905));const s={author:"gaoran10, Anonymitaet",title:"What\u2019s New in Apache Pulsar 2.9.2"},o=void 0,l={permalink:"/blog/2022/04/08/Apache-Pulsar-2-9-2",editUrl:"https://github.com/apache/pulsar-site/edit/main/site2/website-next/blog/2022-04-08-Apache-Pulsar-2-9-2.md",source:"@site/blog/2022-04-08-Apache-Pulsar-2-9-2.md",title:"What\u2019s New in Apache Pulsar 2.9.2",description:"The Apache Pulsar community releases version 2.9.2! 60 contributors provided improvements and bug fixes that delivered 317 commits.",date:"2022-04-08T00:00:00.000Z",formattedDate:"April 8, 2022",tags:[],readingTime:3.37,hasTruncateMarker:!0,authors:[{name:"gaoran10, Anonymitaet"}],frontMatter:{author:"gaoran10, Anonymitaet",title:"What\u2019s New in Apache Pulsar 2.9.2"},prevItem:{title:"The Apache Pulsar Community Welcomes 500th Contributor!",permalink:"/blog/2022/05/11/apache-pulsar-community-welcomes-500th-contributor"},nextItem:{title:"What\u2019s New in Apache Pulsar 2.7.4",permalink:"/blog/2021/12/14/Apache-Pulsar-2-7-4"}},i={authorsImageUrls:[void 0]},u=[{value:"Readers continue to read data from the compacted ledgers. PR-13629",id:"readers-continue-to-read-data-from-the-compacted-ledgers-pr-13629",level:3},{value:"Issue",id:"issue",level:4},{value:"Resolution",id:"resolution",level:4},{value:"Brokers decrease the number of unacked messages. PR-13383",id:"brokers-decrease-the-number-of-unacked-messages-pr-13383",level:3},{value:"Issue",id:"issue-1",level:4},{value:"Resolution",id:"resolution-1",level:4},{value:"Chunked messages can be queried through Pulsar SQL. PR-12720",id:"chunked-messages-can-be-queried-through-pulsar-sql-pr-12720",level:3},{value:"Issue",id:"issue-2",level:4},{value:"Resolution",id:"resolution-2",level:4},{value:"Support enable or disable schema upload at the broker level. PR-12786",id:"support-enable-or-disable-schema-upload-at-the-broker-level-pr-12786",level:3},{value:"Issue",id:"issue-3",level:4},{value:"Resolution",id:"resolution-3",level:4},{value:"Readers can read the latest messages in compacted topics. PR-14449",id:"readers-can-read-the-latest-messages-in-compacted-topics-pr-14449",level:3},{value:"Issue",id:"issue-4",level:4},{value:"Resolution",id:"resolution-4",level:4},{value:"Transaction sequenceId can be recovered correctly. PR-13209",id:"transaction-sequenceid-can-be-recovered-correctly-pr-13209",level:3},{value:"Issue",id:"issue-5",level:4},{value:"Resolution",id:"resolution-5",level:4},{value:"Transactions performance test tool is available. PR-11933",id:"transactions-performance-test-tool-is-available-pr-11933",level:3},{value:"Issue",id:"issue-6",level:4},{value:"Resolution",id:"resolution-6",level:4},{value:"Port exhaustion and connection issues no longer exist in Pulsar Proxy. PR-14078",id:"port-exhaustion-and-connection-issues-no-longer-exist-in-pulsar-proxy-pr-14078",level:3},{value:"Issue",id:"issue-7",level:4},{value:"Resolution",id:"resolution-7",level:4},{value:"No race condition in <code>OpSendMsgQueue</code> when publishing messages. PR-14231",id:"no-race-condition-in-opsendmsgqueue-when-publishing-messages-pr-14231",level:3},{value:"Issue",id:"issue-8",level:4},{value:"Resolution",id:"resolution-8",level:4},{value:"Change <code>ContextClassLoader</code> to <code>NarClassLoader</code> in AdditionalServlet. PR-13501",id:"change-contextclassloader-to-narclassloader-in-additionalservlet-pr-13501",level:3},{value:"Issue",id:"issue-9",level:4},{value:"Resolution",id:"resolution-9",level:4}],d={toc:u};function p(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"The Apache Pulsar community releases version 2.9.2! 60 contributors provided improvements and bug fixes that delivered 317 commits."),(0,n.kt)("p",null,"Highlights of this release are as below:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Transactions performance test tool is available. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/pulsar/pull/11933"},"PR-11933")),(0,n.kt)("li",{parentName:"ul"},"Brokers decrease the number of unacked messages. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/pulsar/pull/13383"},"PR-13383")),(0,n.kt)("li",{parentName:"ul"},"Readers continue to read data from the compacted ledgers. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/pulsar/pull/13629"},"PR-13629"))),(0,n.kt)("p",null,"This blog walks through the most noteworthy changes grouped by the affected functionalities. For the complete list including all features, enhancements, and bug fixes, check out the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/pulsar/releases/tag/v2.9.2"},"Pulsar 2.9.2 Release Notes"),"."),(0,n.kt)("h1",{id:"notable-bug-fixes-and-enhancements"},"Notable bug fixes and enhancements"),(0,n.kt)("h3",{id:"readers-continue-to-read-data-from-the-compacted-ledgers-pr-13629"},"Readers continue to read data from the compacted ledgers. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/13629"},"PR-13629")),(0,n.kt)("h4",{id:"issue"},"Issue"),(0,n.kt)("p",null,"Previously, when topics were unloaded, some data was lost to be read by readers if they have consumed some messages from some compacted ledgers."),(0,n.kt)("h4",{id:"resolution"},"Resolution"),(0,n.kt)("p",null,"Rewound the reader cursor to the next message of the mark delete position if ",(0,n.kt)("inlineCode",{parentName:"p"},"readCompacted = true"),"."),(0,n.kt)("h3",{id:"brokers-decrease-the-number-of-unacked-messages-pr-13383"},"Brokers decrease the number of unacked messages. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/13383"},"PR-13383")),(0,n.kt)("h4",{id:"issue-1"},"Issue"),(0,n.kt)("p",null,"Previously, brokers did not decrease the number of unacked messages if batch ack was enabled. Consequently, consumers were blocked if they reached ",(0,n.kt)("inlineCode",{parentName:"p"},"maxUnackedMessagesPerConsumer")," limit."),(0,n.kt)("h4",{id:"resolution-1"},"Resolution"),(0,n.kt)("p",null,"Decreased the number of unacked messages when ",(0,n.kt)("inlineCode",{parentName:"p"},"individualAckNormal")," was called."),(0,n.kt)("h3",{id:"chunked-messages-can-be-queried-through-pulsar-sql-pr-12720"},"Chunked messages can be queried through Pulsar SQL. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/12720"},"PR-12720")),(0,n.kt)("h4",{id:"issue-2"},"Issue"),(0,n.kt)("p",null,"Previously, chunked messages could not be queried through Pulsar SQL."),(0,n.kt)("h4",{id:"resolution-2"},"Resolution"),(0,n.kt)("p",null,"Add a chunked message map in ",(0,n.kt)("inlineCode",{parentName:"p"},"PulsarRecordCursor")," to maintain incomplete chunked messages. If one chunked message was received completely, it would be offered in the message queue to wait for deserialization. "),(0,n.kt)("h3",{id:"support-enable-or-disable-schema-upload-at-the-broker-level-pr-12786"},"Support enable or disable schema upload at the broker level. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/12786"},"PR-12786")),(0,n.kt)("h4",{id:"issue-3"},"Issue"),(0,n.kt)("p",null,"Previously, Pulsar didn't support enabling or disabling schema upload at the broker level."),(0,n.kt)("h4",{id:"resolution-3"},"Resolution"),(0,n.kt)("p",null,"Added the configuration ",(0,n.kt)("inlineCode",{parentName:"p"},"isSchemaAutoUploadEnabled")," on the broker side."),(0,n.kt)("h3",{id:"readers-can-read-the-latest-messages-in-compacted-topics-pr-14449"},"Readers can read the latest messages in compacted topics. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/14449"},"PR-14449")),(0,n.kt)("h4",{id:"issue-4"},"Issue"),(0,n.kt)("p",null,"Previously, readers were not able to read the latest messages in compacted topics if readers enabled ",(0,n.kt)("inlineCode",{parentName:"p"},"readCompacted")," and all the data of topics has been compacted to compacted ledgers."),(0,n.kt)("h4",{id:"resolution-4"},"Resolution"),(0,n.kt)("p",null,"Added the ",(0,n.kt)("inlineCode",{parentName:"p"},"forceReset")," configuration for the managed cursor, so that the cursor could be reset to a given position and readers can read data from compacted ledgers. "),(0,n.kt)("h3",{id:"transaction-sequenceid-can-be-recovered-correctly-pr-13209"},"Transaction sequenceId can be recovered correctly. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/13209"},"PR-13209")),(0,n.kt)("h4",{id:"issue-5"},"Issue"),(0,n.kt)("p",null,"Previously, the wrong transaction sequenceId was recovered due to incorrect ",(0,n.kt)("inlineCode",{parentName:"p"},"managedLedger")," properties."),(0,n.kt)("h4",{id:"resolution-5"},"Resolution"),(0,n.kt)("p",null,"Used ",(0,n.kt)("inlineCode",{parentName:"p"},"ManagedLedgerInterceptor ")," to update current sequenceId to ",(0,n.kt)("inlineCode",{parentName:"p"},"managedLedger")," properties and more."),(0,n.kt)("h3",{id:"transactions-performance-test-tool-is-available-pr-11933"},"Transactions performance test tool is available. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/11933"},"PR-11933")),(0,n.kt)("h4",{id:"issue-6"},"Issue"),(0,n.kt)("p",null,"Previously, it was hard to test transaction performance (such as the delay and rate of sending and consuming messages) when opening a transaction."),(0,n.kt)("h4",{id:"resolution-6"},"Resolution"),(0,n.kt)("p",null,"Added ",(0,n.kt)("inlineCode",{parentName:"p"},"PerformanceTransaction")," class to support this enhancement."),(0,n.kt)("h3",{id:"port-exhaustion-and-connection-issues-no-longer-exist-in-pulsar-proxy-pr-14078"},"Port exhaustion and connection issues no longer exist in Pulsar Proxy. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/14078"},"PR-14078")),(0,n.kt)("h4",{id:"issue-7"},"Issue"),(0,n.kt)("p",null,"Previously, Pulsar proxy would get into a state where it stopped proxying broker connections while Admin API proxying kept working."),(0,n.kt)("h4",{id:"resolution-7"},"Resolution"),(0,n.kt)("p",null,"Optimized the proxy connection to fail-fast if the target broker was not active, added connect timeout handling to proxy connection, and more."),(0,n.kt)("h3",{id:"no-race-condition-in-opsendmsgqueue-when-publishing-messages-pr-14231"},"No race condition in ",(0,n.kt)("inlineCode",{parentName:"h3"},"OpSendMsgQueue")," when publishing messages. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/14231"},"PR-14231")),(0,n.kt)("h4",{id:"issue-8"},"Issue"),(0,n.kt)("p",null,"After the method ",(0,n.kt)("inlineCode",{parentName:"p"},"getPendingQueueSize()")," was called and the send receipt came back, the peek from the ",(0,n.kt)("inlineCode",{parentName:"p"},"pendingMessages")," might get NPE during the process."),(0,n.kt)("h4",{id:"resolution-8"},"Resolution"),(0,n.kt)("p",null,"Added a thread-safe message count object in ",(0,n.kt)("inlineCode",{parentName:"p"},"OpSendMsgQueue")," for each compute process."),(0,n.kt)("h3",{id:"change-contextclassloader-to-narclassloader-in-additionalservlet-pr-13501"},"Change ",(0,n.kt)("inlineCode",{parentName:"h3"},"ContextClassLoader")," to ",(0,n.kt)("inlineCode",{parentName:"h3"},"NarClassLoader")," in AdditionalServlet. ",(0,n.kt)("a",{parentName:"h3",href:"https://github.com/apache/pulsar/pull/13501"},"PR-13501")),(0,n.kt)("h4",{id:"issue-9"},"Issue"),(0,n.kt)("p",null,"Previously, if a class was dynamically loaded by ",(0,n.kt)("inlineCode",{parentName:"p"},"NarClassLoader"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"ClassNotFoundException")," occurred when it was used by the default class load."),(0,n.kt)("h4",{id:"resolution-9"},"Resolution"),(0,n.kt)("p",null,"Changed context class loader through ",(0,n.kt)("inlineCode",{parentName:"p"},"Thread.currentThread().setContextClassLoader(classLoader)")," before every plugin calling back and changed the context class loader back to original class loader afterwards."),(0,n.kt)("h1",{id:"whats-next"},"What\u2019s Next?"),(0,n.kt)("p",null,"If you are interested in learning more about Pulsar 2.9.2, you can ",(0,n.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/en/versions/"},"download")," and try it out now! "),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Pulsar Summit San Francisco 2022")," will take place on August 18th, 2022. ",(0,n.kt)("a",{parentName:"p",href:"https://pulsar-summit.org/"},"Register now")," and help us make it an even bigger success by spreading the word on social media!"),(0,n.kt)("p",null,"For more information about the Apache Pulsar project and current progress, visit\nthe ",(0,n.kt)("a",{parentName:"p",href:"https://pulsar.apache.org"},"Pulsar website"),", follow the project on Twitter ",(0,n.kt)("a",{parentName:"p",href:"https://twitter.com/apache_pulsar"},"@apache_pulsar"),", and join ",(0,n.kt)("a",{parentName:"p",href:"https://apache-pulsar.herokuapp.com/"},"Pulsar Slack"),"!"))}p.isMDXComponent=!0}}]);