"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[75719],{67175:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"CVE-2022-33682","title":"Disabled Hostname Verification makes Brokers, Proxies vulnerable to MITM attack (CVE-2022-33682)","description":"PRODUCT AFFECTED:","source":"@site/security/CVE-2022-33682.md","sourceDirName":".","slug":"/CVE-2022-33682","permalink":"/security/CVE-2022-33682","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var r=t(74848),i=t(28453);const s={},o="Disabled Hostname Verification makes Brokers, Proxies vulnerable to MITM attack (CVE-2022-33682)",l={},c=[{value:"PRODUCT AFFECTED:",id:"product-affected",level:2},{value:"PROBLEM:",id:"problem",level:2},{value:"WORKAROUND:",id:"workaround",level:2},{value:"RELATED LINKS:",id:"related-links",level:2},{value:"ACKNOWLEDGEMENTS:",id:"acknowledgements",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"disabled-hostname-verification-makes-brokers-proxies-vulnerable-to-mitm-attack-cve-2022-33682",children:"Disabled Hostname Verification makes Brokers, Proxies vulnerable to MITM attack (CVE-2022-33682)"})}),"\n",(0,r.jsx)(n.h2,{id:"product-affected",children:"PRODUCT AFFECTED:"}),"\n",(0,r.jsx)(n.p,{children:"This issue affects Apache Pulsar 2.10, 2.6 and earlier, 2.7, 2.8, 2.9."}),"\n",(0,r.jsx)(n.h2,{id:"problem",children:"PROBLEM:"}),"\n",(0,r.jsx)(n.p,{children:"Severity: high"}),"\n",(0,r.jsx)(n.p,{children:"TLS hostname verification cannot be enabled in the Pulsar Broker's Java Client, the Pulsar Broker's Java Admin Client, the Pulsar WebSocket Proxy's Java Client, and the Pulsar Proxy's Admin Client leaving intra-cluster connections and geo-replication connections vulnerable to man in the middle attacks, which could leak credentials, configuration data, message data, and any other data sent by these clients. The vulnerability is for both the pulsar+ssl protocol and HTTPS."}),"\n",(0,r.jsx)(n.p,{children:"An attacker can only take advantage of this vulnerability by taking control of a machine 'between' the client and the server. The attacker must then actively manipulate traffic to perform the attack by providing the client with a cryptographically valid certificate for an unrelated host."}),"\n",(0,r.jsx)(n.p,{children:"This issue affects Apache Pulsar Broker, Proxy, and WebSocket Proxy versions 2.7.0 to 2.7.4; 2.8.0 to 2.8.3; 2.9.0 to 2.9.2; 2.10.0; 2.6.4 and earlier."}),"\n",(0,r.jsxs)(n.p,{children:["This issue has been assigned ",(0,r.jsx)(n.a,{href:"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-33682",children:"CVE-2022-33682"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"workaround",children:"WORKAROUND:"}),"\n",(0,r.jsx)(n.p,{children:"Any users running affected versions of the Pulsar Broker, Pulsar Proxy, or Pulsar WebSocket Proxy should rotate static authentication data vulnerable to man in the middle attacks used by these applications, including tokens and passwords."}),"\n",(0,r.jsx)(n.p,{children:"To enable hostname verification, update the following configuration files."}),"\n",(0,r.jsx)(n.p,{children:"In the Broker configuration (broker.conf, by default) and in the WebSocket Proxy configuration (websocket.conf, by default), set:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"brokerClient_tlsHostnameVerificationEnable=true\n"})}),"\n",(0,r.jsx)(n.p,{children:'In Pulsar Helm chart deployments, the Broker and WebSocket Proxy setting name should be prefixed with "PULSAR_PREFIX_".'}),"\n",(0,r.jsx)(n.p,{children:"In the Proxy configuration (proxy.conf, by default), set:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"tlsHostnameVerificationEnabled=true\n"})}),"\n",(0,r.jsx)(n.p,{children:"2.7 users should upgrade Pulsar Brokers, Proxies, and WebSocket Proxies to 2.7.5, rotate vulnerable authentication data, including tokens and passwords, and apply the above configuration."}),"\n",(0,r.jsx)(n.p,{children:"2.8 users should upgrade Pulsar Brokers, Proxies, and WebSocket Proxies to 2.8.4, rotate vulnerable authentication data, including tokens and passwords, and apply the above configuration."}),"\n",(0,r.jsx)(n.p,{children:"2.9 users should upgrade Pulsar Brokers, Proxies, and WebSocket Proxies to 2.9.3, rotate vulnerable authentication data, including tokens and passwords, and apply the above configuration."}),"\n",(0,r.jsx)(n.p,{children:"2.10 users should upgrade Pulsar Brokers, Proxies, and WebSocket Proxies to 2.10.1, rotate vulnerable authentication data, including tokens and passwords, and apply the above configuration."}),"\n",(0,r.jsx)(n.p,{children:"Any users running Pulsar Brokers, Proxies, and WebSocket Proxies for 2.6.4 and earlier should upgrade to one of the above patched versions, rotate vulnerable authentication data, including tokens and passwords, and apply the above configuration."}),"\n",(0,r.jsx)(n.h2,{id:"related-links",children:"RELATED LINKS:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-33682",children:"CVE-2022-33682 at cve.mitre.org"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://lists.apache.org/thread/l0ynfl161qghwfcgbbl8ld9hzbl9t3yx",children:"https://lists.apache.org/thread/l0ynfl161qghwfcgbbl8ld9hzbl9t3yx"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"acknowledgements",children:"ACKNOWLEDGEMENTS:"}),"\n",(0,r.jsx)(n.p,{children:"This issue was discovered by Michael Marshall of DataStax."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"/security/",children:"Security Advisories"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>o});var a=t(96540);const r={},i=a.createContext(r);function s(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);