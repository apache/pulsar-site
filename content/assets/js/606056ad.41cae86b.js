"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[19141],{17430:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>u,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"getting-started-docker","title":"Run a standalone Pulsar cluster in Docker","description":"Get started with Apache Pulsar on your local machine using Docker.","source":"@site/versioned_docs/version-4.0.x/getting-started-docker.md","sourceDirName":".","slug":"/getting-started-docker","permalink":"/docs/4.0.x/getting-started-docker","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/pulsar-site/edit/main/versioned_docs/version-4.0.x/getting-started-docker.md","tags":[],"version":"4.0.x","frontMatter":{"id":"getting-started-docker","title":"Run a standalone Pulsar cluster in Docker","sidebar_label":"Run Pulsar in Docker","description":"Get started with Apache Pulsar on your local machine using Docker."},"sidebar":"docsSidebar","previous":{"title":"Run Pulsar locally","permalink":"/docs/4.0.x/getting-started-standalone"},"next":{"title":"Run Pulsar in Kubernetes","permalink":"/docs/4.0.x/getting-started-helm"}}');var t=s(74848),r=s(28453),l=s(95658),o=s(27654);const i={id:"getting-started-docker",title:"Run a standalone Pulsar cluster in Docker",sidebar_label:"Run Pulsar in Docker",description:"Get started with Apache Pulsar on your local machine using Docker."},c=void 0,u={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step1: Start Pulsar in Docker",id:"step1-start-pulsar-in-docker",level:2},{value:"Step 2: Use Pulsar in Docker",id:"step-2-use-pulsar-in-docker",level:2},{value:"Consume a message",id:"consume-a-message",level:3},{value:"Produce a message",id:"produce-a-message",level:3},{value:"Step 3: Get the topic statistics",id:"step-3-get-the-topic-statistics",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"For local development and testing, you can run Pulsar in standalone mode on your own machine within a Docker container."}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://docs.docker.com/get-docker/",children:"Docker"})," (version 20.10+ recommended)"]}),"\n",(0,t.jsx)(n.li,{children:"At least 4GB of available RAM"}),"\n",(0,t.jsx)(n.li,{children:"At least 5GB of free disk space"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"To run Pulsar in Docker, follow the steps below."}),"\n",(0,t.jsx)(n.h2,{id:"step1-start-pulsar-in-docker",children:"Step1: Start Pulsar in Docker"}),"\n",(0,t.jsx)(n.p,{children:"For macOS, Linux, and Windows, run the following command to start Pulsar within a Docker container."}),"\n",(0,t.jsxs)(l.A,{groupId:"os-choice",defaultValue:"macOS & Linux",values:[{label:"macOS & Linux",value:"macOS & Linux"},{label:"Windows",value:"Windows"}],children:[(0,t.jsx)(o.A,{value:"macOS & Linux",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"docker run -it \\\n-p 6650:6650 \\\n-p 8080:8080 \\\n--mount source=pulsardata,target=/pulsar/data \\\n--mount source=pulsarconf,target=/pulsar/conf \\\napachepulsar/pulsar:4.0.8 \\\nbin/pulsar standalone\n"})})}),(0,t.jsx)(o.A,{value:"Windows",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"docker run -it ^\n-p 6650:6650 ^\n-p 8080:8080 ^\n--mount source=pulsardata,target=/pulsar/data ^\n--mount source=pulsarconf,target=/pulsar/conf ^\napachepulsar/pulsar:4.0.8 ^\nbin/pulsar standalone\n"})})})]}),"\n",(0,t.jsxs)(n.admonition,{type:"tip",children:[(0,t.jsx)(n.p,{children:"By default, Pulsar uses RocksDB as the metadata store, which is recommended for standalone instances."}),(0,t.jsx)(n.p,{children:"If you encounter issues with RocksDB or need compatibility with existing ZooKeeper-based installations, you can use ZooKeeper as the metadata store by adding:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"...\n-e PULSAR_STANDALONE_USE_ZOOKEEPER=1 \\\n...\n"})}),(0,t.jsx)(n.p,{children:"Note: Switching metadata stores will create a new cluster. Don't apply this to existing instances unless you want to start fresh."})]}),"\n",(0,t.jsxs)(n.p,{children:["If you want to change Pulsar configurations and start Pulsar, run the following command by passing environment variables with the ",(0,t.jsx)(n.code,{children:"PULSAR_PREFIX_"})," prefix. See ",(0,t.jsx)(n.a,{href:"https://github.com/apache/pulsar/blob/e6b12c64b043903eb5ff2dc5186fe8030f157cfc/conf/standalone.conf",children:"default configuration file"})," for more details."]}),"\n",(0,t.jsxs)(l.A,{groupId:"os-choice",defaultValue:"macOS & Linux",values:[{label:"macOS & Linux",value:"macOS & Linux"},{label:"Windows",value:"Windows"}],children:[(0,t.jsx)(o.A,{value:"macOS & Linux",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'docker run -it \\\n-e PULSAR_PREFIX_xxx=yyy \\\n-p 6650:6650  \\\n-p 8080:8080 \\\n--mount source=pulsardata,target=/pulsar/data \\\n--mount source=pulsarconf,target=/pulsar/conf \\\napachepulsar/pulsar:4.0.8 sh \\\n-c "bin/apply-config-from-env.py \\\nconf/standalone.conf && \\\nbin/pulsar standalone"\n'})})}),(0,t.jsx)(o.A,{value:"Windows",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'docker run -it ^\n-e PULSAR_PREFIX_xxx=yyy ^\n-p 6650:6650  ^\n-p 8080:8080 ^\n--mount source=pulsardata,target=/pulsar/data ^\n--mount source=pulsarconf,target=/pulsar/conf ^\napachepulsar/pulsar:4.0.8 sh ^\n-c "bin/apply-config-from-env.py ^\nconf/standalone.conf && ^\nbin/pulsar standalone"\n'})})})]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The docker container runs as UID 10000 and GID 0 by default. You need to ensure the mounted volumes give write permission to either UID 10000 or GID 0. Note that UID 10000 is arbitrary, so it is recommended to make these mounts writable for the root group (GID 0)."}),"\n",(0,t.jsxs)(n.li,{children:['The data, metadata, and configuration are persisted on Docker volumes to not start "fresh" every time the container is restarted. For details on the volumes, you can use ',(0,t.jsx)(n.code,{children:"docker volume inspect <sourcename>"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"For Docker on Windows, make sure to configure it to use Linux containers."}),"\n"]})}),"\n",(0,t.jsxs)(n.p,{children:["After starting Pulsar successfully, you can see ",(0,t.jsx)(n.code,{children:"INFO"}),"-level log messages like this:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"08:18:30.970 [main] INFO  org.apache.pulsar.broker.web.WebService - HTTP Service started at http://0.0.0.0:8080\n...\n07:53:37.322 [main] INFO  org.apache.pulsar.broker.PulsarService - messaging service is ready, bootstrap service port = 8080, broker url= pulsar://localhost:6650, cluster=standalone, configs=org.apache.pulsar.broker.ServiceConfiguration@98b63c1\n...\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["To perform a health check, you can use the ",(0,t.jsx)(n.code,{children:"bin/pulsar-admin brokers healthcheck"})," command. For more information, see ",(0,t.jsx)(n.a,{href:"pathname:///reference/#/4.0.x/pulsar-admin/",children:"Pulsar admin docs"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["When you start a local standalone cluster, a ",(0,t.jsx)(n.code,{children:"public/default"})," namespace is created automatically. The namespace is used for development purposes. All Pulsar topics are managed within namespaces. For more information, see ",(0,t.jsx)(n.a,{href:"/docs/4.0.x/concepts-messaging#topics",children:"Topics"}),"."]}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"step-2-use-pulsar-in-docker",children:"Step 2: Use Pulsar in Docker"}),"\n",(0,t.jsxs)(n.p,{children:["Pulsar offers a variety of ",(0,t.jsx)(n.a,{href:"/docs/4.0.x/client-libraries",children:"client libraries"}),", such as ",(0,t.jsx)(n.a,{href:"/docs/4.0.x/client-libraries-java",children:"Java"}),", ",(0,t.jsx)(n.a,{href:"/docs/4.0.x/client-libraries-go",children:"Go"}),", ",(0,t.jsx)(n.a,{href:"/docs/4.0.x/client-libraries-python",children:"Python"}),", ",(0,t.jsx)(n.a,{href:"/docs/4.0.x/client-libraries-cpp",children:"C++"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"If you're running a local standalone cluster, you can use one of these root URLs to interact with your cluster:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"pulsar://localhost:6650"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"http://localhost:8080"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The following example guides you to get started with Pulsar by using the ",(0,t.jsx)(n.a,{href:"https://pulsar.apache.org/api/python/3.8.x",children:"Python client API"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Install the Pulsar Python client library directly from ",(0,t.jsx)(n.a,{href:"https://pypi.org/project/pulsar-client/",children:"PyPI"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"pip install pulsar-client\n"})}),"\n",(0,t.jsx)(n.h3,{id:"consume-a-message",children:"Consume a message"}),"\n",(0,t.jsx)(n.p,{children:"Create a consumer and subscribe to the topic:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import pulsar\n\nclient = pulsar.Client('pulsar://localhost:6650')\nconsumer = client.subscribe('my-topic', subscription_name='my-sub')\n\nwhile True:\n    msg = consumer.receive()\n    print(\"Received message: '%s'\" % msg.data())\n    consumer.acknowledge(msg)\n\nclient.close()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"produce-a-message",children:"Produce a message"}),"\n",(0,t.jsx)(n.p,{children:"Start a producer to send some test messages:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import pulsar\n\nclient = pulsar.Client('pulsar://localhost:6650')\nproducer = client.create_producer('my-topic')\n\nfor i in range(10):\n    producer.send(('hello-pulsar-%d' % i).encode('utf-8'))\n\nclient.close()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-3-get-the-topic-statistics",children:"Step 3: Get the topic statistics"}),"\n",(0,t.jsxs)(n.p,{children:["In Pulsar, you can use REST API, Java, or command-line tools to control every aspect of the system. For details on APIs, refer to ",(0,t.jsx)(n.a,{href:"/docs/4.0.x/admin-api-overview",children:"Admin API Overview"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"In the simplest example, you can use curl to probe the stats for a particular topic:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl http://localhost:8080/admin/v2/persistent/public/default/my-topic/stats | python -m json.tool\n"})}),"\n",(0,t.jsx)(n.p,{children:"The output is something like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "msgRateIn": 0.0,\n    "msgThroughputIn": 0.0,\n    "msgRateOut": 1.8332950480217471,\n    "msgThroughputOut": 91.33142602871978,\n    "bytesInCounter": 7097,\n    "msgInCounter": 143,\n    "bytesOutCounter": 6607,\n    "msgOutCounter": 133,\n    "averageMsgSize": 0.0,\n    "msgChunkPublished": false,\n    "storageSize": 7097,\n    "backlogSize": 0,\n    "offloadedStorageSize": 0,\n    "publishers": [\n        {\n            "accessMode": "Shared",\n            "msgRateIn": 0.0,\n            "msgThroughputIn": 0.0,\n            "averageMsgSize": 0.0,\n            "chunkedMessageRate": 0.0,\n            "producerId": 0,\n            "metadata": {},\n            "address": "/127.0.0.1:35604",\n            "connectedSince": "2021-07-04T09:05:43.04788Z",\n            "clientVersion": "2.8.0",\n            "producerName": "standalone-2-5"\n        }\n    ],\n    "waitingPublishers": 0,\n    "subscriptions": {\n        "my-sub": {\n            "msgRateOut": 1.8332950480217471,\n            "msgThroughputOut": 91.33142602871978,\n            "bytesOutCounter": 6607,\n            "msgOutCounter": 133,\n            "msgRateRedeliver": 0.0,\n            "chunkedMessageRate": 0,\n            "msgBacklog": 0,\n            "backlogSize": 0,\n            "msgBacklogNoDelayed": 0,\n            "blockedSubscriptionOnUnackedMsgs": false,\n            "msgDelayed": 0,\n            "unackedMessages": 0,\n            "type": "Exclusive",\n            "activeConsumerName": "3c544f1daa",\n            "msgRateExpired": 0.0,\n            "totalMsgExpired": 0,\n            "lastExpireTimestamp": 0,\n            "lastConsumedFlowTimestamp": 1625389101290,\n            "lastConsumedTimestamp": 1625389546070,\n            "lastAckedTimestamp": 1625389546162,\n            "lastMarkDeleteAdvancedTimestamp": 1625389546163,\n            "consumers": [\n                {\n                    "msgRateOut": 1.8332950480217471,\n                    "msgThroughputOut": 91.33142602871978,\n                    "bytesOutCounter": 6607,\n                    "msgOutCounter": 133,\n                    "msgRateRedeliver": 0.0,\n                    "chunkedMessageRate": 0.0,\n                    "consumerName": "3c544f1daa",\n                    "availablePermits": 867,\n                    "unackedMessages": 0,\n                    "avgMessagesPerEntry": 6,\n                    "blockedConsumerOnUnackedMsgs": false,\n                    "lastAckedTimestamp": 1625389546162,\n                    "lastConsumedTimestamp": 1625389546070,\n                    "metadata": {},\n                    "address": "/127.0.0.1:35472",\n                    "connectedSince": "2021-07-04T08:58:21.287682Z",\n                    "clientVersion": "2.8.0"\n                }\n            ],\n            "isDurable": true,\n            "isReplicated": false,\n            "allowOutOfOrderDelivery": false,\n            "consumersAfterMarkDeletePosition": {},\n            "nonContiguousDeletedMessagesRanges": 0,\n            "nonContiguousDeletedMessagesRangesSerializedSize": 0,\n            "durable": true,\n            "replicated": false\n        }\n    },\n    "replication": {},\n    "deduplicationStatus": "Disabled",\n    "nonContiguousDeletedMessagesRanges": 0,\n    "nonContiguousDeletedMessagesRangesSerializedSize": 0\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},27654:(e,n,s)=>{s.d(n,{A:()=>l});s(96540);var a=s(34164);const t={tabItem:"tabItem_Ymn6"};var r=s(74848);function l({children:e,hidden:n,className:s}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,a.A)(t.tabItem,s),hidden:n,children:e})}},95658:(e,n,s)=>{s.d(n,{A:()=>k});var a=s(96540),t=s(34164),r=s(23104),l=s(56347),o=s(205),i=s(57485),c=s(31682),u=s(70679);function d(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:s}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return d(e).map((({props:{value:e,label:n,attributes:s,default:a}})=>({value:e,label:n,attributes:s,default:a})))}(s);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,s])}function h({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const s=(0,l.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,i.aZ)(t),(0,a.useCallback)((e=>{if(!t)return;const n=new URLSearchParams(s.location.search);n.set(t,e),s.replace({...s.location,search:n.toString()})}),[t,s])]}function g(e){const{defaultValue:n,queryString:s=!1,groupId:t}=e,r=p(e),[l,i]=(0,a.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find((e=>e.default))??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:r}))),[c,d]=m({queryString:s,groupId:t}),[g,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,t]=(0,u.Dv)(n);return[s,(0,a.useCallback)((e=>{n&&t.set(e)}),[n,t])]}({groupId:t}),x=(()=>{const e=c??g;return h({value:e,tabValues:r})?e:null})();(0,o.A)((()=>{x&&i(x)}),[x]);return{selectedValue:l,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);i(e),d(e),f(e)}),[d,f,r]),tabValues:r}}var f=s(92303);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=s(74848);function v({className:e,block:n,selectedValue:s,selectValue:a,tabValues:l}){const o=[],{blockElementScrollPositionUntilNextRender:i}=(0,r.a_)(),c=e=>{const n=e.currentTarget,t=o.indexOf(n),r=l[t].value;r!==s&&(i(n),a(r))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const s=o.indexOf(e.currentTarget)+1;n=o[s]??o[0];break}case"ArrowLeft":{const s=o.indexOf(e.currentTarget)-1;n=o[s]??o[o.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:l.map((({value:e,label:n,attributes:a})=>(0,b.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{o.push(e)},onKeyDown:u,onClick:c,...a,className:(0,t.A)("tabs__item",x.tabItem,a?.className,{"tabs__item--active":s===e}),children:n??e},e)))})}function j({lazy:e,children:n,selectedValue:s}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find((e=>e.props.value===s));return e?(0,a.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function y(e){const n=g(e);return(0,b.jsxs)("div",{className:(0,t.A)("tabs-container",x.tabList),children:[(0,b.jsx)(v,{...n,...e}),(0,b.jsx)(j,{...n,...e})]})}function k(e){const n=(0,f.A)();return(0,b.jsx)(y,{...e,children:d(e.children)},String(n))}},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var a=s(96540);const t={},r=a.createContext(t);function l(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);