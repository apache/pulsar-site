"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[66791],{37066:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"CVE-2021-41571","title":"CVE-2021-41571: Apache Pulsar: Pulsar Admin API allows access to data from other tenants using getMessageById API","description":"Severity: moderate","source":"@site/security/CVE-2021-41571.md","sourceDirName":".","slug":"/CVE-2021-41571","permalink":"/security/CVE-2021-41571","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var a=s(74848),r=s(28453);const i={},o="CVE-2021-41571: Apache Pulsar: Pulsar Admin API allows access to data from other tenants using getMessageById API",c={},d=[{value:"Description:",id:"description",level:2},{value:"Mitigation:",id:"mitigation",level:2},{value:"RELATED LINKS:",id:"related-links",level:2}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"cve-2021-41571-apache-pulsar-pulsar-admin-api-allows-access-to-data-from-other-tenants-using-getmessagebyid-api",children:"CVE-2021-41571: Apache Pulsar: Pulsar Admin API allows access to data from other tenants using getMessageById API"})}),"\n",(0,a.jsx)(t.p,{children:"Severity: moderate"}),"\n",(0,a.jsx)(t.h2,{id:"description",children:"Description:"}),"\n",(0,a.jsx)(t.p,{children:"In Apache Pulsar it is possible to access data from BookKeeper that\ndoes not belong to the topics accessible by the authenticated user."}),"\n",(0,a.jsx)(t.p,{children:"The Admin API get-message-by-id requires the user to input a topic and\na ledger id. The ledger id is a pointer to the data, and it is\nsupposed to be a valid id for the topic.\nAuthorisation controls are performed against the topic name and there\nis no proper validation that the ledger id is valid in the context of\nsuch ledger.\nSo it may happen that the user is able to read from a ledger that\ncontains data owned by another tenant."}),"\n",(0,a.jsx)(t.p,{children:"This issue affects Apache Pulsar version 2.8.0 and prior\nversions; Apache Pulsar version 2.7.3 and prior versions; Apache\nPulsar version 2.6.4 and prior versions."}),"\n",(0,a.jsxs)(t.p,{children:["This issue is being tracked as ",(0,a.jsx)(t.a,{href:"https://github.com/apache/pulsar/issues/11814",children:"https://github.com/apache/pulsar/issues/11814"})]}),"\n",(0,a.jsx)(t.h2,{id:"mitigation",children:"Mitigation:"}),"\n",(0,a.jsx)(t.p,{children:"If you are running Pulsar behind a proxy you can disable access to the\nREST API for the flawed API"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"/admin/v2/non-persistent/{tenant}/{namespace}/{topic}/ledger/{ledgerId}/entry/{entryId}\n"})}),"\n",(0,a.jsx)(t.h2,{id:"related-links",children:"RELATED LINKS:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41571",children:"CVE-2021-41571 at cve.mitre.org"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"https://pulsar.apache.org/admin-rest-api/#operation/getLastMessageId",children:"https://pulsar.apache.org/admin-rest-api/#operation/getLastMessageId"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"https://github.com/apache/pulsar/issues/11814",children:"https://github.com/apache/pulsar/issues/11814"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"https://lists.apache.org/thread/8n3k7pvyh4cf9q2jfzb6pb32ync6xlvr",children:"https://lists.apache.org/thread/8n3k7pvyh4cf9q2jfzb6pb32ync6xlvr"})}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.a,{href:"/security/",children:"Security Advisories"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>i,x:()=>o});var n=s(96540);const a={},r=n.createContext(a);function i(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);