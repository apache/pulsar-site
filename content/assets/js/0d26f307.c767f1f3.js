"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[93309],{94030:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"admin-api-partitioned-topics","title":"Managing partitioned topics","description":"You can use Pulsar\'s admin API to create and manage partitioned topics.","source":"@site/versioned_docs/version-2.4.2/admin-api-partitioned-topics.md","sourceDirName":".","slug":"/admin-api-partitioned-topics","permalink":"/docs/2.4.2/admin-api-partitioned-topics","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/pulsar-site/edit/main/versioned_docs/version-2.4.2/admin-api-partitioned-topics.md","tags":[],"version":"2.4.2","frontMatter":{"id":"admin-api-partitioned-topics","title":"Managing partitioned topics","sidebar_label":"Partitioned topics","original_id":"admin-api-partitioned-topics"},"sidebar":"docsSidebar","previous":{"title":"Non-Persistent topics","permalink":"/docs/2.4.2/admin-api-non-persistent-topics"},"next":{"title":"Schemas","permalink":"/docs/2.4.2/admin-api-schemas"}}');var s=t(74848),a=t(28453);const r={id:"admin-api-partitioned-topics",title:"Managing partitioned topics",sidebar_label:"Partitioned topics",original_id:"admin-api-partitioned-topics"},d=void 0,c={},l=[{value:"Partitioned topics resources",id:"partitioned-topics-resources",level:2},{value:"Create",id:"create",level:3},{value:"pulsar-admin",id:"pulsar-admin",level:4},{value:"REST API",id:"rest-api",level:4},{value:"Java",id:"java",level:4},{value:"Nonpartitioned topics resources",id:"nonpartitioned-topics-resources",level:2},{value:"Create",id:"create-1",level:3},{value:"pulsar-admin",id:"pulsar-admin-1",level:4},{value:"REST API",id:"rest-api-1",level:4},{value:"Java",id:"java-1",level:4},{value:"Get metadata",id:"get-metadata",level:3},{value:"pulsar-admin",id:"pulsar-admin-2",level:4},{value:"REST API",id:"rest-api-2",level:4},{value:"Java",id:"java-2",level:4},{value:"Update",id:"update",level:3},{value:"pulsar-admin",id:"pulsar-admin-3",level:4},{value:"REST API",id:"rest-api-3",level:4},{value:"Java",id:"java-3",level:4},{value:"Delete",id:"delete",level:3},{value:"pulsar-admin",id:"pulsar-admin-4",level:4},{value:"REST API",id:"rest-api-4",level:4},{value:"Java",id:"java-4",level:4},{value:"List",id:"list",level:3},{value:"pulsar-admin",id:"pulsar-admin-5",level:4},{value:"REST API",id:"rest-api-5",level:4},{value:"Java",id:"java-5",level:4},{value:"Stats",id:"stats",level:3},{value:"pulsar-admin",id:"pulsar-admin-6",level:4},{value:"REST API",id:"rest-api-6",level:4},{value:"Java",id:"java-6",level:4},{value:"Internal stats",id:"internal-stats",level:3},{value:"pulsar-admin",id:"pulsar-admin-7",level:4},{value:"REST API",id:"rest-api-7",level:4},{value:"Java",id:"java-7",level:4}];function o(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["You can use Pulsar's ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/admin-api-overview",children:"admin API"})," to create and manage partitioned topics."]}),"\n",(0,s.jsx)(n.p,{children:"In all of the instructions and commands below, the topic name structure is:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\npersistent://tenant/namespace/topic\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"partitioned-topics-resources",children:"Partitioned topics resources"}),"\n",(0,s.jsx)(n.h3,{id:"create",children:"Create"}),"\n",(0,s.jsx)(n.p,{children:"Partitioned topics in Pulsar must be explicitly created. When creating a new partitioned topic you\nneed to provide a name for the topic as well as the desired number of partitions."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["By default, after 60 seconds of creation, topics are considered inactive and deleted automatically to prevent from generating trash data.\nTo disable this feature, set ",(0,s.jsx)(n.code,{children:"brokerDeleteInactiveTopicsEnabled"}),"  to ",(0,s.jsx)(n.code,{children:"false"}),".\nTo change the frequency of checking inactive topics, set ",(0,s.jsx)(n.code,{children:"brokerDeleteInactiveTopicsFrequencySeconds"})," to your desired value.\nFor more information about these two parameters, see ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/reference-configuration#broker",children:"here"}),"."]})}),"\n",(0,s.jsx)(n.h4,{id:"pulsar-admin",children:"pulsar-admin"}),"\n",(0,s.jsxs)(n.p,{children:["You can create partitioned topics using the ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/reference-pulsar-admin#create-partitioned-topic",children:(0,s.jsx)(n.code,{children:"create-partitioned-topic"})}),"\ncommand and specifying the topic name as an argument and the number of partitions using the ",(0,s.jsx)(n.code,{children:"-p"})," or ",(0,s.jsx)(n.code,{children:"--partitions"})," flag.\nHere's an example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\n$ bin/pulsar-admin topics create-partitioned-topic \\\n  persistent://my-tenant/my-namespace/my-topic \\\n  --partitions 4\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"rest-api",children:"REST API"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"https://pulsar.apache.org/admin-rest-api?version=2.4.2&apiversion=v2#operation/createPartitionedTopic",children:["PUT /admin/v2/",":schema","/",":tenant","/",":namespace","/",":topic","/partitions/createPartitionedTopic"]})}),"\n",(0,s.jsx)(n.h4,{id:"java",children:"Java"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'\nString topicName = "persistent://my-tenant/my-namespace/my-topic";\nint numPartitions = 4;\nadmin.persistentTopics().createPartitionedTopic(topicName, numPartitions);\n\n'})}),"\n",(0,s.jsx)(n.h2,{id:"nonpartitioned-topics-resources",children:"Nonpartitioned topics resources"}),"\n",(0,s.jsx)(n.h3,{id:"create-1",children:"Create"}),"\n",(0,s.jsx)(n.p,{children:"Nonpartitioned topics in Pulsar must be explicitly created if allowAutoTopicCreation or createIfMissing is disabled.\nWhen creating a non-partitioned topic, you need to provide a topic name."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["By default, after 60 seconds of creation, topics are considered inactive and deleted automatically to prevent from generating trash data.\nTo disable this feature, set ",(0,s.jsx)(n.code,{children:"brokerDeleteInactiveTopicsEnabled"})," to ",(0,s.jsx)(n.code,{children:"false"}),".\nTo change the frequency of checking inactive topics, set ",(0,s.jsx)(n.code,{children:"brokerDeleteInactiveTopicsFrequencySeconds"})," to your desired value.\nFor more information about these two parameters, see ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/reference-configuration#broker",children:"here"}),"."]})}),"\n",(0,s.jsx)(n.h4,{id:"pulsar-admin-1",children:"pulsar-admin"}),"\n",(0,s.jsxs)(n.p,{children:["You can create non-partitioned topics using the ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/reference-pulsar-admin#create",children:(0,s.jsx)(n.code,{children:"create"})}),"\ncommand and specifying the topic name as an argument. This is an example command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\n$ bin/pulsar-admin topics create persistent://my-tenant/my-namespace/my-topic\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"rest-api-1",children:"REST API"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"https://pulsar.apache.org/admin-rest-api?version=2.4.2&apiversion=:schema#operation/createNonPartitionedTopic",children:["PUT admin/v2/",":schema","/",":tenant","/",":namespace","/",":topic","/createNonPartitionedTopic"]})}),"\n",(0,s.jsx)(n.h4,{id:"java-1",children:"Java"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'\nString topicName = "persistent://my-tenant/my-namespace/my-topic";\nadmin.topics().createNonPartitionedTopic(topicName);\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"get-metadata",children:"Get metadata"}),"\n",(0,s.jsx)(n.p,{children:"Partitioned topics have metadata associated with them that you can fetch as a JSON object.\nThe following metadata fields are currently available:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Field"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Meaning"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"partitions"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"The number of partitions into which the topic is divided"})]})})]}),"\n",(0,s.jsx)(n.h4,{id:"pulsar-admin-2",children:"pulsar-admin"}),"\n",(0,s.jsxs)(n.p,{children:["You can see the number of partitions in a partitioned topic using the ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/reference-pulsar-admin#get-partitioned-topic-metadata",children:(0,s.jsx)(n.code,{children:"get-partitioned-topic-metadata"})}),"\nsubcommand. Here's an example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'\n$ pulsar-admin topics get-partitioned-topic-metadata \\\n  persistent://my-tenant/my-namespace/my-topic\n{\n  "partitions": 4\n}\n\n'})}),"\n",(0,s.jsx)(n.h4,{id:"rest-api-2",children:"REST API"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"https://pulsar.apache.org/admin-rest-api?version=2.4.2&apiversion=v2#operation/getPartitionedMetadata",children:["GET /admin/v2/",":schema","/",":tenant","/",":namespace","/",":topic","/partitions/getPartitionedMetadata"]})}),"\n",(0,s.jsx)(n.h4,{id:"java-2",children:"Java"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'\nString topicName = "persistent://my-tenant/my-namespace/my-topic";\nadmin.persistentTopics().getPartitionedTopicMetadata(topicName);\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"update",children:"Update"}),"\n",(0,s.jsxs)(n.p,{children:["You can update the number of partitions on an existing partitioned topic\n",(0,s.jsx)(n.em,{children:"if"})," the topic is non-global. To update, the new number of partitions must be greater\nthan the existing number."]}),"\n",(0,s.jsx)(n.p,{children:"Decrementing the number of partitions would deleting the topic, which is not supported in Pulsar."}),"\n",(0,s.jsx)(n.p,{children:"Already created partitioned producers and consumers will automatically find the newly created partitions."}),"\n",(0,s.jsx)(n.h4,{id:"pulsar-admin-3",children:"pulsar-admin"}),"\n",(0,s.jsxs)(n.p,{children:["Partitioned topics can be updated using the ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/reference-pulsar-admin#update-partitioned-topic",children:(0,s.jsx)(n.code,{children:"update-partitioned-topic"})})," command."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\n$ pulsar-admin topics update-partitioned-topic \\\n  persistent://my-tenant/my-namespace/my-topic \\\n  --partitions 8\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"rest-api-3",children:"REST API"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"https://pulsar.apache.org/admin-rest-api?version=2.4.2&apiversion=v2#operation/updatePartitionedTopic",children:["POST /admin/v2/",":schema","/",":tenant","/",":cluster","/",":namespace","/",":destination","/partitions/updatePartitionedTopic"]})}),"\n",(0,s.jsx)(n.h4,{id:"java-3",children:"Java"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"\nadmin.persistentTopics().updatePartitionedTopic(persistentTopic, numPartitions);\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"delete",children:"Delete"}),"\n",(0,s.jsx)(n.h4,{id:"pulsar-admin-4",children:"pulsar-admin"}),"\n",(0,s.jsxs)(n.p,{children:["Partitioned topics can be deleted using the ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/reference-pulsar-admin#delete-partitioned-topic",children:(0,s.jsx)(n.code,{children:"delete-partitioned-topic"})})," command, specifying the topic by name:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\n$ bin/pulsar-admin topics delete-partitioned-topic \\\n  persistent://my-tenant/my-namespace/my-topic\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"rest-api-4",children:"REST API"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"https://pulsar.apache.org/admin-rest-api?version=2.4.2&apiversion=v2#operation/deletePartitionedTopic",children:["DELETE /admin/v2/",":schema","/",":topic","/",":namespace","/",":destination","/partitions/deletePartitionedTopic"]})}),"\n",(0,s.jsx)(n.h4,{id:"java-4",children:"Java"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"\nadmin.persistentTopics().delete(persistentTopic);\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"list",children:"List"}),"\n",(0,s.jsx)(n.p,{children:"It provides a list of persistent topics existing under a given namespace."}),"\n",(0,s.jsx)(n.h4,{id:"pulsar-admin-5",children:"pulsar-admin"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\n$ pulsar-admin topics list tenant/namespace\npersistent://tenant/namespace/topic1\npersistent://tenant/namespace/topic2\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"rest-api-5",children:"REST API"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"https://pulsar.apache.org/admin-rest-api?version=2.4.2&apiversion=v2#operation/getPartitionedTopicList",children:["GET /admin/v2/",":schema","/",":tenant","/",":namespace","/getPartitionedTopicList"]})}),"\n",(0,s.jsx)(n.h4,{id:"java-5",children:"Java"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"\nadmin.persistentTopics().getList(namespace);\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"stats",children:"Stats"}),"\n",(0,s.jsx)(n.p,{children:"It shows current statistics of a given partitioned topic. Here's an example payload:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'\n{\n  "msgRateIn": 4641.528542257553,\n  "msgThroughputIn": 44663039.74947473,\n  "msgRateOut": 0,\n  "msgThroughputOut": 0,\n  "averageMsgSize": 1232439.816728665,\n  "storageSize": 135532389160,\n  "publishers": [\n    {\n      "msgRateIn": 57.855383881403576,\n      "msgThroughputIn": 558994.7078932219,\n      "averageMsgSize": 613135,\n      "producerId": 0,\n      "producerName": null,\n      "address": null,\n      "connectedSince": null\n    }\n  ],\n  "subscriptions": {\n    "my-topic_subscription": {\n      "msgRateOut": 0,\n      "msgThroughputOut": 0,\n      "msgBacklog": 116632,\n      "type": null,\n      "msgRateExpired": 36.98245516804671,\n      "consumers": []\n    }\n  },\n  "replication": {}\n}\n\n'})}),"\n",(0,s.jsx)(n.p,{children:"The following stats are available:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Stat"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"msgRateIn"}),(0,s.jsx)(n.td,{children:"The sum of all local and replication publishers\u2019 publish rates in messages per second"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"msgThroughputIn"}),(0,s.jsx)(n.td,{children:"Same as msgRateIn but in bytes per second instead of messages per second"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"msgRateOut"}),(0,s.jsx)(n.td,{children:"The sum of all local and replication consumers\u2019 dispatch rates in messages per second"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"msgThroughputOut"}),(0,s.jsx)(n.td,{children:"Same as msgRateOut but in bytes per second instead of messages per second"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"averageMsgSize"}),(0,s.jsx)(n.td,{children:"Average message size, in bytes, from this publisher within the last interval"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"storageSize"}),(0,s.jsx)(n.td,{children:"The sum of the ledgers\u2019 storage size for this topic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"publishers"}),(0,s.jsx)(n.td,{children:"The list of all local publishers into the topic. There can be anywhere from zero to thousands."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"producerId"}),(0,s.jsx)(n.td,{children:"Internal identifier for this producer on this topic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"producerName"}),(0,s.jsx)(n.td,{children:"Internal identifier for this producer, generated by the client library"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"address"}),(0,s.jsx)(n.td,{children:"IP address and source port for the connection of this producer"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"connectedSince"}),(0,s.jsx)(n.td,{children:"Timestamp this producer was created or last reconnected"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"subscriptions"}),(0,s.jsx)(n.td,{children:"The list of all local subscriptions to the topic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"my-subscription"}),(0,s.jsx)(n.td,{children:"The name of this subscription (client defined)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"msgBacklog"}),(0,s.jsx)(n.td,{children:"The count of messages in backlog for this subscription"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"type"}),(0,s.jsx)(n.td,{children:"This subscription type"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"msgRateExpired"}),(0,s.jsx)(n.td,{children:"The rate at which messages were discarded instead of dispatched from this subscription due to TTL"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"consumers"}),(0,s.jsx)(n.td,{children:"The list of connected consumers for this subscription"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"consumerName"}),(0,s.jsx)(n.td,{children:"Internal identifier for this consumer, generated by the client library"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"availablePermits"}),(0,s.jsx)(n.td,{children:"The number of messages this consumer has space for in the client library\u2019s listen queue. A value of 0 means the client library\u2019s queue is full and receive() isn\u2019t being called. A nonzero value means this consumer is ready to be dispatched messages."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"replication"}),(0,s.jsx)(n.td,{children:"This section gives the stats for cross-colo replication of this topic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"replicationBacklog"}),(0,s.jsx)(n.td,{children:"The outbound replication backlog in messages"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"connected"}),(0,s.jsx)(n.td,{children:"Whether the outbound replicator is connected"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"replicationDelayInSeconds"}),(0,s.jsx)(n.td,{children:"How long the oldest message has been waiting to be sent through the connection, if connected is true"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"inboundConnection"}),(0,s.jsx)(n.td,{children:"The IP and port of the broker in the remote cluster\u2019s publisher connection to this broker"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"inboundConnectedSince"}),(0,s.jsx)(n.td,{children:"The TCP connection being used to publish messages to the remote cluster. If there are no local publishers connected, this connection is automatically closed after a minute."})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"pulsar-admin-6",children:"pulsar-admin"}),"\n",(0,s.jsxs)(n.p,{children:["The stats for the partitioned topic and its connected producers and consumers can be fetched by using the ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/reference-pulsar-admin#partitioned-stats",children:(0,s.jsx)(n.code,{children:"partitioned-stats"})})," command, specifying the topic by name:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\n$ pulsar-admin topics partitioned-stats \\\n  persistent://test-tenant/namespace/topic \\\n  --per-partition\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"rest-api-6",children:"REST API"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"https://pulsar.apache.org/admin-rest-api?version=2.4.2&apiversion=v2#operation/getPartitionedStats",children:["GET /admin/v2/",":schema","/",":tenant","/",":namespace","/",":topic","/partitioned-stats/getPartitionedStats"]})}),"\n",(0,s.jsx)(n.h4,{id:"java-6",children:"Java"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"\nadmin.persistentTopics().getStats(persistentTopic);\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"internal-stats",children:"Internal stats"}),"\n",(0,s.jsx)(n.p,{children:"It shows detailed statistics of a topic."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Stat"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"entriesAddedCounter"}),(0,s.jsx)(n.td,{children:"Messages published since this broker loaded this topic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"numberOfEntries"}),(0,s.jsx)(n.td,{children:"Total number of messages being tracked"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"totalSize"}),(0,s.jsx)(n.td,{children:"Total storage size in bytes of all messages"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"currentLedgerEntries"}),(0,s.jsx)(n.td,{children:"Count of messages written to the ledger currently open for writing"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"currentLedgerSize"}),(0,s.jsx)(n.td,{children:"Size in bytes of messages written to ledger currently open for writing"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"lastLedgerCreatedTimestamp"}),(0,s.jsx)(n.td,{children:"Time when last ledger was created"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"lastLedgerCreationFailureTimestamp"}),(0,s.jsx)(n.td,{children:"time when last ledger was failed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"waitingCursorsCount"}),(0,s.jsx)(n.td,{children:"How many cursors are caught up and waiting for a new message to be published"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"pendingAddEntriesCount"}),(0,s.jsx)(n.td,{children:"How many messages have (asynchronous) write requests we are waiting on completion"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"lastConfirmedEntry"}),(0,s.jsxs)(n.td,{children:["The ledgerid",":entryid"," of the last message successfully written. If the entryid is -1, then the ledger has been opened or is currently being opened but has no entries written yet."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"state"}),(0,s.jsx)(n.td,{children:"The state of the cursor ledger. Open means we have a cursor ledger for saving updates of the markDeletePosition."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"ledgers"}),(0,s.jsx)(n.td,{children:"The ordered list of all ledgers for this topic holding its messages"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"cursors"}),(0,s.jsx)(n.td,{children:"The list of all cursors on this topic. There will be one for every subscription you saw in the topic stats."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"markDeletePosition"}),(0,s.jsx)(n.td,{children:"The ack position: the last message the subscriber acknowledged receiving"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"readPosition"}),(0,s.jsx)(n.td,{children:"The latest position of subscriber for reading message"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"waitingReadOp"}),(0,s.jsx)(n.td,{children:"This is true when the subscription has read the latest message published to the topic and is waiting on new messages to be published."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"pendingReadOps"}),(0,s.jsx)(n.td,{children:"The counter for how many outstanding read requests to the BookKeepers we have in progress"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"messagesConsumedCounter"}),(0,s.jsx)(n.td,{children:"Number of messages this cursor has acked since this broker loaded this topic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"cursorLedger"}),(0,s.jsx)(n.td,{children:"The ledger being used to persistently store the current markDeletePosition"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"cursorLedgerLastEntry"}),(0,s.jsx)(n.td,{children:"The last entryid used to persistently store the current markDeletePosition"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"individuallyDeletedMessages"}),(0,s.jsx)(n.td,{children:"If Acks are being done out of order, shows the ranges of messages Acked between the markDeletePosition and the read-position"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"lastLedgerSwitchTimestamp"}),(0,s.jsx)(n.td,{children:"The last time the cursor ledger was rolled over"})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'\n{\n  "entriesAddedCounter": 20449518,\n  "numberOfEntries": 3233,\n  "totalSize": 331482,\n  "currentLedgerEntries": 3233,\n  "currentLedgerSize": 331482,\n  "lastLedgerCreatedTimestamp": "2016-06-29 03:00:23.825",\n  "lastLedgerCreationFailureTimestamp": null,\n  "waitingCursorsCount": 1,\n  "pendingAddEntriesCount": 0,\n  "lastConfirmedEntry": "324711539:3232",\n  "state": "LedgerOpened",\n  "ledgers": [\n    {\n      "ledgerId": 324711539,\n      "entries": 0,\n      "size": 0\n    }\n  ],\n  "cursors": {\n    "my-subscription": {\n      "markDeletePosition": "324711539:3133",\n      "readPosition": "324711539:3233",\n      "waitingReadOp": true,\n      "pendingReadOps": 0,\n      "messagesConsumedCounter": 20449501,\n      "cursorLedger": 324702104,\n      "cursorLedgerLastEntry": 21,\n      "individuallyDeletedMessages": "[(324711539:3134\u2025324711539:3136], (324711539:3137\u2025324711539:3140], ]",\n      "lastLedgerSwitchTimestamp": "2016-06-29 01:30:19.313",\n      "state": "Open"\n    }\n  }\n}\n\n'})}),"\n",(0,s.jsx)(n.h4,{id:"pulsar-admin-7",children:"pulsar-admin"}),"\n",(0,s.jsxs)(n.p,{children:["The internal stats for the partitioned topic can be fetched by using the ",(0,s.jsx)(n.a,{href:"/docs/2.4.2/reference-pulsar-admin#stats-internal",children:(0,s.jsx)(n.code,{children:"stats-internal"})})," command, specifying the topic by name:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\n$ pulsar-admin topics stats-internal \\\n  persistent://test-tenant/namespace/topic\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"rest-api-7",children:"REST API"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"https://pulsar.apache.org/admin-rest-api?version=2.4.2&apiversion=v2#operation/getInternalStats",children:["GET /admin/v2/",":schema","/",":tenant","/",":namespace","/",":topic","/internalStats/getInternalStats"]})}),"\n",(0,s.jsx)(n.h4,{id:"java-7",children:"Java"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"\nadmin.persistentTopics().getInternalStats(persistentTopic);\n\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>d});var i=t(96540);const s={},a=i.createContext(s);function r(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);