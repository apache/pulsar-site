"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[15750],{52681:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"adaptors-storm","title":"Pulsar adaptor for Apache Storm","description":"Pulsar Storm is an adaptor for integrating with Apache Storm topologies. It provides core Storm implementations for sending and receiving data.","source":"@site/versioned_docs/version-2.2.0/adaptors-storm.md","sourceDirName":".","slug":"/adaptors-storm","permalink":"/docs/2.2.0/adaptors-storm","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/pulsar-site/edit/main/versioned_docs/version-2.2.0/adaptors-storm.md","tags":[],"version":"2.2.0","frontMatter":{"id":"adaptors-storm","title":"Pulsar adaptor for Apache Storm","sidebar_label":"Apache Storm","original_id":"adaptors-storm"},"sidebar":"docsSidebar","previous":{"title":"Apache Spark","permalink":"/docs/2.2.0/adaptors-spark"},"next":{"title":"Tiered Storage","permalink":"/docs/2.2.0/cookbooks-tiered-storage"}}');var s=n(74848),o=n(28453);const a={id:"adaptors-storm",title:"Pulsar adaptor for Apache Storm",sidebar_label:"Apache Storm",original_id:"adaptors-storm"},i=void 0,l={},p=[{value:"Using the Pulsar Storm Adaptor",id:"using-the-pulsar-storm-adaptor",level:2},{value:"Pulsar Spout",id:"pulsar-spout",level:2},{value:"Pulsar Bolt",id:"pulsar-bolt",level:2},{value:"Example",id:"example",level:2}];function u(e){const t={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["Pulsar Storm is an adaptor for integrating with ",(0,s.jsx)(t.a,{href:"http://storm.apache.org/",children:"Apache Storm"})," topologies. It provides core Storm implementations for sending and receiving data."]}),"\n",(0,s.jsx)(t.p,{children:"An application can inject data into a Storm topology via a generic Pulsar spout, as well as consume data from a Storm topology via a generic Pulsar bolt."}),"\n",(0,s.jsx)(t.h2,{id:"using-the-pulsar-storm-adaptor",children:"Using the Pulsar Storm Adaptor"}),"\n",(0,s.jsx)(t.p,{children:"Include dependency for Pulsar Storm Adaptor:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",children:"\n<dependency>\n  <groupId>org.apache.pulsar</groupId>\n  <artifactId>pulsar-storm</artifactId>\n  <version>${pulsar.version}</version>\n</dependency>\n\n"})}),"\n",(0,s.jsx)(t.h2,{id:"pulsar-spout",children:"Pulsar Spout"}),"\n",(0,s.jsxs)(t.p,{children:["The Pulsar Spout allows for the data published on a topic to be consumed by a Storm topology. It emits a Storm tuple based on the message received and the ",(0,s.jsx)(t.code,{children:"MessageToValuesMapper"})," provided by the client."]}),"\n",(0,s.jsx)(t.p,{children:"The tuples that fail to be processed by the downstream bolts will be re-injected by the spout with an exponential backoff, within a configurable timeout (the default is 60 seconds) or a configurable number of retries, whichever comes first, after which it is acknowledged by the consumer. Here's an example construction of a spout:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:'\n// Configure a Pulsar Client\nClientConfiguration clientConf = new ClientConfiguration();\n\n// Configure a Pulsar Consumer\nConsumerConfiguration consumerConf = new ConsumerConfiguration();\n\n@SuppressWarnings("serial")\nMessageToValuesMapper messageToValuesMapper = new MessageToValuesMapper() {\n\n    @Override\n    public Values toValues(Message msg) {\n        return new Values(new String(msg.getData()));\n    }\n\n    @Override\n    public void declareOutputFields(OutputFieldsDeclarer declarer) {\n        // declare the output fields\n        declarer.declare(new Fields("string"));\n    }\n};\n\n// Configure a Pulsar Spout\nPulsarSpoutConfiguration spoutConf = new PulsarSpoutConfiguration();\nspoutConf.setServiceUrl("pulsar://broker.messaging.usw.example.com:6650");\nspoutConf.setTopic("persistent://my-property/usw/my-ns/my-topic1");\nspoutConf.setSubscriptionName("my-subscriber-name1");\nspoutConf.setMessageToValuesMapper(messageToValuesMapper);\n\n// Create a Pulsar Spout\nPulsarSpout spout = new PulsarSpout(spoutConf, clientConf, consumerConf);\n\n'})}),"\n",(0,s.jsx)(t.h2,{id:"pulsar-bolt",children:"Pulsar Bolt"}),"\n",(0,s.jsxs)(t.p,{children:["The Pulsar bolt allows data in a Storm topology to be published on a topic. It publishes messages based on the Storm tuple received and the ",(0,s.jsx)(t.code,{children:"TupleToMessageMapper"})," provided by the client."]}),"\n",(0,s.jsxs)(t.p,{children:["A partitioned topic can also be used to publish messages on different topics. In the implementation of the ",(0,s.jsx)(t.code,{children:"TupleToMessageMapper"}),', a "key" will need to be provided in the message which will send the messages with the same key to the same topic. Here\'s an example bolt:']}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",children:'\n// Configure a Pulsar Client\nClientConfiguration clientConf = new ClientConfiguration();\n\n// Configure a Pulsar Producer\nProducerConfiguration producerConf = new ProducerConfiguration();\n\n@SuppressWarnings("serial")\nTupleToMessageMapper tupleToMessageMapper = new TupleToMessageMapper() {\n\n    @Override\n    public Message toMessage(Tuple tuple) {\n        String receivedMessage = tuple.getString(0);\n        // message processing\n        String processedMsg = receivedMessage + "-processed";\n        return MessageBuilder.create().setContent(processedMsg.getBytes()).build();\n    }\n\n    @Override\n    public void declareOutputFields(OutputFieldsDeclarer declarer) {\n        // declare the output fields\n    }\n};\n\n// Configure a Pulsar Bolt\nPulsarBoltConfiguration boltConf = new PulsarBoltConfiguration();\nboltConf.setServiceUrl("pulsar://broker.messaging.usw.example.com:6650");\nboltConf.setTopic("persistent://my-property/usw/my-ns/my-topic2");\nboltConf.setTupleToMessageMapper(tupleToMessageMapper);\n\n// Create a Pulsar Bolt\nPulsarBolt bolt = new PulsarBolt(boltConf, clientConf);\n\n'})}),"\n",(0,s.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,s.jsxs)(t.p,{children:["You can find a complete example ",(0,s.jsx)(t.a,{href:"https://github.com/apache/pulsar/tree/master/pulsar-storm/src/test/java/org/apache/pulsar/storm/example/StormExample.java",children:"here"}),"."]})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>i});var r=n(96540);const s={},o=r.createContext(s);function a(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);