"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[21960],{10349:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"helm-prepare","title":"Prepare Kubernetes resources","description":"For a fully functional Pulsar cluster, you need a few resources before deploying the Apache Pulsar Helm chart. The following provides instructions to prepare the Kubernetes cluster before deploying the Pulsar Helm chart.","source":"@site/versioned_docs/version-2.6.3/helm-prepare.md","sourceDirName":".","slug":"/helm-prepare","permalink":"/docs/2.6.3/helm-prepare","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/pulsar-site/edit/main/versioned_docs/version-2.6.3/helm-prepare.md","tags":[],"version":"2.6.3","frontMatter":{"id":"helm-prepare","title":"Prepare Kubernetes resources","sidebar_label":"Prepare","original_id":"helm-prepare"},"sidebar":"docsSidebar","previous":{"title":"Overview","permalink":"/docs/2.6.3/helm-overview"},"next":{"title":"Install ","permalink":"/docs/2.6.3/helm-install"}}');var n=s(74848),l=s(28453);const c={id:"helm-prepare",title:"Prepare Kubernetes resources",sidebar_label:"Prepare",original_id:"helm-prepare"},i=void 0,d={},o=[{value:"Google Kubernetes Engine",id:"google-kubernetes-engine",level:2},{value:"Manual cluster creation",id:"manual-cluster-creation",level:3},{value:"Scripted cluster creation",id:"scripted-cluster-creation",level:3},{value:"Create cluster with local SSDs",id:"create-cluster-with-local-ssds",level:4},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const r={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{children:"For a fully functional Pulsar cluster, you need a few resources before deploying the Apache Pulsar Helm chart. The following provides instructions to prepare the Kubernetes cluster before deploying the Pulsar Helm chart."}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"#google-kubernetes-engine",children:"Google Kubernetes Engine"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"#manual-cluster-creation",children:"Manual cluster creation"})}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"#scripted-cluster-creation",children:"Scripted cluster creation"})}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"#create-cluster-with-local-ssds",children:"Create cluster with local SSDs"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"#next-steps",children:"Next Steps"})}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"google-kubernetes-engine",children:"Google Kubernetes Engine"}),"\n",(0,n.jsx)(r.p,{children:"To get started easier, a script is provided to create the cluster automatically. Alternatively, a cluster can be created manually as well."}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"#google-kubernetes-engine",children:"Google Kubernetes Engine"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"#manual-cluster-creation",children:"Manual cluster creation"})}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"#scripted-cluster-creation",children:"Scripted cluster creation"})}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"#create-cluster-with-local-ssds",children:"Create cluster with local SSDs"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"#next-steps",children:"Next Steps"})}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"manual-cluster-creation",children:"Manual cluster creation"}),"\n",(0,n.jsxs)(r.p,{children:["To provision a Kubernetes cluster manually, follow the ",(0,n.jsx)(r.a,{href:"https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-cluster",children:"GKE instructions"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["Alternatively, you can use the ",(0,n.jsx)(r.a,{href:"#scripted-cluster-creation",children:"instructions"})," below to provision a GKE cluster as needed."]}),"\n",(0,n.jsx)(r.h3,{id:"scripted-cluster-creation",children:"Scripted cluster creation"}),"\n",(0,n.jsxs)(r.p,{children:["A ",(0,n.jsx)(r.a,{href:"https://github.com/streamnative/charts/tree/master/scripts/pulsar/gke_bootstrap_script.sh",children:"bootstrap script"})," has been created to automate much of the setup process for users on GCP/GKE."]}),"\n",(0,n.jsx)(r.p,{children:"The script can:"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Create a new GKE cluster."}),"\n",(0,n.jsx)(r.li,{children:"Allow the cluster to modify DNS (Domain Name Server) records."}),"\n",(0,n.jsxs)(r.li,{children:["Setup ",(0,n.jsx)(r.code,{children:"kubectl"}),", and connect it to the cluster."]}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["Google Cloud SDK is a dependency of this script, so ensure it is ",(0,n.jsx)(r.a,{href:"/docs/2.6.3/helm-tools#connect-to-a-gke-cluster",children:"set up correctly"})," for the script to work."]}),"\n",(0,n.jsxs)(r.p,{children:["The script reads various parameters from environment variables and an argument ",(0,n.jsx)(r.code,{children:"up"})," or ",(0,n.jsx)(r.code,{children:"down"})," for bootstrap and clean-up respectively."]}),"\n",(0,n.jsx)(r.p,{children:"The following table describes all variables."}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Variable"})}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Description"})}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Default value"})})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"PROJECT"}),(0,n.jsx)(r.td,{children:"ID of your GCP project"}),(0,n.jsx)(r.td,{children:"No default value. It requires to be set."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"CLUSTER_NAME"}),(0,n.jsx)(r.td,{children:"Name of the GKE cluster"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"pulsar-dev"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"CONFDIR"}),(0,n.jsx)(r.td,{children:"Configuration directory to store Kubernetes configuration"}),(0,n.jsx)(r.td,{children:"${HOME}/.config/streamnative"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"INT_NETWORK"}),(0,n.jsx)(r.td,{children:"IP space to use within this cluster"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"default"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"LOCAL_SSD_COUNT"}),(0,n.jsx)(r.td,{children:"Number of local SSD counts"}),(0,n.jsx)(r.td,{children:"4"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"MACHINE_TYPE"}),(0,n.jsx)(r.td,{children:"Type of machine to use for nodes"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"n1-standard-4"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"NUM_NODES"}),(0,n.jsx)(r.td,{children:"Number of nodes to be created in each of the cluster's zones"}),(0,n.jsx)(r.td,{children:"4"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"PREEMPTIBLE"}),(0,n.jsx)(r.td,{children:"Create nodes using preemptible VM instances in the new cluster."}),(0,n.jsx)(r.td,{children:"false"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"REGION"}),(0,n.jsx)(r.td,{children:"Compute region for the cluster"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"us-east1"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"USE_LOCAL_SSD"}),(0,n.jsx)(r.td,{children:"Flag to create a cluster with local SSDs"}),(0,n.jsx)(r.td,{children:"false"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"ZONE"}),(0,n.jsx)(r.td,{children:"Compute zone for the cluster"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"us-east1-b"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"ZONE_EXTENSION"}),(0,n.jsxs)(r.td,{children:["The extension (",(0,n.jsx)(r.code,{children:"a"}),", ",(0,n.jsx)(r.code,{children:"b"}),", ",(0,n.jsx)(r.code,{children:"c"}),") of the zone name of the cluster"]}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"b"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"EXTRA_CREATE_ARGS"}),(0,n.jsx)(r.td,{children:"Extra arguments passed to create command"}),(0,n.jsx)(r.td,{})]})]})]}),"\n",(0,n.jsxs)(r.p,{children:["Run the script, by passing in your desired parameters. It can work with the default parameters except for ",(0,n.jsx)(r.code,{children:"PROJECT"})," which is required:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"\nPROJECT=<gcloud project id> scripts/pulsar/gke_bootstrap_script.sh up\n\n"})}),"\n",(0,n.jsx)(r.p,{children:"The script can also be used to clean up the created GKE resources."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"\nPROJECT=<gcloud project id> scripts/pulsar/gke_bootstrap_script.sh down\n\n"})}),"\n",(0,n.jsx)(r.h4,{id:"create-cluster-with-local-ssds",children:"Create cluster with local SSDs"}),"\n",(0,n.jsxs)(r.p,{children:["To install the Pulsar Helm chart using local persistent volumes, you need to create a GKE cluster with local SSDs. You can do so by specifying ",(0,n.jsx)(r.code,{children:"USE_LOCAL_SSD"})," to be ",(0,n.jsx)(r.code,{children:"true"})," in the following command to create a Pulsar cluster with local SSDs."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"\nPROJECT=<gcloud project id> USE_LOCAL_SSD=true LOCAL_SSD_COUNT=<local-ssd-count> scripts/pulsar/gke_bootstrap_script.sh up\n\n"})}),"\n",(0,n.jsx)(r.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,n.jsxs)(r.p,{children:["Continue with the ",(0,n.jsx)(r.a,{href:"/docs/2.6.3/helm-deploy",children:"installation of the chart"})," once you have the cluster up and running."]})]})}function h(e={}){const{wrapper:r}={...(0,l.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},28453:(e,r,s)=>{s.d(r,{R:()=>c,x:()=>i});var t=s(96540);const n={},l=t.createContext(n);function c(e){const r=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),t.createElement(l.Provider,{value:r},e.children)}}}]);