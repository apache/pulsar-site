<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Apache Pulsar 2.6.0 | Apache Pulsar</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://pulsar.apache.org/img/pulsar-social-media-card.png"><meta data-rh="true" name="twitter:image" content="https://pulsar.apache.org/img/pulsar-social-media-card.png"><meta data-rh="true" property="og:url" content="https://pulsar.apache.org/blog/2020/06/18/Apache-Pulsar-2-6-0/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Apache Pulsar 2.6.0 | Apache Pulsar"><meta data-rh="true" name="description" content="We are very glad to see the Apache Pulsar community has successfully released the wonderful 2.6.0 version after accumulated hard work. It is a great milestone for this fast-growing project and the whole Pulsar community. This is the result of a huge effort from the community, with over 450 commits and a long list of new features, improvements, and bug fixes."><meta data-rh="true" property="og:description" content="We are very glad to see the Apache Pulsar community has successfully released the wonderful 2.6.0 version after accumulated hard work. It is a great milestone for this fast-growing project and the whole Pulsar community. This is the result of a huge effort from the community, with over 450 commits and a long list of new features, improvements, and bug fixes."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-06-18T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://twitter.com/lipenghui6"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pulsar.apache.org/blog/2020/06/18/Apache-Pulsar-2-6-0/"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/blog/2020/06/18/Apache-Pulsar-2-6-0/" hreflang="en"><link data-rh="true" rel="alternate" href="https://pulsar.apache.org/blog/2020/06/18/Apache-Pulsar-2-6-0/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://WK2YL0SALL-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://pulsar.apache.org/blog/2020/06/18/Apache-Pulsar-2-6-0","mainEntityOfPage":"https://pulsar.apache.org/blog/2020/06/18/Apache-Pulsar-2-6-0","url":"https://pulsar.apache.org/blog/2020/06/18/Apache-Pulsar-2-6-0","headline":"Apache Pulsar 2.6.0","name":"Apache Pulsar 2.6.0","description":"We are very glad to see the Apache Pulsar community has successfully released the wonderful 2.6.0 version after accumulated hard work. It is a great milestone for this fast-growing project and the whole Pulsar community. This is the result of a huge effort from the community, with over 450 commits and a long list of new features, improvements, and bug fixes.","datePublished":"2020-06-18T00:00:00.000Z","author":{"@type":"Person","name":"Penghui Li","url":"https://twitter.com/lipenghui6"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://pulsar.apache.org/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Apache Pulsar" href="/opensearch.xml">







<link rel="stylesheet" href="/css/katex-0.13.24.min.css" media="print" onload="this.media=&#39;all&#39;">
<script src="/js/sine-waves.min.js" async></script>
<script src="/js/matomo-agent.js"></script><link rel="stylesheet" href="/assets/css/styles.8505adb1.css">
<script src="/assets/js/runtime~main.f898f007.js" defer="defer"></script>
<script src="/assets/js/main.46e2eebc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#282826;color:#fff" role="banner"><div class="content_knG7 announcementBarContent_xLdY">
    <a class="announcement-bar" href="/blog/2025/09/09/announcing-apache-pulsar-4-1/" target="_blank">
      <div class="announcement-bar__content">
        <!-- <svg class="announcement-bar__icon">
          
<svg viewBox="0 0 33 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6.5 19.6001H16.1L15.3 29.2001L26.5 12.4H17.06L18.1 2.80005L6.5 19.6001Z" stroke="#F7F7F7" stroke-width="1.5" stroke-linejoin="round"/>
</svg>

        </svg> -->

        <span>
          ✨ Apache Pulsar 4.1 is here! ✨
        </span>

        <svg class="announcement-bar__icon">
          
<svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect width="20" height="20" transform="translate(6 6)" fill="white" fill-opacity="0.01"/>
<path d="M17.6667 10.1667L23.5 16.0001M23.5 16.0001L17.6667 21.8334M23.5 16.0001L8.5 16.0001" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
<rect x="0.5" y="0.5" width="31" height="31" rx="15.5" stroke="white"/>
</svg>

        </svg>
      </div>
    </a>
  </div></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-black.svg" alt="Apache Pulsar logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="25" width="127"><img src="/img/logo-black.svg" alt="Apache Pulsar logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="25" width="127"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Get Started</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/4.1.x/concepts-overview/">Concepts</a></li><li><a class="dropdown__link" href="/docs/4.1.x/">Quickstart</a></li><li><a class="dropdown__link" href="/ecosystem/">Ecosystem</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/4.1.x/">Docs</a><a class="navbar__item navbar__link" href="/features/">Features</a><a class="navbar__item navbar__link" href="/use-cases/">Use Cases</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link community-dropdown">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link scroll-link scroll-welcome" id="scroll-welcome" href="/community/">Welcome</a></li><li><a class="dropdown__link scroll-link scroll-discussions" id="scroll-discussions" href="/community/#section-discussions">Discussions</a></li><li><a class="dropdown__link scroll-link" id="scroll-governance" href="/community/#section-governance">Governance</a></li><li><a class="dropdown__link scroll-link" id="scroll-community" href="/community/#section-community">Meet the Community</a></li><li><a class="dropdown__link scroll-link" id="scroll-contribute" href="/community/#section-contribute">Contribute</a></li><li><a class="dropdown__link" href="/contribute/">Contribution Guide</a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Wiki</a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link">Issue Tracking</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/blog/">Blog</a></li><li><a class="dropdown__link" href="/books/">Books</a></li><li><a class="dropdown__link" href="/case-studies/">Case Studies</a></li><li><a class="dropdown__link" href="/articles/">Articles</a></li><li><a class="dropdown__link" href="/presentations/">Presentations</a></li><li><a class="dropdown__link" href="/events/">Events</a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar_download_button" href="/download/">Download</a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-top--lg"><div class="row"><main class="col col--12" itemscope="" itemtype="https://schema.org/Blog"><article class="BlogContainerPost_N_n1" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><header><div><h1 class="title_xvU1">Apache Pulsar 2.6.0</h1><div class="row"><div class="col authorCol_q4o9"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://twitter.com/lipenghui6" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Penghui Li</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div><div class="container_iJTo"><time datetime="2020-06-18T00:00:00.000Z">June 18, 2020</time> · <!-- -->19 min read</div></div></header><div id="__blog-post-container" class="markdown"><p>We are very glad to see the Apache Pulsar community has successfully released the wonderful 2.6.0 version after accumulated hard work. It is a great milestone for this fast-growing project and the whole Pulsar community. This is the result of a huge effort from the community, with over 450 commits and a long list of new features, improvements, and bug fixes.</p>
<p>Here is a selection of some of the most interesting and major features added to Pulsar 2.6.0.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-pulsar">Core Pulsar<a href="#core-pulsar" class="hash-link" aria-label="Direct link to Core Pulsar" title="Direct link to Core Pulsar">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pip-37-large-message-size-support">[PIP-37] Large message size support<a href="#pip-37-large-message-size-support" class="hash-link" aria-label="Direct link to [PIP-37] Large message size support" title="Direct link to [PIP-37] Large message size support">​</a></h3>
<p>This PIP adds support for producing and consuming large size messages by splitting the large message into multiple chunks. This is a very powerful feature for sending and consuming very large messages.</p>
<p>Currently, this feature only works for the non-shared subscription and it has client-side changes. You need to upgrade the Pulsar client version to 2.6.0. You can enable the message trunk at the producer side as below.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">newProducer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">topic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;my-topic&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">enableChunking</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about PIP-37, see <a href="https://github.com/apache/pulsar/wiki/PIP-37:-Large-message-size-handling-in-Pulsar" target="_blank" rel="noopener noreferrer">here</a>. <br> For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/4400" target="_blank" rel="noopener noreferrer">PR-4440</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pip-39-namespace-change-events-system-topic">[PIP-39] Namespace change events (system topic)<a href="#pip-39-namespace-change-events-system-topic" class="hash-link" aria-label="Direct link to [PIP-39] Namespace change events (system topic)" title="Direct link to [PIP-39] Namespace change events (system topic)">​</a></h3>
<p>This PIP introduces the system topic to store namespace change events. Previously, Pulsar only allowed you to set the namespace policy, all topics under the namespace followed the namespace policy. Many users want to set the policy for topics. The main reason for not using the same way as namespace level policy is to avoid introducing more workload on the ZooKeeper.</p>
<p>The original intention of the system topic is to be able to store topic policy in a topic rather than ZooKeeper. So this is the first step to achieve topic level policy. And we can easily add support for the topic level policy with this feature.</p>
<p>For more information about PIP-39, see <a href="https://github.com/apache/pulsar/wiki/PIP-39%3A-Namespace-Change-Events" target="_blank" rel="noopener noreferrer">here</a>.<br> For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/4955" target="_blank" rel="noopener noreferrer">PR-4955</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pip-45-pluggable-metadata-interface">[PIP-45] Pluggable metadata interface<a href="#pip-45-pluggable-metadata-interface" class="hash-link" aria-label="Direct link to [PIP-45] Pluggable metadata interface" title="Direct link to [PIP-45] Pluggable metadata interface">​</a></h3>
<p>We have been advancing to enable Pulsar to use other metastore services rather than ZooKeeper. This PIP converts <code>ManagedLedger</code> to use the <code>MetadataStore</code> interface. This facilitates the metadata server plug-in process. Through the <code>MetadataStore</code> interface, it is easy to add other metadata servers into Pulsar such as <a href="https://github.com/etcd-io/etcd" target="_blank" rel="noopener noreferrer">etcd</a>.</p>
<p>For more information about PIP-45, see <a href="https://github.com/apache/pulsar/wiki/PIP-45%3A-Pluggable-metadata-interface" target="_blank" rel="noopener noreferrer">here</a>. <br> For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/5358" target="_blank" rel="noopener noreferrer">PR-5358</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pip-54-support-acknowledgment-at-the-batch-index-level">[PIP-54] Support acknowledgment at the batch index level<a href="#pip-54-support-acknowledgment-at-the-batch-index-level" class="hash-link" aria-label="Direct link to [PIP-54] Support acknowledgment at the batch index level" title="Direct link to [PIP-54] Support acknowledgment at the batch index level">​</a></h3>
<p>Previously, the broker only tracked the acknowledged state in the batch message level. If a subset of the batch messages was acknowledged, the consumer could still get the acknowledged message of that batch message while the batch message redelivery happened.</p>
<p>This PIP adds support for acknowledging the local batch index of a batch. This feature is not enabled by default. You can enable it in the <code>broker.conf</code> as below.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">acknowledgmentAtBatchIndexLevelEnabled=true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about PIP-54, see <a href="https://github.com/apache/pulsar/wiki/PIP-54:-Support-acknowledgment-at-batch-index-level" target="_blank" rel="noopener noreferrer">here</a>. <br> For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6052" target="_blank" rel="noopener noreferrer">PR-6052</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pip-58-support-consumers-setting-custom-message-retry-delay">[PIP-58] Support consumers setting custom message retry delay<a href="#pip-58-support-consumers-setting-custom-message-retry-delay" class="hash-link" aria-label="Direct link to [PIP-58] Support consumers setting custom message retry delay" title="Direct link to [PIP-58] Support consumers setting custom message retry delay">​</a></h3>
<p>For many online business systems, various exceptions usually occur in business logic processing, so the message needs to be re-consumed, but users hope that this delay time can be controlled flexibly. Previously, processing methods were usually to send messages to special retry topics, because production can specify any delay, so consumers subscribe to the business topic and retry topic at the same time. Now you can set a retry delay for each message as below.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">Consumer</span><span class="token operator">&lt;</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">byte</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token operator">&gt;</span><span class="token plain"> consumer </span><span class="token operator">=</span><span class="token plain"> pulsarClient</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">newConsumer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">Schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">BYTES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">enableRetry</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">receiverQueueSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">deadLetterPolicy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">DeadLetterPolicy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">builder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">maxRedeliverCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">maxRedeliveryCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">retryLetterTopic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;persistent://my-property/my-ns/my-subscription-custom-Retry&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">build</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">subscribe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consumer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">reconsumeLater</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token class-name">TimeUnit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token constant" style="color:rgb(189, 147, 249)">SECONDS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about PIP-58, see <a href="https://github.com/apache/pulsar/wiki/PIP-58-%3A-Support-Consumers--Set-Custom-Retry-Delay" target="_blank" rel="noopener noreferrer">here</a>. <br> For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6449" target="_blank" rel="noopener noreferrer">PR-6449</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pip-60-support-sni-routing-to-support-various-proxy-servers">[PIP-60] Support SNI routing to support various proxy servers<a href="#pip-60-support-sni-routing-to-support-various-proxy-servers" class="hash-link" aria-label="Direct link to [PIP-60] Support SNI routing to support various proxy servers" title="Direct link to [PIP-60] Support SNI routing to support various proxy servers">​</a></h3>
<p>Previously, Pulsar did not provide support to use other proxies, such as Apache Traffic Server (ATS), HAProxy, Nginx, and Envoy, which are more scalable and secured. Most of these proxy servers support SNI routing which can route traffic to a destination without having to terminate the SSL connection. This PIP adds SNI routing and makes changes to the Pulsar client.</p>
<p>For more information about PIP-60, see <a href="https://github.com/apache/pulsar/wiki/PIP-60:-Support-Proxy-server-with-SNI-routing" target="_blank" rel="noopener noreferrer">here</a>. <br> For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/6566" target="_blank" rel="noopener noreferrer">PR-6566</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pip-61-advertise-multiple-addresses">[PIP-61] Advertise multiple addresses<a href="#pip-61-advertise-multiple-addresses" class="hash-link" aria-label="Direct link to [PIP-61] Advertise multiple addresses" title="Direct link to [PIP-61] Advertise multiple addresses">​</a></h3>
<p>This PIP allows the broker to expose multiple advertised listeners and to support the separation of internal and external network traffic. You can specify multiple advertised listeners in <code>broker.conf</code> as below.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">advertisedListeners=internal:pulsar://192.168.1.11:6660,external:pulsar://110.95.234.50:6650</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>From the client side, you can specify the listener name for the client as below.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">PulsarClient</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">builder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">serviceUrl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">listenerName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;internal&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">build</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about PIP-61, see <a href="https://github.com/apache/pulsar/wiki/PIP-61%3A-Advertised-multiple-addresses" target="_blank" rel="noopener noreferrer">here</a>. <br> For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6903" target="_blank" rel="noopener noreferrer">PR-6903</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pip-65-adapt-pulsar-io-sources-to-support-batchsources">[PIP-65] Adapt Pulsar IO sources to support <code>BatchSources</code><a href="#pip-65-adapt-pulsar-io-sources-to-support-batchsources" class="hash-link" aria-label="Direct link to pip-65-adapt-pulsar-io-sources-to-support-batchsources" title="Direct link to pip-65-adapt-pulsar-io-sources-to-support-batchsources">​</a></h3>
<p>This PIP introduces <code>BatchSource</code> as a new interface for writing batch-based connectors. It also introduces <code>BatchSourceTriggerer</code> as an interface to trigger the data collection of a <code>BatchSource</code>. It then provides system implementation in <code>BatchSourceExecutor</code>.</p>
<p>For more information about PIP-65, see <a href="https://github.com/apache/pulsar/wiki/PIP-65%3A-Adapting-Pulsar-IO-Sources-to-support-Batch-Sources" target="_blank" rel="noopener noreferrer">here</a>. <br> For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/7090" target="_blank" rel="noopener noreferrer">PR-7090</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="load-balancer-add-thresholdshedder-strategy-for-the-load-balancer">[Load balancer] Add <code>ThresholdShedder</code> strategy for the load balancer<a href="#load-balancer-add-thresholdshedder-strategy-for-the-load-balancer" class="hash-link" aria-label="Direct link to load-balancer-add-thresholdshedder-strategy-for-the-load-balancer" title="Direct link to load-balancer-add-thresholdshedder-strategy-for-the-load-balancer">​</a></h3>
<p>The <code>ThresholdShedder</code> strategy is more flexible than <code>LoadSheddingStrategy</code> for Pulsar. The <code>ThresholdShedder</code> calculates the average resource usage of the brokers, and individual broker resource usage compares with the average value. If it is greater than the average value plus threshold, the overload shedder is triggered. You can enable it in <code>broker.conf</code> as below.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">loadBalancerLoadSheddingStrategy=org.apache.pulsar.broker.loadbalance.impl.ThresholdShedder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>You can customize more parameters for the <code>ThresholdShedder</code> if needed as below.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># The broker resource usage threshold.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># When the broker resource usage is greater than the pulsar cluster average resource usage,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># the threshold shedder will be triggered to offload bundles from the broker.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># It only takes effect in ThresholdShedder strategy.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">loadBalancerBrokerThresholdShedderPercentage=10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># When calculating new resource usage, the history usage accounts for.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># It only takes effect in ThresholdShedder strategy.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">loadBalancerHistoryResourcePercentage=0.9</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># The BandWithIn usage weight when calculating new resource usage.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># It only takes effect in ThresholdShedder strategy.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">loadBalancerBandwithInResourceWeight=1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># The BandWithOut usage weight when calculating new resource usage.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># It only takes effect in ThresholdShedder strategy.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">loadBalancerBandwithOutResourceWeight=1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># The CPU usage weight when calculating new resource usage.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># It only takes effect in ThresholdShedder strategy.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">loadBalancerCPUResourceWeight=1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># The heap memory usage weight when calculating new resource usage.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># It only takes effect in ThresholdShedder strategy.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">loadBalancerMemoryResourceWeight=1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># The direct memory usage weight when calculating new resource usage.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># It only takes effect in ThresholdShedder strategy.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">loadBalancerDirectMemoryResourceWeight=1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Bundle unload minimum throughput threshold (MB), avoiding bundle unload frequently.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># It only takes effect in ThresholdShedder strategy.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">loadBalancerBundleUnloadMinThroughputThreshold=10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6772" target="_blank" rel="noopener noreferrer">PR-6772</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-shared-add-consistent-hashing-in-the-key_shared-distribution">[Key Shared] Add consistent hashing in the Key_Shared distribution<a href="#key-shared-add-consistent-hashing-in-the-key_shared-distribution" class="hash-link" aria-label="Direct link to [Key Shared] Add consistent hashing in the Key_Shared distribution" title="Direct link to [Key Shared] Add consistent hashing in the Key_Shared distribution">​</a></h3>
<p>Previously, the implementation of the Key_Shared subscription used a mechanism to divide their hash space across the available consumers. This was based on dividing the currently assigned hash ranges when a new consumer joined or left. Pulsar 2.6.0 introduces a new consistent hash distribution for the Key_Shared subscription. You can enable the consistent hash distribution in <code>broker.conf</code> and the auto split approach is still selected by default.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># On KeyShared subscriptions, with default AUTO_SPLIT mode, use splitting ranges or</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># consistent hashing to reassign keys to new consumers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subscriptionKeySharedUseConsistentHashing=false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># On KeyShared subscriptions, number of points in the consistent-hashing ring.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># The higher the number, the more equal the assignment of keys to consumers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subscriptionKeySharedConsistentHashingReplicaPoints=100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>We plan to use consistent hash distribution by default in the subsequent versions.
For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/6791" target="_blank" rel="noopener noreferrer">PR-6791</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-shared-fix-ordering-issue-in-keyshared-dispatcher-when-adding-consumers">[Key Shared] Fix ordering issue in KeyShared dispatcher when adding consumers<a href="#key-shared-fix-ordering-issue-in-keyshared-dispatcher-when-adding-consumers" class="hash-link" aria-label="Direct link to [Key Shared] Fix ordering issue in KeyShared dispatcher when adding consumers" title="Direct link to [Key Shared] Fix ordering issue in KeyShared dispatcher when adding consumers">​</a></h3>
<p>This is a great fix for the Key_Shared subscription. Previously, ordering was broken in a KeyShared dispatcher if a new consumer c2 came in and an existing consumer c1 went out. This was because messages with keys previously assigned to c1 may route to c2, which might break the message ordering dispatch guarantee in the Key_Shared subscription. This PR introduces new consumers joining in a &quot;paused&quot; state until the previous messages are acknowledged to ensure the messages are dispatched orderly.</p>
<p>If you still want the relaxed ordering, you can set up at the consumer side as below.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsarClient</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">newConsumer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">keySharedPolicy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">KeySharedPolicy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">autoSplitHashRange</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">setAllowOutOfOrderDelivery</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">subscribe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/7106" target="_blank" rel="noopener noreferrer">PR-7106</a> and <a href="https://github.com/apache/pulsar/pull/7108" target="_blank" rel="noopener noreferrer">PR-7108</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-shared-add-support-for-key-hash-range-reading">[Key Shared] Add support for key hash range reading<a href="#key-shared-add-support-for-key-hash-range-reading" class="hash-link" aria-label="Direct link to [Key Shared] Add support for key hash range reading" title="Direct link to [Key Shared] Add support for key hash range reading">​</a></h3>
<p>This PR supports sticky key hash range reader. A broker only dispatches messages whose hash of the message key contains by a specified key hash range. Besides, multiple key hash ranges can be specified on a reader.</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsarClient</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">newReader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">topic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">topic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">startMessageId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">MessageId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">earliest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">keyHashRange</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">Range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">of</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">10000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token class-name">Range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">of</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">20001</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">30000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/5928" target="_blank" rel="noopener noreferrer">PR-5928</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-pure-java-air-compressor-instead-of-jni-based-libraries">Use pure-java Air-Compressor instead of JNI based libraries<a href="#use-pure-java-air-compressor-instead-of-jni-based-libraries" class="hash-link" aria-label="Direct link to Use pure-java Air-Compressor instead of JNI based libraries" title="Direct link to Use pure-java Air-Compressor instead of JNI based libraries">​</a></h3>
<p>Previously, JNI based libraries were used to perform data compression. While these libraries do have an overhead in terms of size and affect the JNI overhead which is typically measurable when compressing many small payloads. This PR replaces compression libraries for LZ4, ZStd, and Snappy with <a href="https://github.com/airlift/aircompressor" target="_blank" rel="noopener noreferrer">AirCompressor</a>, which is a pure Java compression library used by Presto.</p>
<p>For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/5390" target="_blank" rel="noopener noreferrer">PR-5390</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-multiple-pulsar-clusters-using-the-same-bookkeeper-cluster">Support multiple Pulsar clusters using the same BookKeeper cluster<a href="#support-multiple-pulsar-clusters-using-the-same-bookkeeper-cluster" class="hash-link" aria-label="Direct link to Support multiple Pulsar clusters using the same BookKeeper cluster" title="Direct link to Support multiple Pulsar clusters using the same BookKeeper cluster">​</a></h3>
<p>This PR allows multiple pulsar clusters to use the specified BookKeeper cluster by pointing BookKeeper client to the ZooKeeper connection string of BookKeeper cluster. This PR adds a configuration (<code>bookkeeperMetadataServiceUri</code>) to discover BookKeeper cluster metadata store and uses metadata service URI to initialize BookKeeper clients.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Metadata service uri that bookkeeper is used for loading corresponding metadata driver</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># and resolving its metadata service location.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># This value can be fetched using `bookkeeper shell whatisinstanceid` command in BookKeeper cluster.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># For example: zk+hierarchical://localhost:2181/ledgers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># The metadata service uri list can also be semicolon separated values like below:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># zk+hierarchical://zk1:2181;zk2:2181;zk3:2181/ledgers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bookkeeperMetadataServiceUri=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/5985" target="_blank" rel="noopener noreferrer">PR-5985</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-deleting-inactive-topics-when-subscriptions-are-caught-up">Support deleting inactive topics when subscriptions are caught up<a href="#support-deleting-inactive-topics-when-subscriptions-are-caught-up" class="hash-link" aria-label="Direct link to Support deleting inactive topics when subscriptions are caught up" title="Direct link to Support deleting inactive topics when subscriptions are caught up">​</a></h3>
<p>Previously, Pulsar supported deleting inactive topics which do not have active producers and subscriptions. This PR supports deleting inactive topics when all subscriptions of the topic are caught up and when there are no active producers or consumers. This PR exposes inactive topic delete mode in <code>broker.conf</code>. In the future, we can support a namespace level configuration for the inactive topic delete mode.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Set the inactive topic delete mode. Default is delete_when_no_subscriptions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># &#x27;delete_when_no_subscriptions&#x27; mode only delete the topic which has no subscriptions and no active producers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># &#x27;delete_when_subscriptions_caught_up&#x27; mode only delete the topic that all subscriptions has no backlogs(caught up)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># and no active producers/consumers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">brokerDeleteInactiveTopicsMode=delete_when_no_subscriptions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6077" target="_blank" rel="noopener noreferrer">PR-6077</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-flag-to-skip-broker-shutdown-on-transient-oom">Add a flag to skip broker shutdown on transient OOM<a href="#add-a-flag-to-skip-broker-shutdown-on-transient-oom" class="hash-link" aria-label="Direct link to Add a flag to skip broker shutdown on transient OOM" title="Direct link to Add a flag to skip broker shutdown on transient OOM">​</a></h3>
<p>A high dispatch rate on one of the topics may cause a broker to go OOM temporarily. It is a transient error and the broker can recover within a few seconds as soon as some memory gets released. However, in 2.4 release (<a href="https://github.com/apache/pulsar/pull/4196" target="_blank" rel="noopener noreferrer">#4196</a>), the &quot;restarted broker on OOM&quot; feature can cause huge instability in a cluster, where a topic moves from one broker to another and restarts multiple brokers and disrupts other topics as well. So this PR provides a dynamic flag to skip broker shutdown on OOM to avoid instability in a cluster.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6634" target="_blank" rel="noopener noreferrer">PR-6634</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="make-zookeeper-cache-expiry-time-configurable">Make ZooKeeper cache expiry time configurable<a href="#make-zookeeper-cache-expiry-time-configurable" class="hash-link" aria-label="Direct link to Make ZooKeeper cache expiry time configurable" title="Direct link to Make ZooKeeper cache expiry time configurable">​</a></h3>
<p>Previously, ZooKeeper cache expiry time was hardcoded and it needed to be configurable to refresh the value based on various requirements, for example, refreshing the value quickly in case of zk-watch miss, avoiding frequent cache refresh to avoid zk-read or avoiding issue due to zk read timeout, and so on. Now you can configure ZooKeeper cache expiry time in <code>broker.conf</code> as below.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># ZooKeeper cache expiry time in seconds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">zooKeeperCacheExpirySeconds=300</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6668" target="_blank" rel="noopener noreferrer">PR-6668</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="optimize-consumer-fetch-messages-in-case-of-batch-message">Optimize consumer fetch messages in case of batch message<a href="#optimize-consumer-fetch-messages-in-case-of-batch-message" class="hash-link" aria-label="Direct link to Optimize consumer fetch messages in case of batch message" title="Direct link to Optimize consumer fetch messages in case of batch message">​</a></h3>
<p>When a consumer sends a fetch request to a broker server, it contains a fetch message number telling the server how many messages should be pushed to a consumer client. However, the broker server stores data in BookKeeper or broker cache according to entry rather than a single message if the producer produces messages using the batch feature. There is a gap to map the number of messages to the number of entries when dealing with consumer fetch requests. This PR adds a variable <code>avgMessagesPerEntry</code> to record average messages stored in one entry. It updates when a broker server pushes messages to a consumer. When dealing with consumer fetch requests, it maps fetch request number to entry number. Additionally, this PR exposes the <code>avgMessagePerEntry</code> static value to consumer stat metric json.</p>
<p>You can enable <code>preciseDispatcherFlowControl</code> in <code> broker.conf</code> as below.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Precise dispatcher flow control according to history message number of each entry</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">preciseDispatcherFlowControl=false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/6719" target="_blank" rel="noopener noreferrer">PR-6719</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduce-precise-topic-publish-rate-limiting">Introduce precise topic publish rate limiting<a href="#introduce-precise-topic-publish-rate-limiting" class="hash-link" aria-label="Direct link to Introduce precise topic publish rate limiting" title="Direct link to Introduce precise topic publish rate limiting">​</a></h3>
<p>Previously, Pulsar supported the publish rate limiting but it is not a precise control. Now, for some use cases that need precise control, you can enable it in <code>broker.conf</code> as below.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">preciseTopicPublishRateLimiterEnable=true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/7078" target="_blank" rel="noopener noreferrer">PR-7078</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="expose-check-delay-of-new-entries-in-brokerconf">Expose check delay of new entries in <code>broker.conf</code><a href="#expose-check-delay-of-new-entries-in-brokerconf" class="hash-link" aria-label="Direct link to expose-check-delay-of-new-entries-in-brokerconf" title="Direct link to expose-check-delay-of-new-entries-in-brokerconf">​</a></h3>
<p>Previously, the check delay of new entries was 10 ms and could not be changed by users. Currently, for consumption latency sensitive scenarios, you can set the value of check delay of new entries to a smaller value or 0 in <code>broker.conf</code> as below. Using a smaller value may degrade consumption throughput.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">managedLedgerNewEntriesCheckDelayInMillis=10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/7154" target="_blank" rel="noopener noreferrer">PR-7154</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="schema--supports-null-key-and-null-value-in-keyvalue-schema">[Schema]  Supports <code>null</code> key and <code>null</code> value in KeyValue schema<a href="#schema--supports-null-key-and-null-value-in-keyvalue-schema" class="hash-link" aria-label="Direct link to schema--supports-null-key-and-null-value-in-keyvalue-schema" title="Direct link to schema--supports-null-key-and-null-value-in-keyvalue-schema">​</a></h3>
<p>For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/7139" target="_blank" rel="noopener noreferrer">PR-7139</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-triggering-ledger-rollover-when-maxledgerrollovertimeminutes-is-met">Support triggering ledger rollover when <code>maxLedgerRolloverTimeMinutes</code> is met<a href="#support-triggering-ledger-rollover-when-maxledgerrollovertimeminutes-is-met" class="hash-link" aria-label="Direct link to support-triggering-ledger-rollover-when-maxledgerrollovertimeminutes-is-met" title="Direct link to support-triggering-ledger-rollover-when-maxledgerrollovertimeminutes-is-met">​</a></h3>
<p>This PR implements a monitoring thread to check if the current topic ledger meets the constraint of <code>managedLedgerMaxLedgerRolloverTimeMinutes</code> and triggers a rollover to make the configuration take effect. Another important idea is that if you trigger a rollover, you can close the current ledger so that you can release the storage of the current ledger. For some less commonly used topics, the current ledger data is likely to be expired and the current rollover logic is only triggered when adding a new entry. Obviously, this results in a waste of disk space. The monitoring thread is scheduled at a fixed time interval and the interval is set to <code>managedLedgerMaxLedgerRolloverTimeMinutes</code>. Each inspection makes two judgments at the same time, for example, <code>currentLedgerEntries &gt; 0</code> and <code>currentLedgerIsFull()</code>. When the number of current entries is equal to 0, it does not trigger a new rollover and you can use this to reduce the ledger creation.</p>
<p>For more information about implementation details, see  <a href="https://github.com/apache/pulsar/pull/7111" target="_blank" rel="noopener noreferrer">PR-7116</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="proxy">Proxy<a href="#proxy" class="hash-link" aria-label="Direct link to Proxy" title="Direct link to Proxy">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-rest-api-to-get-connection-and-topic-stats">Add REST API to get connection and topic stats<a href="#add-rest-api-to-get-connection-and-topic-stats" class="hash-link" aria-label="Direct link to Add REST API to get connection and topic stats" title="Direct link to Add REST API to get connection and topic stats">​</a></h3>
<p>Previously, Pulsar proxy did not have useful stats to get internal information about the proxy. It is better to have internal-stats of proxy to get information, such as live connections, topic stats (with higher logging level), and so on. This PR adds REST API to get stats for connection and topics served by proxy.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6473" target="_blank" rel="noopener noreferrer">PR-6473</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="admin">Admin<a href="#admin" class="hash-link" aria-label="Direct link to Admin" title="Direct link to Admin">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-getting-a-message-by-message-id-in-pulsar-admin">Support getting a message by message ID in pulsar-admin<a href="#support-getting-a-message-by-message-id-in-pulsar-admin" class="hash-link" aria-label="Direct link to Support getting a message by message ID in pulsar-admin" title="Direct link to Support getting a message by message ID in pulsar-admin">​</a></h3>
<p>This PR adds a new command <code>get-message-by-id</code> to the pulsar-admin. It allows users to check a single message by providing ledger ID and entry ID.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6331" target="_blank" rel="noopener noreferrer">PR-6331</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-deleting-subscriptions-forcefully">Support deleting subscriptions forcefully<a href="#support-deleting-subscriptions-forcefully" class="hash-link" aria-label="Direct link to Support deleting subscriptions forcefully" title="Direct link to Support deleting subscriptions forcefully">​</a></h3>
<p>This PR adds the method <code>deleteForcefully</code> to support force deleting subscriptions.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6383" target="_blank" rel="noopener noreferrer">PR-6383</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="functions">Functions<a href="#functions" class="hash-link" aria-label="Direct link to Functions" title="Direct link to Functions">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="built-in-functions">Built-in functions<a href="#built-in-functions" class="hash-link" aria-label="Direct link to Built-in functions" title="Direct link to Built-in functions">​</a></h3>
<p>This PR implements the possibility of creating built-in functions in the same way as adding built-in connectors.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6895" target="_blank" rel="noopener noreferrer">PR-6895</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-go-function-heartbeat-and-grpc-service-for-production-usage">Add Go Function heartbeat (and gRPC service) for production usage<a href="#add-go-function-heartbeat-and-grpc-service-for-production-usage" class="hash-link" aria-label="Direct link to Add Go Function heartbeat (and gRPC service) for production usage" title="Direct link to Add Go Function heartbeat (and gRPC service) for production usage">​</a></h3>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6031" target="_blank" rel="noopener noreferrer">PR-6031</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-custom-property-options-to-functions">Add custom property options to functions<a href="#add-custom-property-options-to-functions" class="hash-link" aria-label="Direct link to Add custom property options to functions" title="Direct link to Add custom property options to functions">​</a></h3>
<p>This PR allows users to set custom system properties while submitting functions. This can be used to pass credentials via a system property.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6348" target="_blank" rel="noopener noreferrer">PR-6348</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="separate-tls-configurations-of-function-worker-and-broker">Separate TLS configurations of function worker and broker<a href="#separate-tls-configurations-of-function-worker-and-broker" class="hash-link" aria-label="Direct link to Separate TLS configurations of function worker and broker" title="Direct link to Separate TLS configurations of function worker and broker">​</a></h3>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6602" target="_blank" rel="noopener noreferrer">PR-6602</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-the-ability-to-build-consumers-in-functions-and-sources">Add the ability to build consumers in functions and sources<a href="#add-the-ability-to-build-consumers-in-functions-and-sources" class="hash-link" aria-label="Direct link to Add the ability to build consumers in functions and sources" title="Direct link to Add the ability to build consumers in functions and sources">​</a></h3>
<p>Previously, function and source context give their writers an ability to create publishers but not consumers. This PR fixes this issue.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6954" target="_blank" rel="noopener noreferrer">PR-6954</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pulsar-sql">Pulsar SQL<a href="#pulsar-sql" class="hash-link" aria-label="Direct link to Pulsar SQL" title="Direct link to Pulsar SQL">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-keyvalue-schema">Support KeyValue schema<a href="#support-keyvalue-schema" class="hash-link" aria-label="Direct link to Support KeyValue schema" title="Direct link to Support KeyValue schema">​</a></h3>
<p>Previously, Pulsar SQL could not read the KeyValue schema data.</p>
<p>This PR adds KeyValue schema support for Pulsar SQL. It adds the prefix <code>key.</code> for the key field name and <code>value.</code> for the value field name.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6325" target="_blank" rel="noopener noreferrer">PR-6325</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-multiple-avro-schema-versions">Support multiple Avro schema versions<a href="#support-multiple-avro-schema-versions" class="hash-link" aria-label="Direct link to Support multiple Avro schema versions" title="Direct link to Support multiple Avro schema versions">​</a></h3>
<p>Previously, if you have multiple Avro schema versions for a topic, using the Pulsar SQL to query data from this topic will introduce some problems. With this change, You can evolve the schema of the topic and keep transitive backward compatibility of all schemas of the topic if you want to query data from this topic.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/4847" target="_blank" rel="noopener noreferrer">PR-4847</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="java-client">Java client<a href="#java-client" class="hash-link" aria-label="Direct link to Java client" title="Direct link to Java client">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-waiting-for-inflight-messages-while-closing-a-producer">Support waiting for inflight messages while closing a producer<a href="#support-waiting-for-inflight-messages-while-closing-a-producer" class="hash-link" aria-label="Direct link to Support waiting for inflight messages while closing a producer" title="Direct link to Support waiting for inflight messages while closing a producer">​</a></h3>
<p>Previously, when you closed a producer, the pulsar-client immediately failed inflight messages even if it persisted successfully at the broker. Most of the time, users want to wait for those inflight messages rather than fail them. While the pulsar-client library did not provide a way to wait for inflight messages before closing the producer. This PR supports closing API with a flag where you can control waiting for inflight messages. With this change, you can close a producer by waiting for inflight messages and the pulsar-client does not fail those messages immediately.
Previously, when you closed a producer, the pulsar-client immediately failed inflight messages even if it persisted successfully at the broker. Most of the time, users want to wait for those inflight messages rather than fail them. While the pulsar-client library did not provide a way to wait for inflight messages before closing the producer. This PR supports closing API with a flag where you can control waiting for inflight messages. With this change, you can close a producer by waiting for inflight messages and the pulsar-client does not fail those messages immediately.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6648" target="_blank" rel="noopener noreferrer">PR-6648</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-loading-tls-certskey-dynamically-from-input-stream">Support loading TLS certs/key dynamically from input stream<a href="#support-loading-tls-certskey-dynamically-from-input-stream" class="hash-link" aria-label="Direct link to Support loading TLS certs/key dynamically from input stream" title="Direct link to Support loading TLS certs/key dynamically from input stream">​</a></h3>
<p>Previously, the pulsar-client provided TLS authentication support and the default TLS provider <code>AuthenticationTls</code> expected file path of cert and key files. However, there were use cases where it was difficult for user applications to store certs/key files locally for TLS authentication. This PR adds stream support in <code>AuthenticationTls</code> to provide X509Certs and PrivateKey which also perform auto-refresh when streaming changes in a given provider.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6760" target="_blank" rel="noopener noreferrer">PR-6760</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="support-returning-sequence-id-when-throwing-an-exception-for-async-send-messages">Support returning sequence ID when throwing an exception for async send messages<a href="#support-returning-sequence-id-when-throwing-an-exception-for-async-send-messages" class="hash-link" aria-label="Direct link to Support returning sequence ID when throwing an exception for async send messages" title="Direct link to Support returning sequence ID when throwing an exception for async send messages">​</a></h3>
<p>Previously, when sending messages asynchronously failed, an exception was thrown, but did not know which message was abnormal, and users did not know which messages needed to be retried. This PR makes changes supported on the client side. When throwing an exception, the sequenceId <code>org.apache.pulsar.client.api.PulsarClientException</code> is set.</p>
<p>For more information about implementation details, see <a href="https://github.com/apache/pulsar/pull/6825" target="_blank" rel="noopener noreferrer">PR-6825</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-information">More information<a href="#more-information" class="hash-link" aria-label="Direct link to More information" title="Direct link to More information">​</a></h2>
<ul>
<li>To download Apache Pulsar 2.6.0, click <a href="https://pulsar.apache.org/download/" target="_blank" rel="noopener noreferrer">here</a>.</li>
<li>For more information about Apache Pulsar 2.6.0, see <a href="https://pulsar.apache.org/release-notes/#2.6.0" target="_blank" rel="noopener noreferrer">2.6.0 release notes</a> and <a href="https://github.com/apache/pulsar/pulls?q=milestone%3A2.6.0+-label%3Arelease%2F2.5.2+-label%3Arelease%2F2.5.1+" target="_blank" rel="noopener noreferrer">2.6.0 PR list</a>.</li>
</ul>
<p>If you have any questions or suggestions, contact us with mailing lists or slack.</p>
<ul>
<li><a href="mailto:users@pulsar.apache.org" target="_blank" rel="noopener noreferrer">users@pulsar.apache.org</a></li>
<li><a href="mailto:dev@pulsar.apache.org" target="_blank" rel="noopener noreferrer">dev@pulsar.apache.org</a></li>
<li>Pulsar slack channel: <a href="https://apache-pulsar.slack.com/" target="_blank" rel="noopener noreferrer">https://apache-pulsar.slack.com/</a></li>
<li>Self-registration at <a href="https://apache-pulsar.herokuapp.com/" target="_blank" rel="noopener noreferrer">https://apache-pulsar.herokuapp.com/</a></li>
</ul>
<p>Looking forward to your contributions to <a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer">Pulsar</a>.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/apache/pulsar-site/edit/main/blog/2020-06-18-Apache-Pulsar-2-6-0.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav blog-post-pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2020/08/21/Apache-Pulsar-2-6-1/"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Apache Pulsar 2.6.1</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2020/05/19/Apache-Pulsar-2-5-2/"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Apache Pulsar 2.5.2</div></a><div class="blog-post-pagination-nav-more"><a href="/blog">Show All</a></div></div></nav></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/security/">Security</a></li><li class="footer__item"><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/contact/">Contact</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="social-icons">
                  <a target="_blank" href="https://communityinviter.com/apps/apache-pulsar/apache-pulsar" aria-label="Join the Apache Pulsar Slack workspace">
                    <img alt="Slack logo" src="/img/slack-white.svg" width="26">
                  </a>
                  <a target="_blank" href="https://github.com/apache/pulsar/" aria-label="View the Apache Pulsar project on GitHub">
                    <img alt="GitHub logo" src="/img/github-white.svg" width="26">
                  </a>
                </div>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/pulsar-white.svg" alt="Pulsar Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/pulsar-white.svg" alt="Pulsar Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">
        <div>
          <img class="footer-apache-logo" src="/img/feather-logo-white.svg" alt="" width="20">
          The Apache Software Foundation
        </div>
        <p>Apache Pulsar is available under the Apache License, version 2.0. Apache Pulsar is an open-source, distributed messaging and streaming platform built for the cloud.</p>
        <p>Copyright © 2025 The Apache Software Foundation. All Rights Reserved. Apache, Pulsar, Apache Pulsar, and the Apache feather logo are trademarks or registered trademarks of The Apache Software Foundation.</p>
      </div></div></div></footer></div>
</body>
</html>