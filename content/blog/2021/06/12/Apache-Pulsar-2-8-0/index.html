<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Atom Feed"><title data-react-helmet="true">Apache Pulsar 2.8.0 | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/blog/2021/06/12/Apache-Pulsar-2-8-0"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Apache Pulsar 2.8.0 | Apache Pulsar"><meta data-react-helmet="true" name="description" content="We are very glad to see the Apache Pulsar community has successfully released the 2.8.0 version, which includes a number of exciting upgrades and enhancements. This blog provides a deep dive into the updates from the 2.8.0 release as well as a detailed look at the major Pulsar developments that have helped it evolve into the unified messaging and streaming platform it is today."><meta data-react-helmet="true" property="og:description" content="We are very glad to see the Apache Pulsar community has successfully released the 2.8.0 version, which includes a number of exciting upgrades and enhancements. This blog provides a deep dive into the updates from the 2.8.0 release as well as a detailed look at the major Pulsar developments that have helped it evolve into the unified messaging and streaming platform it is today."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-06-12T00:00:00.000Z"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/blog/2021/06/12/Apache-Pulsar-2-8-0"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/blog/2021/06/12/Apache-Pulsar-2-8-0" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/blog/2021/06/12/Apache-Pulsar-2-8-0" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.7e3a3d28.css">
<link rel="preload" href="/assets/js/runtime~main.2169ad2c.js" as="script">
<link rel="preload" href="/assets/js/main.5c8dc8b9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="tailwind navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a><a class="font-bold underline mr-4 -ml-4" href="/versions/">2.9.1</a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/download">Download</a><a class="navbar__item navbar__link" href="/docs/client-libraries">Clients</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">REST APIs</a><ul class="dropdown__menu"><li><a href="/admin-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Admin REST API</span></a></li><li><a href="/functions-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Functions</span></a></li><li><a href="/source-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Sources</span></a></li><li><a href="/sink-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Sinks</span></a></li><li><a href="/packages-rest-api" rel="noopener noreferrer" class="dropdown__link"><span>Packages</span></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">CLI</a><ul class="dropdown__menu"><li><a href="/pulsar-admin-cli" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Admin</span></a></li><li><a href="/pulsar-client-cli" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Client</span></a></li><li><a href="/pulsar-perf-cli" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Perf</span></a></li><li><a href="/pulsar-cli" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar</span></a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contact">Contact</a></li><li><a class="dropdown__link" href="/contributing">Contributing</a></li><li><a class="dropdown__link" href="/coding-guide">Coding guide</a></li><li><a class="dropdown__link" href="/events">Events</a></li><li><a href="https://twitter.com/Apache_Pulsar" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Twitter<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Wiki<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Issue tracking<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://pulsar-summit.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Summit<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a class="dropdown__link" href="/resources">Resources</a></li><li><a class="dropdown__link" href="/team">Team</a></li><li><a class="dropdown__link" href="/powered-by">Powered By</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Foundation<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>License<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Sponsorship<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Thanks<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Security<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs">Previous Versions</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs">2.9.1</a></li><li><a class="dropdown__link" href="/docs/2.9.0/">2.9.0</a></li><li><a class="dropdown__link" href="/docs/2.8.0/">2.8.0</a></li><li><a class="dropdown__link" href="/docs/2.7.0/">2.7.0</a></li></ul></div><a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_iQ2x toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">üåú</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">üåû</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/12/14/Apache-Pulsar-2-7-4">What‚Äôs New in Apache Pulsar 2.7.4</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/12/11/Log4j-CVE">Log4j2 Zero Day vulnerability (CVE-2021-44228)</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/09/23/Apache-Pulsar-2-8-1">Apache Pulsar 2.8.1</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/08/18/asia-cfp">Announcing Pulsar Summit Asia 2021: CFP Is Open!</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/08/11/Apache-Pulsar-2-7-3">Apache Pulsar 2.7.3</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Apache Pulsar 2.8.0</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-06-12T00:00:00.000Z" itemprop="datePublished">June 12, 2021</time> ¬∑ <!-- -->14 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a itemprop="url"><span itemprop="name">Matteo Merli, Sijie Guo</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>We are very glad to see the Apache Pulsar community has successfully released the 2.8.0 version, which includes a number of exciting upgrades and enhancements. This blog provides a deep dive into the updates from the 2.8.0 release as well as a detailed look at the major Pulsar developments that have helped it evolve into the unified messaging and streaming platform it is today.</p><p>Note: The Pulsar community typically releases a major release every 3 months, but it has been 6 months since the release of 2.7.0. We spent more time on 2.8.0 in order to make the transaction API generally available to the Pulsar community. </p><header><h1>Release 2.8 Overview</h1></header><p>The key features and updates in this release are:</p><ul><li>Exclusive Producer</li><li>Package Management API</li><li>Simplified Client Memory Limit Settings</li><li>Broker Entry Metadata</li><li>New Protobuf Code Generator</li><li>Transactions</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="exclusive-producer">Exclusive Producer<a class="hash-link" href="#exclusive-producer" title="Direct link to heading">‚Äã</a></h2><p>By default, the Pulsar producer API provides a ‚Äúmulti-writer‚Äù semantic to append messages to a topic. However, there are several use cases that require exclusive access for a single writer, such as ensuring a linear non-interleaved history of messages or providing a mechanism for leader election.</p><p>This new feature allows applications to require exclusive producer access in order to achieve a ‚Äúsingle-writer‚Äù situation. It guarantees that there should be 1 single writer in any combination of errors. If the producer loses its exclusive access, no more messages from it can be published on the topic.</p><p>One use case for this feature is the metadata controller in Pulsar Functions. In order to write a single linear history of all the functions metadata updates, the metadata controller requires to elect one leader and that all the ‚Äúdecisions‚Äù made by this leader be written on the metadata topic. By leveraging the exclusive producer feature, Pulsar guarantees that the metadata topic contains different segments of updates, one per each successive leader, and there is no interleaving across different leaders. See ‚Äú<a href="https://github.com/apache/pulsar/wiki/PIP-68%3A-Exclusive-Producer" target="_blank" rel="noopener noreferrer">PIP-68: Exclusive Producer</a>‚Äù for more details.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="package-management-api">Package Management API<a class="hash-link" href="#package-management-api" title="Direct link to heading">‚Äã</a></h2><p>Since its introduction in version 2.0, the Functions API has become hugely popular among Pulsar users. While it offers many benefits, there are a number of ways to improve the user experience. For example, today, if a function is deployed multiple times, the function package ends up being uploaded multiple times. Also, there is no version management in Pulsar for Functions and IO connectors. The newly introduced package management API provides an easier way to manage the packages for Functions and IO connectors and significantly simplifies the upgrade and rollback processes. Read ‚Äú<a href="http://pulsar.apache.org/docs/en/admin-api-packages/" target="_blank" rel="noopener noreferrer">Package Management API</a>‚Äù for more details.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="simplified-client-memory-limit-settings">Simplified Client Memory Limit Settings<a class="hash-link" href="#simplified-client-memory-limit-settings" title="Direct link to heading">‚Äã</a></h2><p>Prior to 2.8, there are multiple settings in producers and consumers that allow controlling the sizes of the internal message queues. These settings ultimately control the amount of memory the Pulsar client uses. However, there are few issues with this approach that make it complicated to select an overall configuration that controls the total usage of memory. </p><p>For example, the settings are based on the ‚Äúnumber of messages‚Äù, so the expected message size must be adjusted per producer or consumer. If an application has a large (or unknown) number of producers or consumers, it‚Äôs very difficult to select an appropriate value for queue sizes. The same is true for topics that have many partitions.</p><p>In 2.8, we introduced a new API to set the memory limit. This single <code>memoryLimit</code> setting specifies a maximum amount of memory on a given Pulsar client. The producers and consumers compete for the memory assigned. It ensures the memory used by the Pulsar client will not go beyond the set limit. Read ‚Äú<a href="https://github.com/apache/pulsar/wiki/PIP-74%3A-Pulsar-client-memory-limits" target="_blank" rel="noopener noreferrer">PIP-74: Pulsar client memory limits</a>‚Äù for more details.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="broker-entry-metadata">Broker Entry Metadata<a class="hash-link" href="#broker-entry-metadata" title="Direct link to heading">‚Äã</a></h2><p>Pulsar messages define a very comprehensive set of metadata properties. However, to add a new property, the <code>MessageMetadata</code> definition in Pulsar protocol must change to inform both broker and client of the newly introduced property. </p><p>But in certain cases, this metadata property might need to be added from the broker side, or need to be retrieved by the broker at a very low cost. To prevent deserializing these properties from the message metadata, we introduced ‚ÄúBroker Entry Metadata‚Äù in 2.8.0 to provide a lightweight approach to add additional metadata properties without serializing and deserializing the protobuf-encoded <code>MessageMetadata</code>. </p><p>This feature unblocks a new set of capabilities for Pulsar. For example, we can leverage broker entry metadata to generate broker publish time for the messages appended to the Pulsar topic. The other example is to generate a monotonically increasing sequence-id for messages produced to a Pulsar topic. We use this feature in Kafka-on-Pulsar to implement Kafka offset.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="new-protobuf-code-generator">New Protobuf Code Generator<a class="hash-link" href="#new-protobuf-code-generator" title="Direct link to heading">‚Äã</a></h2><p>Pulsar uses Google Protobuf in order to perform serialization and deserialization of the commands that are exchanged between clients and brokers. Because of the overhead involved with the regular Protobuf implementation, we have been using a modified version of Protobuf 2.4.1. The modifications were done to ensure a more efficient serialization code that used thread local cache for the objects used in the process.</p><p>This approach introduced a few issues. For example, the patch to the Protobuf code generator is only based on Protobuf version 2.4.1 and cannot be upgraded to the newer Protobuf versions. In 2.8, we switched the patched Protobuf 2.4.1 to Splunk LightProto as the code generator. The new code generator generates the fastest possible Java code for Protobuf SerDe, is 100% compatible with proto2 definition and wire protocol, and provides zero-copy deserialization using Netty ByteBuf.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="transactions">Transactions<a class="hash-link" href="#transactions" title="Direct link to heading">‚Äã</a></h2><p>Prior to Pulsar 2.8, Pulsar only supported exactly-once semantics on single topic through Idempotent Producer. While powerful, Idempotent producer only solves a narrow scope of challenges for exactly-once semantics. For example, there is no <code>atomicity</code> when a producer attempts to produce messages to multiple topics. A publish error can occur when the broker serving one of the topics crashes. If the producer doesn‚Äôt retry publishing the message again, it results in some messages being persisted once and others being lost. If the producer retries, it results in some messages being persisted multiple times.</p><p>In order to address the remaining challenges described above, we‚Äôve strengthened the Pulsar‚Äôs delivery semantics by introducing a Pulsar Transaction API to support atomic writes and acknowledgements across multiple topics. The addition of the Transaction API to Apache Pulsar completes our vision of making Pulsar a complete unified messaging and streaming platform.</p><p>Pulsar PMC member, Penghui Li, goes over this functionality in great detail in his recent blog, Exactly-once Semantics with Transactions in Pulsar. You can read it to learn more about the <a href="https://streamnative.io/en/blog/release/2021-06-14-exactly-once-semantics-with-transactions-in-pulsar" target="_blank" rel="noopener noreferrer">exactly-once semantics support in Pulsar</a>.</p><header><h1>Building a Unified Messaging and Streaming Platform with Apache Pulsar</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="the-evolution-of-apache-pulsar">The Evolution of Apache Pulsar<a class="hash-link" href="#the-evolution-of-apache-pulsar" title="Direct link to heading">‚Äã</a></h2><p>Apache Pulsar is widely adopted by hundreds of companies across the globe, including Splunk, Tencent, Verizon, and Yahoo! JAPAN, just to name a few. Born as a cloud-native distributed messaging system, Apache Pulsar has evolved into a complete messaging and streaming platform for publishing and subscribing, storing, and processing streams of data at scale and in real-time. </p><p>Back in 2012 the Yahoo! team was looking for a global, geo-replicated infrastructure that could manage all of Yahoo!‚Äôs messaging data. After vetting the messaging and streaming landscape it became clear that existing technologies were not able to serve the need for an event-driven organization. As a result, the team at Yahoo! set out to build its own.</p><p>At the time, there were generally two types of systems to handle in-motion data: message queues that handled mission-critical business events in real-time, and streaming systems that handled scalable data pipelines at scale. Companies had to limit their capabilities to one or the other, or they had to adopt multiple different technologies. If they chose multiple technologies, they would end up with a complex infrastructure that often resulted in data segregation and data silos, with one silo for message queues used to build application services and the other silo for streaming systems used to build data services. The figure below illustrates what this can look like. </p><p><img src="/assets/images/280-1-98d0691de155a939f53568aa08a2bac4.png"></p><p>However, with the diversity of data that companies need to process beyond operational data (like log data, click events, etc), coupled with the increase in the number of downstream systems that need access to combined business data and operational data, the system would need to support message queueing and streaming. </p><p>Beyond that, companies need an infrastructure platform that would allow them to build all of their applications on top of it, and then have those applications handle in-motion data (messaging and streaming data) by default. This way real-time data infrastructure could be significantly simplified, as illustrated in the diagram below.</p><p><img src="/assets/images/280-2-10c31765a2c1024630b6c7bcce3dcc23.png"></p><p>With that vision, the Yahoo! team started working on building a unified messaging and streaming platform for in-motion data. Below is an overview of the key milestones on the Pulsar journey, from inception to today.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-1-a-scalable-storage-for-streams-of-data">Step 1: A scalable storage for streams of data<a class="hash-link" href="#step-1-a-scalable-storage-for-streams-of-data" title="Direct link to heading">‚Äã</a></h2><p>The journey of Pulsar began with Apache BookKeeper. Apache BookKeeper implements a log-like abstraction for continuous streams and provides the ability to run it at internet-scale with simple write-read log APIs. A log provides a great abstraction for building distributed systems, such as distributed databases and pub-sub messaging. The write APIs are in the form of appends to the log. And the read APIs are in the form of continuous read from a starting offset defined by the readers. The implementation of BookKeeper created the foundation - a scalable log-backed messaging and streaming system. </p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-2-a-multi-layered-architecture-that-separates-compute-from-storage">Step 2: A multi-layered architecture that separates compute from storage.<a class="hash-link" href="#step-2-a-multi-layered-architecture-that-separates-compute-from-storage" title="Direct link to heading">‚Äã</a></h2><p>On top of the scalable log storage, a stateless serving layer was introduced which runs stateless brokers for publishing and consuming messages. This multi-layered architecture separates serving/compute from storage, allowing Pulsar to manage serving and storage in separate layers.</p><p>This architecture also ensures instant scalability and higher availability. Both of these factors are extremely important and make Pulsar well-suited for building mission-critical services, such as billing platforms for financial use cases, transaction processing systems for e-commerce and retailers, and real-time risk control systems for financial institutions.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-3-unified-messaging-model-and-api">Step 3: Unified messaging model and API<a class="hash-link" href="#step-3-unified-messaging-model-and-api" title="Direct link to heading">‚Äã</a></h2><p>In a modern data architecture, the real-time use cases can typically be categorized into two categories: queueing and streaming. Queueing is typically used for building core business application services while streaming is typically used for building real-time data services such as data pipelines.</p><p>To provide one platform able to serve both application and data services required a unified messaging model that integrates queuing and streaming semantics. The Pulsar topics become the source of truth for consumption. Messages can be stored only once on topics, but can be consumed in different ways via different subscriptions. Such unification significantly reduces the complexity of managing and developing messaging and streaming applications.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-4-schema-api">Step 4: Schema API<a class="hash-link" href="#step-4-schema-api" title="Direct link to heading">‚Äã</a></h2><p>Next, a new Pulsar schema registry and a new type-safe producer &amp; consumer API were added. The built-in schema registry enables message producers and consumers on Pulsar topics to coordinate on the structure of the topic‚Äôs data through the Pulsar broker itself, without needing an external coordination mechanism. With data schemas, every single piece of data traveling through Pulsar is completely discoverable, enabling you to build systems that can easily adapt as the data changes.</p><p>Furthermore, the schema registry keeps track of data compatibility between versions of the schema. As the new schemas are uploaded the registry ensures that new schema versions are able to be read by old consumers. This ensures that Producers cannot break Consumers.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-5-functions-and-io-api">Step 5: Functions and IO API<a class="hash-link" href="#step-5-functions-and-io-api" title="Direct link to heading">‚Äã</a></h2><p>The next step was to build APIs that made it easy to get data in and out of Pulsar and process it. The goal was to make it easy to build event-driven applications and real-time data pipelines with Apache Pulsar, so you can then process those events when they arrive, no matter where they originated from. </p><p>The Pulsar IO API allows you to build real-time streaming data pipelines by plugging various source connectors to get data from external systems into Pulsar and sink connectors to get data from Pulsar into external systems. Today, Pulsar provides several built-in connectors that you can use. </p><p>Additionally, StreamNative Hub (a registry of Pulsar connectors) provides dozens of connectors integrated with popular data systems. If the IO API is for building streaming data pipelines, the Functions API is for building event-driven applications and real-time stream processors. </p><p>The serverless function concepts were adopted into stream processing and then built the Functions API as a lightweight serverless library that you can write any event processing logic using any language you like. The underlying motivation was to enable your engineering team to write stream processing logic without the operational complexity of running and maintaining yet another cluster.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-6-infinite-storage-for-pulsar-via-tiered-storage">Step 6: Infinite storage for Pulsar via Tiered Storage<a class="hash-link" href="#step-6-infinite-storage-for-pulsar-via-tiered-storage" title="Direct link to heading">‚Äã</a></h2><p>As adoption of Apache Pulsar continued and the amount of data stored in Pulsar increased, users eventually hit a ‚Äúretention cliff‚Äù, at which point it became significantly more expensive to store, manage, and retrieve data in Apache BookKeeper. To work around this, operators and application developers typically use an external store like AWS S3 as a sink for long-term storage. This means you lose most of the benefits of Pulsar‚Äôs immutable stream and ordering semantics, and instead end up having to manage two different systems with different access patterns.</p><p>The introduction of Tiered Storage allows Pulsar to offload the majority of the data to a remote cloud-native storage. This cheaper form of storage readily scales with the volume of data. More importantly, with the addition of Tiered Storage, Pulsar provides the batch storage capabilities needed to support batch processing when integrating with a unified batch and stream processor like Flink. The unified batch and stream processing capabilities integrated with Pulsar enable companies to query real-time streams with historical context quickly and easily, unlocking a unique competitive advantage.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-7-protocol-handler">Step 7: Protocol Handler<a class="hash-link" href="#step-7-protocol-handler" title="Direct link to heading">‚Äã</a></h2><p>After introducing tiered storage, Pulsar evolved from a Pub/Sub messaging system into a scalable stream data system that can ingest, store, and process streams of data. However, existing applications written using other messaging protocols such as Kafka, AMQP, MQTT, etc had to be rewritten to adopt Pulsar‚Äôs messaging protocol.</p><p>The Protocol Handler API  further reduces the overhead of adopting Pulsar for building messaging and streaming applications, and allows developers to extend Pulsar capabilities to other messaging domains by leveraging all the benefits provided by Pulsar architecture. This resulted in major collaborations between Pulsar and other industry leaders to develop popular protocol handlers including:</p><ul><li><a href="https://hub.streamnative.io/protocol-handlers/kop/0.2.0" target="_blank" rel="noopener noreferrer">Kafka-on-Pulsar (KoP)</a>, which was <a href="https://streamnative.io/en/blog/tech/2020-03-24-bring-native-kafka-protocol-support-to-apache-pulsar" target="_blank" rel="noopener noreferrer">launched in March 2020</a> by OVHCloud and StreamNative. </li><li><a href="https://hub.streamnative.io/protocol-handlers/aop/0.1.0" target="_blank" rel="noopener noreferrer">AMQP-on-Pulsar (AoP)</a>, which was <a href="https://streamnative.io/en/blog/tech/2020-06-15-announcing-aop-on-pulsar" target="_blank" rel="noopener noreferrer">announced in June 2020</a> by China Mobile and StreamNative.</li><li><a href="https://hub.streamnative.io/protocol-handlers/mop/0.2.0" target="_blank" rel="noopener noreferrer">MQTT-on-Pulsar (MoP)</a>, which was <a href="https://streamnative.io/en/blog/tech/2020-09-28-announcing-mqtt-on-pulsar" target="_blank" rel="noopener noreferrer">announced in August 2020</a> by StreamNative.</li><li><a href="https://github.com/streamnative/rop" target="_blank" rel="noopener noreferrer">RocketMQ-on-Pulsar (RoP)</a>, which was launched in May 2021 by Tencent Cloud and StreamNative.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-8-transaction-api-for-exactly-once-stream-processing">Step 8: Transaction API for exactly-once stream processing<a class="hash-link" href="#step-8-transaction-api-for-exactly-once-stream-processing" title="Direct link to heading">‚Äã</a></h2><p>More recently, transactions were added to Apache Pulsar to enable exactly-once semantics for stream processing. This is a fundamental feature that provides a strong guarantee for streaming data transformations, making it easy to build scalable, fault-tolerant, stateful messaging and streaming applications that process streams of data.</p><p>Furthermore, the transaction API capabilities are not limited to a given language client. Pulsar‚Äôs support for transactional messaging and streaming is primarily a protocol-level capability that can be presented in any language. Such protocol-level capability can be leveraged in all kinds of applications. </p><header><h1>Building an ecosystem for unified messaging and streaming</h1></header><p>In addition to contributing to the Pulsar technology, the community is also working to build a robust ecosystem to support it. Pulsar‚Äôs ability to support a rich ecosystem of pub-sub libraries, connectors, functions, protocol handlers, and integrations with popular query engines will enable Pulsar adopters to streamline workflows and achieve new use cases.</p><header><h1>What is Next?</h1></header><p>If you are interested in learning more about Pulsar 2.8.0, you can <a href="https://pulsar.apache.org/en/versions/" target="_blank" rel="noopener noreferrer">download 2.8.0</a> and try it out today! </p><p>If you want to learn more about how companies have adopted Pulsar, you can <a href="https://hopin.com/events/pulsar-summit-north-america-2021" target="_blank" rel="noopener noreferrer">sign up</a> for Pulsar Summit NA 2021!</p><p>For more information about the Apache Pulsar project and the progress, please visit the official website at <a href="https://pulsar.apache.org" target="_blank" rel="noopener noreferrer">https://pulsar.apache.org</a> and follow the project on Twitter <a href="https://twitter.com/apache_pulsar" target="_blank" rel="noopener noreferrer">@apache_pulsar</a>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2021/08/11/Apache-Pulsar-2-7-3"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">¬´ <!-- -->Apache Pulsar 2.7.3</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2021/05/13/Apache-Pulsar-2-7-2"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Apache Pulsar 2.7.2<!-- --> ¬ª</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#exclusive-producer" class="table-of-contents__link toc-highlight">Exclusive Producer</a></li><li><a href="#package-management-api" class="table-of-contents__link toc-highlight">Package Management API</a></li><li><a href="#simplified-client-memory-limit-settings" class="table-of-contents__link toc-highlight">Simplified Client Memory Limit Settings</a></li><li><a href="#broker-entry-metadata" class="table-of-contents__link toc-highlight">Broker Entry Metadata</a></li><li><a href="#new-protobuf-code-generator" class="table-of-contents__link toc-highlight">New Protobuf Code Generator</a></li><li><a href="#transactions" class="table-of-contents__link toc-highlight">Transactions</a></li><li><a href="#the-evolution-of-apache-pulsar" class="table-of-contents__link toc-highlight">The Evolution of Apache Pulsar</a></li><li><a href="#step-1-a-scalable-storage-for-streams-of-data" class="table-of-contents__link toc-highlight">Step 1: A scalable storage for streams of data</a></li><li><a href="#step-2-a-multi-layered-architecture-that-separates-compute-from-storage" class="table-of-contents__link toc-highlight">Step 2: A multi-layered architecture that separates compute from storage.</a></li><li><a href="#step-3-unified-messaging-model-and-api" class="table-of-contents__link toc-highlight">Step 3: Unified messaging model and API</a></li><li><a href="#step-4-schema-api" class="table-of-contents__link toc-highlight">Step 4: Schema API</a></li><li><a href="#step-5-functions-and-io-api" class="table-of-contents__link toc-highlight">Step 5: Functions and IO API</a></li><li><a href="#step-6-infinite-storage-for-pulsar-via-tiered-storage" class="table-of-contents__link toc-highlight">Step 6: Infinite storage for Pulsar via Tiered Storage</a></li><li><a href="#step-7-protocol-handler" class="table-of-contents__link toc-highlight">Step 7: Protocol Handler</a></li><li><a href="#step-8-transaction-api-for-exactly-once-stream-processing" class="table-of-contents__link toc-highlight">Step 8: Transaction API for exactly-once stream processing</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Inc.Copyright ¬© 2021 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2169ad2c.js"></script>
<script src="/assets/js/main.5c8dc8b9.js"></script>
</body>
</html>