<!doctype html>
<html class="docs-version-2.2.0" lang="zh-TW" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/zh-TW/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-TW/blog/atom.xml" title="Apache Pulsar Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache Pulsar" href="/zh-TW/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@300;400;600&display=swap">
<script src="https://cdn.jsdelivr.net/npm/sine-waves@0.3.0/sine-waves.min.js" async></script><title data-react-helmet="true">Deploying a multi-cluster on bare metal | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.org/zh-TW/docs/2.2.0/deploy-bare-metal-multi-cluster"><meta data-react-helmet="true" name="docsearch:language" content="zh-TW"><meta data-react-helmet="true" name="docsearch:version" content="2.2.0"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-2.2.0"><meta data-react-helmet="true" property="og:title" content="Deploying a multi-cluster on bare metal | Apache Pulsar"><meta data-react-helmet="true" name="description" content="1. Single-cluster Pulsar installations should be sufficient for all but the most ambitious use cases. If you&#x27;re interested in experimenting with Pulsar or using it in a startup or on a single team, we recommend opting for a single cluster. For instructions on deploying a single cluster, see the guide here."><meta data-react-helmet="true" property="og:description" content="1. Single-cluster Pulsar installations should be sufficient for all but the most ambitious use cases. If you&#x27;re interested in experimenting with Pulsar or using it in a startup or on a single team, we recommend opting for a single cluster. For instructions on deploying a single cluster, see the guide here."><link data-react-helmet="true" rel="icon" href="/zh-TW/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.org/zh-TW/docs/2.2.0/deploy-bare-metal-multi-cluster"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/docs/2.2.0/deploy-bare-metal-multi-cluster" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/zh-CN/docs/2.2.0/deploy-bare-metal-multi-cluster" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/zh-TW/docs/2.2.0/deploy-bare-metal-multi-cluster" hreflang="zh-TW"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/ja/docs/2.2.0/deploy-bare-metal-multi-cluster" hreflang="ja"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/fr/docs/2.2.0/deploy-bare-metal-multi-cluster" hreflang="fr"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/ko/docs/2.2.0/deploy-bare-metal-multi-cluster" hreflang="ko"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/docs/2.2.0/deploy-bare-metal-multi-cluster" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh-TW/assets/css/styles.e23c3d15.css">
<link rel="preload" href="/zh-TW/assets/js/runtime~main.8684db6e.js" as="script">
<link rel="preload" href="/zh-TW/assets/js/main.f14de376.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="tailwind navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-TW/"><div class="navbar__logo"><img src="/zh-TW/img/logo.svg" alt="pulasr logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/zh-TW/img/logo.svg" alt="pulasr logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Get Started</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/zh-TW/docs/2.2.0/concepts-overview">Pulsar Concepts</a></li><li><a class="dropdown__link navbar__link--active" href="/zh-TW/docs/2.2.0/about">Quickstart</a></li><li><a class="dropdown__link" href="/zh-TW/ecosystem">Ecosystem</a></li></ul></div><a class="navbar__item navbar__link navbar__link--active" href="/zh-TW/docs/2.2.0/about">Docs</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">REST APIs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-TW/admin-rest-api">Admin REST API</a></li><li><a class="dropdown__link" href="/zh-TW/functions-rest-api">Functions</a></li><li><a class="dropdown__link" href="/zh-TW/source-rest-api">Sources</a></li><li><a class="dropdown__link" href="/zh-TW/sink-rest-api">Sinks</a></li><li><a class="dropdown__link" href="/zh-TW/packages-rest-api">Packages</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">CLI</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-TW/pulsar-admin-cli">Pulsar Admin</a></li><li><a class="dropdown__link" href="/zh-TW/pulsar-client-cli">Pulsar Client</a></li><li><a class="dropdown__link" href="/zh-TW/pulsar-perf-cli">Pulsar Perf</a></li><li><a class="dropdown__link" href="/zh-TW/pulsar-cli">Pulsar</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-TW/community#welcome">Welcome</a></li><li><a class="dropdown__link" href="/zh-TW/community#discussions">Discussions</a></li><li><a class="dropdown__link" href="/zh-TW/community#governance">Governance</a></li><li><a class="dropdown__link" href="/zh-TW/community#community">Meet the Community</a></li><li><a class="dropdown__link" href="/zh-TW/community#how-to-contribute">Contribute</a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Wiki</a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link">Issue Tracking</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-TW/blog">Blog</a></li><li><a class="dropdown__link" href="/zh-TW/case-studies">Case Studies</a></li><li><a class="dropdown__link" href="/zh-TW/resources">Resources</a></li><li><a class="dropdown__link" href="/zh-TW/events">Events</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_zID8"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>‰∏≠ÊñáÔºàÂè∞ÁÅ£Ôºâ</span></span></a><ul class="dropdown__menu"><li><a href="/docs/2.2.0/deploy-bare-metal-multi-cluster" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/zh-CN/docs/2.2.0/deploy-bare-metal-multi-cluster" target="_self" rel="noopener noreferrer" class="dropdown__link">‰∏≠ÊñáÔºà‰∏≠ÂõΩÔºâ</a></li><li><a href="/zh-TW/docs/2.2.0/deploy-bare-metal-multi-cluster" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">‰∏≠ÊñáÔºàÂè∞ÁÅ£Ôºâ</a></li><li><a href="/ja/docs/2.2.0/deploy-bare-metal-multi-cluster" target="_self" rel="noopener noreferrer" class="dropdown__link">Êó•Êú¨Ë™û</a></li><li><a href="/fr/docs/2.2.0/deploy-bare-metal-multi-cluster" target="_self" rel="noopener noreferrer" class="dropdown__link">Fran√ßais</a></li><li><a href="/ko/docs/2.2.0/deploy-bare-metal-multi-cluster" target="_self" rel="noopener noreferrer" class="dropdown__link">ÌïúÍµ≠Ïñ¥</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/zh-TW/docs">Version</a><ul class="dropdown__menu"><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.9.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.8.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.7.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.6.0</span></a></li></ul></div><div class="toggle_iYfV toggle_iQ2x toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">üåú</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">üåû</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-TW/docs/2.2.0/about">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/pulsar-2.0">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/concepts-overview">Concepts and Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/functions-overview">Pulsar Functions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/io-overview">Pulsar IO</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/sql-overview">Pulsar SQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/zh-TW/docs/2.2.0/deploy-aws">Deployment</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-TW/docs/2.2.0/deploy-aws">Amazon Web Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-TW/docs/2.2.0/deploy-kubernetes">Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-TW/docs/2.2.0/deploy-bare-metal">Bare metal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-TW/docs/2.2.0/deploy-bare-metal-multi-cluster">Bare metal multi-cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-TW/docs/2.2.0/deploy-monitoring">Monitor</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/administration-zk-bk">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/security-overview">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/client-libraries-java">Client Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/admin-api-overview">Admin API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/adaptors-kafka">Adaptors</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/cookbooks-tiered-storage">Cookbooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/develop-tools">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-TW/docs/2.2.0/reference-terminology">Reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Apache Pulsar<!-- --> <b>2.2.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/zh-TW/docs/deploy-bare-metal-multi-cluster">latest version</a></b> (<!-- -->2.9.1<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->2.2.0</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deploying a multi-cluster on bare metal</h1></header><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><ol><li>Single-cluster Pulsar installations should be sufficient for all but the most ambitious use cases. If you&#x27;re interested in experimenting with Pulsar or using it in a startup or on a single team, we recommend opting for a single cluster. For instructions on deploying a single cluster, see the guide <a href="/zh-TW/docs/2.2.0/deploy-bare-metal">here</a>.</li><li>If you want to use all builtin <a href="/zh-TW/docs/2.2.0/io-overview">Pulsar IO</a> connectors in your Pulsar deployment, you need to download <code>apache-pulsar-io-connectors</code> package and make sure it is installed under <code>connectors</code> directory in the pulsar directory on every broker node or on every function-worker node if you have run a separate cluster of function workers for <a href="/zh-TW/docs/2.2.0/functions-overview">Pulsar Functions</a>.</li><li>If you want to use <a href="/zh-TW/docs/2.2.0/concepts-tiered-storage">Tiered Storage</a> feature in your Pulsar deployment, you need to download <code>apache-pulsar-offloaders</code> package and make sure it is installed under <code>offloaders</code> directory in the pulsar directory on every broker node. For more details of how to configure this feature, you could reference this <a href="/zh-TW/docs/2.2.0/cookbooks-tiered-storage">Tiered storage cookbook</a>.</li></ol></div></div><p>A Pulsar <em>instance</em> consists of multiple Pulsar clusters working in unison. Clusters can be distributed across data centers or geographical regions and can replicate amongst themselves using <a href="/zh-TW/docs/2.2.0/administration-geo">geo-replication</a>. Deploying a multi-cluster Pulsar instance involves the following basic steps:</p><ul><li>Deploying two separate <a href="#deploying-zookeeper">ZooKeeper</a> quorums: a <a href="#deploying-local-zookeeper">local</a> quorum for each cluster in the instance and a <a href="#configuration-store">configuration store</a> quorum for instance-wide tasks</li><li>Initializing <a href="#cluster-metadata-initialization">cluster metadata</a> for each cluster</li><li>Deploying a <a href="#deploying-bookkeeper">BookKeeper cluster</a> of bookies in each Pulsar cluster</li><li>Deploying <a href="#deploying-brokers">brokers</a> in each Pulsar cluster</li></ul><p>If you&#x27;re deploying a single Pulsar cluster, see the <a href="/zh-TW/docs/2.2.0/getting-started-standalone.md#starting-the-cluster">Clusters and Brokers</a> guide.</p><blockquote><h4 class="anchor anchorWithStickyNavbar_y2LR" id="running-pulsar-locally-or-on-kubernetes">Running Pulsar locally or on Kubernetes?<a class="hash-link" href="#running-pulsar-locally-or-on-kubernetes" title="Direct link to heading">‚Äã</a></h4><p>This guide shows you how to deploy Pulsar in production in a non-Kubernetes. If you&#x27;d like to run a standalone Pulsar cluster on a single machine for development purposes, see the <a href="/zh-TW/docs/2.2.0/getting-started-standalone.md">Setting up a local cluster</a> guide. If you&#x27;re looking to run Pulsar on <a href="https://kubernetes.io" target="_blank" rel="noopener noreferrer">Kubernetes</a>, see the <a href="/zh-TW/docs/2.2.0/deploy-kubernetes">Pulsar on Kubernetes</a> guide, which includes sections on running Pulsar on Kubernetes on <a href="/zh-TW/docs/2.2.0/deploy-kubernetes#pulsar-on-google-kubernetes-engine">Google Kubernetes Engine</a> and on <a href="/zh-TW/docs/2.2.0/deploy-kubernetes#pulsar-on-amazon-web-services">Amazon Web Services</a>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="system-requirement">System requirement<a class="hash-link" href="#system-requirement" title="Direct link to heading">‚Äã</a></h2><p>Currently, Pulsar is available for 64-bit <strong>macOS</strong>, <strong>Linux</strong>, and <strong>Windows</strong>. To use Pulsar, you need to install 64-bit JRE/JDK 8 or later versions.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="installing-pulsar">Installing Pulsar<a class="hash-link" href="#installing-pulsar" title="Direct link to heading">‚Äã</a></h2><p>To get started running Pulsar, download a binary tarball release in one of the following ways:</p><ul><li><p>by clicking the link below and downloading the release from an Apache mirror:</p><ul><li><a href="pulsar:binary_release_url" target="_blank" rel="noopener noreferrer" download="">Pulsar @pulsar:version@ binary release</a></li></ul></li><li><p>from the Pulsar <a href="pulsar:download_page_url" target="_blank" rel="noopener noreferrer">downloads page</a></p></li><li><p>from the Pulsar <a href="https://github.com/apache/pulsar/releases/latest" target="_blank" rel="noopener noreferrer">releases page</a></p></li><li><p>using <a href="https://www.gnu.org/software/wget" target="_blank" rel="noopener noreferrer">wget</a>:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">wget</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;https://www.apache.org/dyn/mirrors/mirrors.cgi?action=download&amp;filename=pulsar/pulsar-@pulsar:version@/apache-pulsar-@pulsar:version@-bin.tar.gz&#x27;</span><span class="token plain"> -O apache-pulsar-@pulsar:version@-bin.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul><p>Once the tarball is downloaded, untar it and <code>cd</code> into the resulting directory:</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">tar</span><span class="token plain"> xvfz apache-pulsar-@pulsar:version@-bin.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> apache-pulsar-@pulsar:version@</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="what-your-package-contains">What your package contains<a class="hash-link" href="#what-your-package-contains" title="Direct link to heading">‚Äã</a></h2><p>The Pulsar binary package initially contains the following directories:</p><table><thead><tr><th align="left">Directory</th><th align="left">Contains</th></tr></thead><tbody><tr><td align="left"><code>bin</code></td><td align="left">Pulsar&#x27;s <a href="/zh-TW/docs/2.2.0/reference-cli-tools">command-line tools</a>, such as <a href="/zh-TW/docs/2.2.0/reference-cli-tools#pulsar"><code>pulsar</code></a> and <a href="/zh-TW/docs/2.2.0/reference-pulsar-admin"><code>pulsar-admin</code></a></td></tr><tr><td align="left"><code>conf</code></td><td align="left">Configuration files for Pulsar, including for <a href="/zh-TW/docs/2.2.0/reference-configuration#broker">broker configuration</a>, <a href="/zh-TW/docs/2.2.0/reference-configuration#zookeeper">ZooKeeper configuration</a>, and more</td></tr><tr><td align="left"><code>examples</code></td><td align="left">A Java JAR file containing example <a href="/zh-TW/docs/2.2.0/functions-overview">Pulsar Functions</a></td></tr><tr><td align="left"><code>lib</code></td><td align="left">The <a href="https://en.wikipedia.org/wiki/JAR_(file_format)" target="_blank" rel="noopener noreferrer">JAR</a> files used by Pulsar</td></tr><tr><td align="left"><code>licenses</code></td><td align="left">License files, in <code>.txt</code> form, for various components of the Pulsar codebase</td></tr></tbody></table><p>These directories will be created once you begin running Pulsar:</p><table><thead><tr><th align="left">Directory</th><th align="left">Contains</th></tr></thead><tbody><tr><td align="left"><code>data</code></td><td align="left">The data storage directory used by ZooKeeper and BookKeeper</td></tr><tr><td align="left"><code>instances</code></td><td align="left">Artifacts created for <a href="/zh-TW/docs/2.2.0/functions-overview">Pulsar Functions</a></td></tr><tr><td align="left"><code>logs</code></td><td align="left">Logs created by the installation</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="deploying-zookeeper">Deploying ZooKeeper<a class="hash-link" href="#deploying-zookeeper" title="Direct link to heading">‚Äã</a></h2><p>Each Pulsar instance relies on two separate ZooKeeper quorums.</p><ul><li><a href="#deploying-local-zookeeper">Local ZooKeeper</a> operates at the cluster level and provides cluster-specific configuration management and coordination. Each Pulsar cluster needs to have a dedicated ZooKeeper cluster.</li><li><a href="#deploying-configuration-store">Configuration Store</a> operates at the instance level and provides configuration management for the entire system (and thus across clusters). The configuration store quorum can be provided by an independent cluster of machines or by the same machines used by local ZooKeeper.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="deploying-local-zookeeper">Deploying local ZooKeeper<a class="hash-link" href="#deploying-local-zookeeper" title="Direct link to heading">‚Äã</a></h3><p>ZooKeeper manages a variety of essential coordination- and configuration-related tasks for Pulsar.</p><p>Deploying a Pulsar instance requires you to stand up one local ZooKeeper cluster <em>per Pulsar cluster</em>.</p><p>To begin, add all ZooKeeper servers to the quorum configuration specified in the <a href="/zh-TW/docs/2.2.0/reference-configuration#zookeeper"><code>conf/zookeeper.conf</code></a> file. Add a <code>server.N</code> line for each node in the cluster to the configuration, where <code>N</code> is the number of the ZooKeeper node. Here&#x27;s an example for a three-node cluster:</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.1=zk1.us-west.example.com:2888:3888</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.2=zk2.us-west.example.com:2888:3888</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.3=zk3.us-west.example.com:2888:3888</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>On each host, you need to specify the ID of the node in each node&#x27;s <code>myid</code> file, which is in each server&#x27;s <code>data/zookeeper</code> folder by default (this can be changed via the <a href="/zh-TW/docs/2.2.0/reference-configuration#zookeeper-dataDir"><code>dataDir</code></a> parameter).</p><blockquote><p>See the <a href="https://zookeeper.apache.org/doc/r3.4.10/zookeeperAdmin.html#sc_zkMulitServerSetup" target="_blank" rel="noopener noreferrer">Multi-server setup guide</a> in the ZooKeeper documentation for detailed info on <code>myid</code> and more.</p></blockquote><p>On a ZooKeeper server at <code>zk1.us-west.example.com</code>, for example, you could set the <code>myid</code> value like this:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> -p data/zookeeper</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> data/zookeeper/myid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>On <code>zk2.us-west.example.com</code> the command would be <code>echo 2 &gt; data/zookeeper/myid</code> and so on.</p><p>Once each server has been added to the <code>zookeeper.conf</code> configuration and has the appropriate <code>myid</code> entry, you can start ZooKeeper on all hosts (in the background, using nohup) with the <a href="/zh-TW/docs/2.2.0/reference-cli-tools#pulsar-daemon"><code>pulsar-daemon</code></a> CLI tool:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-daemon start zookeeper</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="deploying-the-configuration-store">Deploying the configuration store<a class="hash-link" href="#deploying-the-configuration-store" title="Direct link to heading">‚Äã</a></h3><p>The ZooKeeper cluster configured and started up in the section above is a <em>local</em> ZooKeeper cluster used to manage a single Pulsar cluster. In addition to a local cluster, however, a full Pulsar instance also requires a configuration store for handling some instance-level configuration and coordination tasks.</p><p>If you&#x27;re deploying a <a href="#single-cluster-pulsar-instance">single-cluster</a> instance, then you will not need a separate cluster for the configuration store. If, however, you&#x27;re deploying a <a href="#multi-cluster-pulsar-instance">multi-cluster</a> instance, then you should stand up a separate ZooKeeper cluster for configuration tasks.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="single-cluster-pulsar-instance">Single-cluster Pulsar instance<a class="hash-link" href="#single-cluster-pulsar-instance" title="Direct link to heading">‚Äã</a></h4><p>If your Pulsar instance will consist of just one cluster, then you can deploy a configuration store on the same machines as the local ZooKeeper quorum but running on different TCP ports.</p><p>To deploy a ZooKeeper configuration store in a single-cluster instance, add the same ZooKeeper servers used by the local quorum to the configuration file in <a href="/zh-TW/docs/2.2.0/reference-configuration#configuration-store"><code>conf/global_zookeeper.conf</code></a> using the same method for <a href="#local-zookeeper">local ZooKeeper</a>, but make sure to use a different port (2181 is the default for ZooKeeper). Here&#x27;s an example that uses port 2184 for a three-node ZooKeeper cluster:</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">clientPort=2184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.1=zk1.us-west.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.2=zk2.us-west.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.3=zk3.us-west.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As before, create the <code>myid</code> files for each server on <code>data/global-zookeeper/myid</code>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="multi-cluster-pulsar-instance">Multi-cluster Pulsar instance<a class="hash-link" href="#multi-cluster-pulsar-instance" title="Direct link to heading">‚Äã</a></h4><p>When deploying a global Pulsar instance, with clusters distributed across different geographical regions, the configuration store serves as a highly available and strongly consistent metadata store that can tolerate failures and partitions spanning whole regions.</p><p>The key here is to make sure the ZK quorum members are spread across at least 3 regions and that other regions are running as observers.</p><p>Again, given the very low expected load on the configuration store servers, we can share the same hosts used for the local ZooKeeper quorum.</p><p>For example, let&#x27;s assume a Pulsar instance with the following clusters <code>us-west</code>, <code>us-east</code>, <code>us-central</code>, <code>eu-central</code>, <code>ap-south</code>. Also let&#x27;s assume, each cluster will have its own local ZK servers named such as</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">zk[1-3].${CLUSTER}.example.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In this scenario we want to pick the quorum participants from few clusters and let all the others be ZK observers. For example, to form a 7 servers quorum, we can pick 3 servers from <code>us-west</code>, 2 from <code>us-central</code> and 2 from <code>us-east</code>.</p><p>This will guarantee that writes to configuration store will be possible even if one of these regions is unreachable.</p><p>The ZK configuration in all the servers will look like:</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">clientPort=2184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.1=zk1.us-west.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.2=zk2.us-west.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.3=zk3.us-west.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.4=zk1.us-central.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.5=zk2.us-central.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.6=zk3.us-central.example.com:2185:2186:observer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.7=zk1.us-east.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.8=zk2.us-east.example.com:2185:2186</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.9=zk3.us-east.example.com:2185:2186:observer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.10=zk1.eu-central.example.com:2185:2186:observer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.11=zk2.eu-central.example.com:2185:2186:observer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.12=zk3.eu-central.example.com:2185:2186:observer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.13=zk1.ap-south.example.com:2185:2186:observer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.14=zk2.ap-south.example.com:2185:2186:observer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server.15=zk3.ap-south.example.com:2185:2186:observer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Additionally, ZK observers will need to have:</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">peerType=observer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_y2LR" id="starting-the-service">Starting the service<a class="hash-link" href="#starting-the-service" title="Direct link to heading">‚Äã</a></h5><p>Once your configuration store configuration is in place, you can start up the service using <a href="/zh-TW/docs/2.2.0/reference-cli-tools#pulsar-daemon"><code>pulsar-daemon</code></a></p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-daemon start configuration-store</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="cluster-metadata-initialization">Cluster metadata initialization<a class="hash-link" href="#cluster-metadata-initialization" title="Direct link to heading">‚Äã</a></h2><p>Once you&#x27;ve set up the cluster-specific ZooKeeper and configuration store quorums for your instance, there is some metadata that needs to be written to ZooKeeper for each cluster in your instance. <strong>It only needs to be written once</strong>.</p><p>You can initialize this metadata using the <a href="/zh-TW/docs/2.2.0/reference-cli-tools#pulsar-initialize-cluster-metadata"><code>initialize-cluster-metadata</code></a> command of the <a href="/zh-TW/docs/2.2.0/reference-cli-tools#pulsar"><code>pulsar</code></a> CLI tool. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar initialize-cluster-metadata </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --cluster us-west </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --zookeeper zk1.us-west.example.com:2181 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --configuration-store zk1.us-west.example.com:2184 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --web-service-url http://pulsar.us-west.example.com:8080/ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --web-service-url-tls https://pulsar.us-west.example.com:8443/ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --broker-service-url pulsar://pulsar.us-west.example.com:6650/ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --broker-service-url-tls pulsar+ssl://pulsar.us-west.example.com:6651/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As you can see from the example above, the following needs to be specified:</p><ul><li>The name of the cluster</li><li>The local ZooKeeper connection string for the cluster</li><li>The configuration store connection string for the entire instance</li><li>The web service URL for the cluster</li><li>A broker service URL enabling interaction with the <a href="/zh-TW/docs/2.2.0/reference-terminology#broker">brokers</a> in the cluster</li></ul><p>If you&#x27;re using <a href="/zh-TW/docs/2.2.0/security-tls-transport">TLS</a>, you&#x27;ll also need to specify a TLS web service URL for the cluster as well as a TLS broker service URL for the brokers in the cluster.</p><p>Make sure to run <code>initialize-cluster-metadata</code> for each cluster in your instance.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="deploying-bookkeeper">Deploying BookKeeper<a class="hash-link" href="#deploying-bookkeeper" title="Direct link to heading">‚Äã</a></h2><p>BookKeeper provides <a href="/zh-TW/docs/2.2.0/concepts-architecture-overview#persistent-storage">persistent message storage</a> for Pulsar.</p><p>Each Pulsar broker needs to have its own cluster of bookies. The BookKeeper cluster shares a local ZooKeeper quorum with the Pulsar cluster.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configuring-bookies">Configuring bookies<a class="hash-link" href="#configuring-bookies" title="Direct link to heading">‚Äã</a></h3><p>BookKeeper bookies can be configured using the <a href="/zh-TW/docs/2.2.0/reference-configuration#bookkeeper"><code>conf/bookkeeper.conf</code></a> configuration file. The most important aspect of configuring each bookie is ensuring that the <a href="/zh-TW/docs/2.2.0/reference-configuration#bookkeeper-zkServers"><code>zkServers</code></a> parameter is set to the connection string for the Pulsar cluster&#x27;s local ZooKeeper.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="starting-up-bookies">Starting up bookies<a class="hash-link" href="#starting-up-bookies" title="Direct link to heading">‚Äã</a></h3><p>You can start up a bookie in two ways: in the foreground or as a background daemon.</p><p>To start up a bookie in the foreground, use the <a href="/zh-TW/docs/2.2.0/reference-cli-tools#bookkeeper"><code>bookkeeper</code></a></p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-daemon start bookie</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>You can verify that the bookie is working properly using the <code>bookiesanity</code> command for the <a href="/zh-TW/docs/2.2.0/reference-cli-tools#bookkeeper-shell">BookKeeper shell</a>:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/bookkeeper shell bookiesanity</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This will create a new ledger on the local bookie, write a few entries, read them back and finally delete the ledger.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="hardware-considerations">Hardware considerations<a class="hash-link" href="#hardware-considerations" title="Direct link to heading">‚Äã</a></h3><p>Bookie hosts are responsible for storing message data on disk. In order for bookies to provide optimal performance, it&#x27;s essential that they have a suitable hardware configuration. There are two key dimensions to bookie hardware capacity:</p><ul><li>Disk I/O capacity read/write</li><li>Storage capacity</li></ul><p>Message entries written to bookies are always synced to disk before returning an acknowledgement to the Pulsar broker. To ensure low write latency, BookKeeper is designed to use multiple devices:</p><ul><li>A <strong>journal</strong> to ensure durability. For sequential writes, it&#x27;s critical to have fast <a href="https://linux.die.net/man/2/fsync" target="_blank" rel="noopener noreferrer">fsync</a> operations on bookie hosts. Typically, small and fast <a href="https://en.wikipedia.org/wiki/Solid-state_drive" target="_blank" rel="noopener noreferrer">solid-state drives</a> (SSDs) should suffice, or <a href="https://en.wikipedia.org/wiki/Hard_disk_drive" target="_blank" rel="noopener noreferrer">hard disk drives</a> (HDDs) with a <a href="https://en.wikipedia.org/wiki/RAID" target="_blank" rel="noopener noreferrer">RAID</a>s controller and a battery-backed write cache. Both solutions can reach fsync latency of ~0.4 ms.</li><li>A <strong>ledger storage device</strong> is where data is stored until all consumers have acknowledged the message. Writes will happen in the background, so write I/O is not a big concern. Reads will happen sequentially most of the time and the backlog is drained only in case of consumer drain. To store large amounts of data, a typical configuration will involve multiple HDDs with a RAID controller.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="deploying-brokers">Deploying brokers<a class="hash-link" href="#deploying-brokers" title="Direct link to heading">‚Äã</a></h2><p>Once you&#x27;ve set up ZooKeeper, initialized cluster metadata, and spun up BookKeeper bookies, you can deploy brokers.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="broker-configuration">Broker configuration<a class="hash-link" href="#broker-configuration" title="Direct link to heading">‚Äã</a></h3><p>Brokers can be configured using the <a href="/zh-TW/docs/2.2.0/reference-configuration#broker"><code>conf/broker.conf</code></a> configuration file.</p><p>The most important element of broker configuration is ensuring that each broker is aware of its local ZooKeeper quorum as well as the configuration store quorum. Make sure that you set the <a href="/zh-TW/docs/2.2.0/reference-configuration#broker-zookeeperServers"><code>zookeeperServers</code></a> parameter to reflect the local quorum and the <a href="/zh-TW/docs/2.2.0/reference-configuration#broker-configurationStoreServers"><code>configurationStoreServers</code></a> parameter to reflect the configuration store quorum (although you&#x27;ll need to specify only those ZooKeeper servers located in the same cluster).</p><p>You also need to specify the name of the <a href="/zh-TW/docs/2.2.0/reference-terminology#cluster">cluster</a> to which the broker belongs using the <a href="/zh-TW/docs/2.2.0/reference-configuration#broker-clusterName"><code>clusterName</code></a> parameter.</p><p>Here&#x27;s an example configuration:</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Local ZooKeeper servers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">zookeeperServers=zk1.us-west.example.com:2181,zk2.us-west.example.com:2181,zk3.us-west.example.com:2181</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Configuration store quorum connection string.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">configurationStoreServers=zk1.us-west.example.com:2184,zk2.us-west.example.com:2184,zk3.us-west.example.com:2184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">clusterName=us-west</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="broker-hardware">Broker hardware<a class="hash-link" href="#broker-hardware" title="Direct link to heading">‚Äã</a></h3><p>Pulsar brokers do not require any special hardware since they don&#x27;t use the local disk. Fast CPUs and 10Gbps <a href="https://en.wikipedia.org/wiki/Network_interface_controller" target="_blank" rel="noopener noreferrer">NIC</a> are recommended since the software can take full advantage of that.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="starting-the-broker-service">Starting the broker service<a class="hash-link" href="#starting-the-broker-service" title="Direct link to heading">‚Äã</a></h3><p>You can start a broker in the background using <a href="https://en.wikipedia.org/wiki/Nohup" target="_blank" rel="noopener noreferrer">nohup</a> with the <a href="/zh-TW/docs/2.2.0/reference-cli-tools#pulsar-daemon"><code>pulsar-daemon</code></a> CLI tool:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-daemon start broker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>You can also start brokers in the foreground using <a href="/zh-TW/docs/2.2.0/reference-cli-tools#pulsar-broker"><code>pulsar broker</code></a>:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar broker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="service-discovery">Service discovery<a class="hash-link" href="#service-discovery" title="Direct link to heading">‚Äã</a></h2><p><a href="/zh-TW/docs/2.2.0/getting-started-clients">Clients</a> connecting to Pulsar brokers need to be able to communicate with an entire Pulsar instance using a single URL. Pulsar provides a built-in service discovery mechanism that you can set up using the instructions <a href="#service-discovery-setup">immediately below</a>.</p><p>You can also use your own service discovery system if you&#x27;d like. If you use your own system, there is just one requirement: when a client performs an HTTP request to an <a href="/zh-TW/docs/2.2.0/reference-configuration">endpoint</a> for a Pulsar cluster, such as <code>http://pulsar.us-west.example.com:8080</code>, the client needs to be redirected to <em>some</em> active broker in the desired cluster, whether via DNS, an HTTP or IP redirect, or some other means.</p><blockquote><h4 class="anchor anchorWithStickyNavbar_y2LR" id="service-discovery-already-provided-by-many-scheduling-systems">Service discovery already provided by many scheduling systems<a class="hash-link" href="#service-discovery-already-provided-by-many-scheduling-systems" title="Direct link to heading">‚Äã</a></h4><p>Many large-scale deployment systems, such as <a href="/zh-TW/docs/2.2.0/deploy-kubernetes">Kubernetes</a>, have service discovery systems built in. If you&#x27;re running Pulsar on such a system, you may not need to provide your own service discovery mechanism.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="service-discovery-setup">Service discovery setup<a class="hash-link" href="#service-discovery-setup" title="Direct link to heading">‚Äã</a></h3><p>The service discovery mechanism included with Pulsar maintains a list of active brokers, stored in ZooKeeper, and supports lookup using HTTP and also Pulsar&#x27;s <a href="/zh-TW/docs/2.2.0/developing-binary-protocol">binary protocol</a>.</p><p>To get started setting up Pulsar&#x27;s built-in service discovery, you need to change a few parameters in the <a href="/zh-TW/docs/2.2.0/reference-configuration#service-discovery"><code>conf/discovery.conf</code></a> configuration file. Set the <a href="/zh-TW/docs/2.2.0/reference-configuration#service-discovery-zookeeperServers"><code>zookeeperServers</code></a> parameter to the cluster&#x27;s ZooKeeper quorum connection string and the <a href="/zh-TW/docs/2.2.0/reference-configuration#service-discovery-configurationStoreServers"><code>configurationStoreServers</code></a> setting to the <a href="/zh-TW/docs/2.2.0/reference-terminology#configuration-store">configuration store</a> quorum connection string.</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Zookeeper quorum connection string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">zookeeperServers=zk1.us-west.example.com:2181,zk2.us-west.example.com:2181,zk3.us-west.example.com:2181</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Global configuration store connection string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">configurationStoreServers=zk1.us-west.example.com:2184,zk2.us-west.example.com:2184,zk3.us-west.example.com:2184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To start the discovery service:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-daemon start discovery</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="admin-client-and-verification">Admin client and verification<a class="hash-link" href="#admin-client-and-verification" title="Direct link to heading">‚Äã</a></h2><p>At this point your Pulsar instance should be ready to use. You can now configure client machines that can serve as <a href="/zh-TW/docs/2.2.0/admin-api-overview">administrative clients</a> for each cluster. You can use the <a href="/zh-TW/docs/2.2.0/reference-configuration#client"><code>conf/client.conf</code></a> configuration file to configure admin clients.</p><p>The most important thing is that you point the <a href="/zh-TW/docs/2.2.0/reference-configuration#client-serviceUrl"><code>serviceUrl</code></a> parameter to the correct service URL for the cluster:</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">serviceUrl=http://pulsar.us-west.example.com:8080/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="provisioning-new-tenants">Provisioning new tenants<a class="hash-link" href="#provisioning-new-tenants" title="Direct link to heading">‚Äã</a></h2><p>Pulsar was built as a fundamentally multi-tenant system.</p><p>To allow a new tenant to use the system, we need to create a new one. You can create a new tenant using the <a href="/zh-TW/docs/2.2.0/reference-pulsar-admin.md#tenants-create"><code>pulsar-admin</code></a> CLI tool:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin tenants create test-tenant </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --allowed-clusters us-west </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --admin-roles test-admin-role</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This will allow users who identify with role <code>test-admin-role</code> to administer the configuration for the tenant <code>test</code> which will only be allowed to use the cluster <code>us-west</code>. From now on, this tenant will be able to self-manage its resources.</p><p>Once a tenant has been created, you will need to create <a href="/zh-TW/docs/2.2.0/reference-terminology#namespace">namespaces</a> for topics within that tenant.</p><p>The first step is to create a namespace. A namespace is an administrative unit that can contain many topics. A common practice is to create a namespace for each different use case from a single tenant.</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin namespaces create test-tenant/ns1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_y2LR" id="testing-producer-and-consumer">Testing producer and consumer<a class="hash-link" href="#testing-producer-and-consumer" title="Direct link to heading">‚Äã</a></h5><p>Everything is now ready to send and receive messages. The quickest way to test the system is through the <code>pulsar-perf</code> client tool.</p><p>Let&#x27;s use a topic in the namespace we just created. Topics are automatically created the first time a producer or a consumer tries to use them.</p><p>The topic name in this case could be:</p><div class="codeBlockContainer_J+bg language-http theme-code-block"><div class="codeBlockContent_csEI http"><pre tabindex="0" class="prism-code language-http codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">persistent://test-tenant/ns1/my-topic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Start a consumer that will create a subscription on the topic and will wait for messages:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-perf consume persistent://test-tenant/us-west/ns1/my-topic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Start a producer that publishes messages at a fixed rate and report stats every 10 seconds:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-perf produce persistent://test-tenant/us-west/ns1/my-topic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To report the topic stats:</p><div class="codeBlockContainer_J+bg language-shell theme-code-block"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin persistent stats persistent://test-tenant/us-west/ns1/my-topic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/website-next/versioned_docs/version-2.2.0/deploy-bare-metal-multi-cluster.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh-TW/docs/2.2.0/deploy-bare-metal"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Bare metal</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh-TW/docs/2.2.0/deploy-monitoring"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Monitor</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#system-requirement" class="table-of-contents__link toc-highlight">System requirement</a></li><li><a href="#installing-pulsar" class="table-of-contents__link toc-highlight">Installing Pulsar</a></li><li><a href="#what-your-package-contains" class="table-of-contents__link toc-highlight">What your package contains</a></li><li><a href="#deploying-zookeeper" class="table-of-contents__link toc-highlight">Deploying ZooKeeper</a><ul><li><a href="#deploying-local-zookeeper" class="table-of-contents__link toc-highlight">Deploying local ZooKeeper</a></li><li><a href="#deploying-the-configuration-store" class="table-of-contents__link toc-highlight">Deploying the configuration store</a></li></ul></li><li><a href="#cluster-metadata-initialization" class="table-of-contents__link toc-highlight">Cluster metadata initialization</a></li><li><a href="#deploying-bookkeeper" class="table-of-contents__link toc-highlight">Deploying BookKeeper</a><ul><li><a href="#configuring-bookies" class="table-of-contents__link toc-highlight">Configuring bookies</a></li><li><a href="#starting-up-bookies" class="table-of-contents__link toc-highlight">Starting up bookies</a></li><li><a href="#hardware-considerations" class="table-of-contents__link toc-highlight">Hardware considerations</a></li></ul></li><li><a href="#deploying-brokers" class="table-of-contents__link toc-highlight">Deploying brokers</a><ul><li><a href="#broker-configuration" class="table-of-contents__link toc-highlight">Broker configuration</a></li><li><a href="#broker-hardware" class="table-of-contents__link toc-highlight">Broker hardware</a></li><li><a href="#starting-the-broker-service" class="table-of-contents__link toc-highlight">Starting the broker service</a></li></ul></li><li><a href="#service-discovery" class="table-of-contents__link toc-highlight">Service discovery</a><ul><li><a href="#service-discovery-setup" class="table-of-contents__link toc-highlight">Service discovery setup</a></li></ul></li><li><a href="#admin-client-and-verification" class="table-of-contents__link toc-highlight">Admin client and verification</a></li><li><a href="#provisioning-new-tenants" class="table-of-contents__link toc-highlight">Provisioning new tenants</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Apache Foundation.</div><ul class="footer__items"><li class="footer__item">
	              <img src="/img/Apache_Feather_Logo.svg" alt="" width="20">
	              </li><li class="footer__item"><a href="http://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title"> </div><ul class="footer__items"><li class="footer__item">
	              <div><small><strong>Apache Pulsar is available under the <a href="/">Apache License, version 2.0.</a></strong></small></div>
                <div>Apache Pulsar is a distributed, open source pub-sub messaging and streaming platform for real-time workloads, managing hundreds of billions of events per day.</div>
	              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_SRtH" href="/zh-TW/"><img src="/zh-TW/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/zh-TW/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright"><p>Apache Pulsar is available under the Apache License, version 2.0.</p>
      <p>Copyright ¬© 2022 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</p></div></div></div></footer></div>
<script src="/zh-TW/assets/js/runtime~main.8684db6e.js"></script>
<script src="/zh-TW/assets/js/main.f14de376.js"></script>
</body>
</html>