---
id: pulsar-2.11.3
title: Apache Pulsar 2.11.3
sidebar_label: Apache Pulsar 2.11.3
---

#### 2024-01-03

### Broker
- [fix][broker] Fix typo in the config key [#21690](https://github.com/apache/pulsar/pull/21690)
- [fix][broker] network package lost if enable haProxyProtocolEnabled [#21684](https://github.com/apache/pulsar/pull/21684)
- [fix][broker] Fix memory leak during topic compaction [#21647](https://github.com/apache/pulsar/pull/21647)
- [fix][broker] Fix incorrect unack count when using shared subscription on non-persistent topic [#21592](https://github.com/apache/pulsar/pull/21592)
- [fix][broker] Duplicate LedgerOffloader creation when namespace/topicâ€¦ [#21591](https://github.com/apache/pulsar/pull/21591)
- [improve][broker][PIP-318] Support not retaining null-key message during topic compaction [#21578](https://github.com/apache/pulsar/pull/21578)
- [fix][broker] Correct schema deletion for partitioned topic [#21574](https://github.com/apache/pulsar/pull/21574)
- [fix][broker] Fix namespace bundle stuck in unloading status ([#21445](https://github.com/apache/pulsar/pull/21445)) [#21566](https://github.com/apache/pulsar/pull/21566)
- [fix][broker] Fix create topic with different auto creation strategies causes race condition [#21545](https://github.com/apache/pulsar/pull/21545)
- [fix][ml] Fix orphan scheduled task for ledger create timeout check [#21542](https://github.com/apache/pulsar/pull/21542)
- [fix][broker] Fix thousands orphan PersistentTopic caused OOM [#21540](https://github.com/apache/pulsar/pull/21540)
- [fix][ml] Fix unfinished callback when deleting managed ledger [#21530](https://github.com/apache/pulsar/pull/21530)
- [fix][broker] Fix setReplicatedSubscriptionStatus incorrect behavior [#21510](https://github.com/apache/pulsar/pull/21510)
- [fix][txn] OpRequestSend reuse problem cause tbClient commitTxnOnTopic timeout unexpectedly [#21505](https://github.com/apache/pulsar/pull/21505)
- [fix][broker] Avoid pass null role in MultiRolesTokenAuthorizationProvider [#21486](https://github.com/apache/pulsar/pull/21486)
- [fix][broker] Fix the deadlock when using BookieRackAffinityMapping with rackaware policy [#21481](https://github.com/apache/pulsar/pull/21481)
- [fix][broker] Fix issue with consumer read uncommitted messages from compacted topic [#21465](https://github.com/apache/pulsar/pull/21465)
- [fix][broker] Fix resource_quota_zpath [#21461](https://github.com/apache/pulsar/pull/21461)
- [fix][broker] Fix namespace bundle stuck in unloading status [#21445](https://github.com/apache/pulsar/pull/21445)
- [fix][broker] Fix MultiRoles token provider NPE when using anonymous clients [#21429](https://github.com/apache/pulsar/pull/21429)
- [fix][ci] Fix docker image building by releasing more disk space before building [#21365](https://github.com/apache/pulsar/pull/21365)
- [fix][broker] Fix heartbeat namespace create event topic and cannot delete heartbeat topic [#21360](https://github.com/apache/pulsar/pull/21360)
- [fix][broker] Fix heartbeat namespace create transaction internal topic [#21348](https://github.com/apache/pulsar/pull/21348)
- [fix][bk-client]  Fix bk client MinNumRacksPerWriteQuorum and EnforceMinNumRacksPerWriteQuorum not work problem. [#21327](https://github.com/apache/pulsar/pull/21327)
- [fix][auto-recovery] [branch-2.11] Fix pulsar ledger auditor dead lock problem. [#21319](https://github.com/apache/pulsar/pull/21319)
- [fix][auto-recovery] [branch-2.11] Fix PulsarLedgerUnderreplicationManager notify problem. [#21318](https://github.com/apache/pulsar/pull/21318)
- [fix][auto-recovery] [branch-2.11] Fix metadata store deadlock due to BookkeeperInternalCallbacks.Processor [#21315](https://github.com/apache/pulsar/pull/21315)
- [fix][ml] Fix thread safe issue with RangeCache.put and RangeCache.clear [#21302](https://github.com/apache/pulsar/pull/21302)
- [fix][txn] Ack all message ids when ack chunk messages with transaction. [#21268](https://github.com/apache/pulsar/pull/21268)
- [fix][ml] fix wrong msg backlog of non-durable cursor after trim ledgers [#21250](https://github.com/apache/pulsar/pull/21250)
- [fix][ml] Reader can set read-pos to a deleted ledger [#21248](https://github.com/apache/pulsar/pull/21248)
- [fix][broker]Fixed produce and consume when anonymousUserRole enabled [#21237](https://github.com/apache/pulsar/pull/21237)
- [fix][broker] Fix inconsistent topic policy [#21231](https://github.com/apache/pulsar/pull/21231)
- [fix][broker] Fixed reset for AggregatedNamespaceStats [#21225](https://github.com/apache/pulsar/pull/21225)
- [improve][broker] Let the producer request success at the first time if the previous one is inactive [#21220](https://github.com/apache/pulsar/pull/21220)
- [improve][proxy] Not close the socket if lookup failed caused by too many requests [#21216](https://github.com/apache/pulsar/pull/21216)
- [improve][broker] Not close the socket if lookup failed caused by bundle unloading or metadata ex [#21211](https://github.com/apache/pulsar/pull/21211)
- [fix][broker] replicator leak when removeReplicator in NonPersistentTopic [#21205](https://github.com/apache/pulsar/pull/21205)
- [improve][broker] Print warn log if ssl handshake error & print ledger id when switch ledger [#21201](https://github.com/apache/pulsar/pull/21201)
- [fix][broker] Make the new exclusive consumer instead the inactive one faster [#21183](https://github.com/apache/pulsar/pull/21183)
- [fix][auto-recovery] Fix pulsar ledger auditor dead lock problem. [#21181](https://github.com/apache/pulsar/pull/21181)
- [fix][broker] Backport  fix UniformLoadShedder selecet wrong overloadbroker and underloadbroker [#21178](https://github.com/apache/pulsar/pull/21178)
- [improve][broker] improve read entry error log for troubleshooting [#21169](https://github.com/apache/pulsar/pull/21169)
- [branch-2.11] Fix compatibility issues [#21163](https://github.com/apache/pulsar/pull/21163)
- [fix][auto-recovery] Fix PulsarLedgerUnderreplicationManager notify problem. [#21161](https://github.com/apache/pulsar/pull/21161)
- [fix][auto-recovery] Fix metadata store deadlock due to BookkeeperInternalCallbacks.Processor [#21159](https://github.com/apache/pulsar/pull/21159)
- [fix][bookie] Fix RocksDB configuration [#21157](https://github.com/apache/pulsar/pull/21157)
- [fix][broker] Make specified producer could override the previous one [#21155](https://github.com/apache/pulsar/pull/21155)
- [improve][broker] Improve logs for troubleshooting [#21141](https://github.com/apache/pulsar/pull/21141)
- [fix][broker] Fix unack count when mixing non batch index and batch index acks [#21126](https://github.com/apache/pulsar/pull/21126)
- [fix][broker] Fix isolated group not work problem. [#21096](https://github.com/apache/pulsar/pull/21096)
- [fix][broker] Fix write duplicate entries into the compacted ledger after RawReader reconnects [#21081](https://github.com/apache/pulsar/pull/21081)
- [fix][broker] remove bundle-data in local metadata store. [#21078](https://github.com/apache/pulsar/pull/21078)
- [fix][proxy] Fix Proxy 502 gateway error when it is configured with Keystore TLS and admin API is called [#21077](https://github.com/apache/pulsar/pull/21077)
- [fix][broker] Make sure all inflight writes have finished  before completion of compaction [#21067](https://github.com/apache/pulsar/pull/21067)
- [improve][broker] Make read compacted entries support maxReadSizeBytes limitation [#21065](https://github.com/apache/pulsar/pull/21065)
- [improve][broker] Improve cache handling for partitioned topic metadata when doing lookup [#21063](https://github.com/apache/pulsar/pull/21063)
- [fix][broker] Use MessageDigest.isEqual when comparing digests [#21061](https://github.com/apache/pulsar/pull/21061)
- [fix][auto-recovery] Improve to the ReplicaitonWorker performance by deleting invalid underreplication nodes [#21059](https://github.com/apache/pulsar/pull/21059)
- [fix][broker] Fix potential case cause retention policy not working on topic level [#21041](https://github.com/apache/pulsar/pull/21041)
- [fix][fn] Fix ProducerConfig cannot update error [#21037](https://github.com/apache/pulsar/pull/21037)
- [fix][bk] Correctct the bookie info after ZK client is reconnected [#21035](https://github.com/apache/pulsar/pull/21035)
- [fix][broker] fix UniformLoadShedder selecet wrong overloadbroker and underloadbroker [#21025](https://github.com/apache/pulsar/pull/21025)
- [fix][fn] Fix the --batch-builder not working error for functions [#21023](https://github.com/apache/pulsar/pull/21023)
- [fix][meta] Fix deadlock in AutoRecovery. [#21010](https://github.com/apache/pulsar/pull/21010)
- [fix][broker] Fix incorrect unack msk count when dup ack a message [#20990](https://github.com/apache/pulsar/pull/20990)
- [fix][broker] Fix can't stop phase-two of compaction even though messageId read reaches lastReadId [#20988](https://github.com/apache/pulsar/pull/20988)
- [fix][broker] Fix compaction subscription delete by inactive subscription check. [#20983](https://github.com/apache/pulsar/pull/20983)
- [fix][broker] Fix message loss during topic compaction [#20980](https://github.com/apache/pulsar/pull/20980)
- [fix][broker] Fix incorrect number of read compacted entries [#20978](https://github.com/apache/pulsar/pull/20978)
- [fix][admin] Fix get topic stats fail if a subscription catch up concurrently [#20971](https://github.com/apache/pulsar/pull/20971)
- [branch-2.11][fix][broker] fix multiple versions of bouncy-castle [#20960](https://github.com/apache/pulsar/pull/20960)
- [fix][broker] Producer is blocked on creation because backlog exceeded on topic, when dedup is enabled and no producer is there [#20951](https://github.com/apache/pulsar/pull/20951)
- [fix][broker]Fix chunked messages will be filtered by duplicating [#20948](https://github.com/apache/pulsar/pull/20948)
- [fix][broker] rackaware policy is ineffective when delete zk rack info after bkclient initialize [#20944](https://github.com/apache/pulsar/pull/20944)
- [fix][broker]Check that the super user role is in the MultiRolesTokenAuthorizationProvider plugin [#20939](https://github.com/apache/pulsar/pull/20939)
- [fix][broker] fix MessageDeduplication throw NPE when enable broker dedup and set namespace disable deduplication. [#20905](https://github.com/apache/pulsar/pull/20905)
- [fix][ml] fix discontinuous ledger deletion [#20898](https://github.com/apache/pulsar/pull/20898)
- [fix][broker] In replication scenario, remote consumer could not be registered if there has no message was sent [#20888](https://github.com/apache/pulsar/pull/20888)
- [improve][txn]Add log when can't send TcClientConnectRequest to broker. [#20880](https://github.com/apache/pulsar/pull/20880)
- [fix][broker] Fix inconsensus namespace policies by getPoliciesIfCached [#20855](https://github.com/apache/pulsar/pull/20855)
- [fix][broker] Inconsistent behaviour for topic auto_creation [#20843](https://github.com/apache/pulsar/pull/20843)
- [improve][ws] add cryptoKeyReaderFactoryClassName into the file websocket.conf [#20840](https://github.com/apache/pulsar/pull/20840)
- [fix][build] Upgrade PyYaml version to 6.0.1 [#20831](https://github.com/apache/pulsar/pull/20831)
- [fix][broker] Avoid infinite bundle unloading [#20822](https://github.com/apache/pulsar/pull/20822)
- [improve][offload] Extend the offload policies to allow specifying more conf [#20804](https://github.com/apache/pulsar/pull/20804)
- [improve][offload] Create offload resources lazily [#20775](https://github.com/apache/pulsar/pull/20775)
- [fix][broker] Can not receive any messages after switch to standby cluster [#20767](https://github.com/apache/pulsar/pull/20767)
- [fix][broker] Fix get topic policies as null during clean cache [#20763](https://github.com/apache/pulsar/pull/20763)
- [fix][broker] Avoid throwing RestException in BrokerService [#20761](https://github.com/apache/pulsar/pull/20761)
- [improve][offload] Support to configure more offload driver [#20736](https://github.com/apache/pulsar/pull/20736)
- [fix][broker] Gracefully shutdown does not work with admin cli in standalone [#20709](https://github.com/apache/pulsar/pull/20709)
- [fix][broker] Fix ModularLoadManagerImpl always delete active bundle-data. sec ver. [#20620](https://github.com/apache/pulsar/pull/20620)
- [improve][broker] Add consumer-id into the log when doing subscribe. [#20568](https://github.com/apache/pulsar/pull/20568)
- [fix][broker] Allow Access to System Topic Metadata for Reader Creation Post-Namespace Deletion [#20304](https://github.com/apache/pulsar/pull/20304)
- [improve][broker] Replace ScheduledExecutorService to ExecutorService in ModularLoadManagerImpl [#19656](https://github.com/apache/pulsar/pull/19656)
- [fix][broker] Fix namespace deletion if __change_events topic has not been created yet [#18804](https://github.com/apache/pulsar/pull/18804)
- [improve] Introduce the sync() API to ensure consistency on reads during critical metadata operation paths [#18518](https://github.com/apache/pulsar/pull/18518)
- [fix][broker] Fix namespace not found will cause request timeout [#18512](https://github.com/apache/pulsar/pull/18512)
- [fix][broker] fix bug caused by optimistic locking [#18390](https://github.com/apache/pulsar/pull/18390)
- [fix][broker] fix broker unackmessages become a negative number [#17003](https://github.com/apache/pulsar/pull/17003)

### Clients
- [fix][client] Fix print error log 'Auto getting partitions failed' when expend partition. [#21485](https://github.com/apache/pulsar/pull/21485)
- [fix][client] fix reader.hasMessageAvailable return false when incoming queue is not empty [#21259](https://github.com/apache/pulsar/pull/21259)
- [improve][client] Merge lookup requests for the same topic [#21232](https://github.com/apache/pulsar/pull/21232)
- [fix][client] fix same producer/consumer use more than one connection per broker [#21144](https://github.com/apache/pulsar/pull/21144)
- [fix][client] Fix repeat consume when using n-ack and batched messages [#21116](https://github.com/apache/pulsar/pull/21116)
- [fix][client] Fix logging problem in pulsar client [#21094](https://github.com/apache/pulsar/pull/21094)
- [fix][client] Fix subscribing pattern topics through Proxy not working [#20739](https://github.com/apache/pulsar/pull/20739)
- [fix][client] Fix producer could send timeout when enable batching [#19191](https://github.com/apache/pulsar/pull/19191)
- [fix][client] Fix perf-producer get OOM with high publish latency [#20914](https://github
